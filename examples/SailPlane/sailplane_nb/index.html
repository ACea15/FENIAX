
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for aeroelastic library FENIAX.">
      
      
        <meta name="author" content="Alvaro Cea">
      
      
      
        <link rel="prev" href="../../">
      
      
        <link rel="next" href="../../wingSP/wingSP_nb/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Sail Plane static response - FENIAX</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sail-plane" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="FENIAX" class="md-header__button md-logo" aria-label="FENIAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FENIAX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sail Plane static response
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ACea15/FENIAX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ACea15/FENIAX
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../getting_started/" class="md-tabs__link">
        
  
    
  
  Getting started

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../theory_intrinsic/" class="md-tabs__link">
          
  
    
  
  Theoretical background

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../JAX/" class="md-tabs__link">
          
  
    
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../api/inputs/" class="md-tabs__link">
          
  
    
  
  Code base

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="FENIAX" class="md-nav__button md-logo" aria-label="FENIAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FENIAX
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ACea15/FENIAX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ACea15/FENIAX
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Sail Plane static response
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Sail Plane static response
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Run cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sp1" class="md-nav__link">
    <span class="md-ellipsis">
      SP1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp2" class="md-nav__link">
    <span class="md-ellipsis">
      SP2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp3" class="md-nav__link">
    <span class="md-ellipsis">
      SP3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp4" class="md-nav__link">
    <span class="md-ellipsis">
      SP4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp5" class="md-nav__link">
    <span class="md-ellipsis">
      SP5
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Postprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Postprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-nastran-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load Nastran data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structural-verification-of-a-representative-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Structural verification of a representative configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wingSP/wingSP_nb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wing nonlinear dynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SimoFS/main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Free flying shell structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../industrialAC/main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Full aircraft (clamped) gust verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../industrialACtrim/main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Full aircraft trim + dynamic loads
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theoretical background
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Theoretical background
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../theory_intrinsic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intrinsic modal description
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../JAX/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UML/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UML description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../inputs.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Program inputs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code base
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Code base
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/inputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inputs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/couplings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nonlinear couplings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Run cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sp1" class="md-nav__link">
    <span class="md-ellipsis">
      SP1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp2" class="md-nav__link">
    <span class="md-ellipsis">
      SP2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp3" class="md-nav__link">
    <span class="md-ellipsis">
      SP3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp4" class="md-nav__link">
    <span class="md-ellipsis">
      SP4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sp5" class="md-nav__link">
    <span class="md-ellipsis">
      SP5
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Postprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Postprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-nastran-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load Nastran data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structural-verification-of-a-representative-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Structural verification of a representative configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="sail-plane">Sail Plane<a class="headerlink" href="#sail-plane" title="Permanent link">造</a></h1>
<p>Verifying the structural implementation on a clamped configuration.</p>
<h2 id="load-modules">Load modules<a class="headerlink" href="#load-modules" title="Permanent link">造</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pyNastran.op4.op4</span> <span class="k">as</span> <span class="nn">op4</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="n">REMOVE_RESULTS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#   for root, dirs, files in os.walk(&#39;/path/to/folder&#39;):</span>
<span class="c1">#       for f in files:</span>
<span class="c1">#           os.unlink(os.path.join(root, f))</span>
<span class="c1">#       for d in dirs:</span>
<span class="c1">#           shutil.rmtree(os.path.join(root, d))</span>
<span class="c1"># </span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;results&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./figs&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./figs&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">REMOVE_RESULTS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***** creating results folder ******&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
</code></pre></div>
<div id="PYTHONMODULES" class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">feniax.preprocessor.configuration</span> <span class="k">as</span> <span class="nn">configuration</span>  <span class="c1"># import Config, dump_to_yaml</span>
<span class="kn">from</span> <span class="nn">feniax.preprocessor.inputs</span> <span class="kn">import</span> <span class="n">Inputs</span>
<span class="kn">import</span> <span class="nn">feniax.feniax_main</span>
<span class="kn">import</span> <span class="nn">feniax.preprocessor.solution</span> <span class="k">as</span> <span class="nn">solution</span>
<span class="kn">import</span> <span class="nn">feniax.unastran.op2reader</span> <span class="k">as</span> <span class="nn">op2reader</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
</code></pre></div>
<h2 id="run-cases">Run cases<a class="headerlink" href="#run-cases" title="Permanent link">造</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="n">TIMES_DICT</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">SOL</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">clear_caches</span><span class="p">()</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">config</span> <span class="o">=</span>  <span class="n">configuration</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">feniax_main</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">input_obj</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">TIMES_DICT</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>      
    <span class="n">SOL</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span>
    <span class="n">CONFIG</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>

<span class="k">def</span> <span class="nf">save_times</span><span class="p">():</span>
    <span class="n">pd_times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">TIMES_DICT</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                            <span class="n">index</span><span class="o">=</span><span class="n">TIMES_DICT</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">pd_times</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;./run_times.csv&quot;</span><span class="p">)</span>
</code></pre></div>
<div id="SP" class="highlight"><pre><span></span><code><span class="n">SP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/SailPlane&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">FuselageFront</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingInner&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;LWingInner&#39;</span><span class="p">],</span>
                            <span class="n">FuselageBack</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BottomTail&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;Fin&#39;</span><span class="p">],</span>
                            <span class="n">RWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">RWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">LWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">BottomTail</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LHorizontalStabilizer&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RHorizontalStabilizer&#39;</span><span class="p">],</span>
                            <span class="n">RHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">Fin</span><span class="o">=</span><span class="kc">None</span>
                            <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s1">&#39;FEM/&#39;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;newton&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;linalg_norm&quot;</span><span class="p">,</span>
                                           <span class="n">kappa</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># inp.systems.sett.s1.solver_library = &quot;scipy&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_function = &quot;root&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_settings = dict(method=&#39;hybr&#39;,#&#39;krylov&#39;,</span>
<span class="c1">#                                           tolerance=1e-9)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</code></pre></div>
<h3 id="sp1">SP1<a class="headerlink" href="#sp1" title="Permanent link">造</a></h3>
<div id="SP1" class="highlight"><pre><span></span><code><span class="n">SP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/SailPlane&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">FuselageFront</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingInner&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;LWingInner&#39;</span><span class="p">],</span>
                            <span class="n">FuselageBack</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BottomTail&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;Fin&#39;</span><span class="p">],</span>
                            <span class="n">RWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">RWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">LWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">BottomTail</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LHorizontalStabilizer&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RHorizontalStabilizer&#39;</span><span class="p">],</span>
                            <span class="n">RHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">Fin</span><span class="o">=</span><span class="kc">None</span>
                            <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s1">&#39;FEM/&#39;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;newton&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;linalg_norm&quot;</span><span class="p">,</span>
                                           <span class="n">kappa</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># inp.systems.sett.s1.solver_library = &quot;scipy&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_function = &quot;root&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_settings = dict(method=&#39;hybr&#39;,#&#39;krylov&#39;,</span>
<span class="c1">#                                           tolerance=1e-9)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="sp2">SP2<a class="headerlink" href="#sp2" title="Permanent link">造</a></h3>
<div id="SP2" class="highlight"><pre><span></span><code><span class="n">SP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/SailPlane&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">FuselageFront</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingInner&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;LWingInner&#39;</span><span class="p">],</span>
                            <span class="n">FuselageBack</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BottomTail&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;Fin&#39;</span><span class="p">],</span>
                            <span class="n">RWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">RWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">LWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">BottomTail</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LHorizontalStabilizer&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RHorizontalStabilizer&#39;</span><span class="p">],</span>
                            <span class="n">RHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">Fin</span><span class="o">=</span><span class="kc">None</span>
                            <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s1">&#39;FEM/&#39;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;newton&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;linalg_norm&quot;</span><span class="p">,</span>
                                           <span class="n">kappa</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># inp.systems.sett.s1.solver_library = &quot;scipy&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_function = &quot;root&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_settings = dict(method=&#39;hybr&#39;,#&#39;krylov&#39;,</span>
<span class="c1">#                                           tolerance=1e-9)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="sp3">SP3<a class="headerlink" href="#sp3" title="Permanent link">造</a></h3>
<div id="SP3" class="highlight"><pre><span></span><code><span class="n">SP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/SailPlane&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">FuselageFront</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingInner&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;LWingInner&#39;</span><span class="p">],</span>
                            <span class="n">FuselageBack</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BottomTail&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;Fin&#39;</span><span class="p">],</span>
                            <span class="n">RWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">RWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">LWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">BottomTail</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LHorizontalStabilizer&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RHorizontalStabilizer&#39;</span><span class="p">],</span>
                            <span class="n">RHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">Fin</span><span class="o">=</span><span class="kc">None</span>
                            <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s1">&#39;FEM/&#39;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;newton&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;linalg_norm&quot;</span><span class="p">,</span>
                                           <span class="n">kappa</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># inp.systems.sett.s1.solver_library = &quot;scipy&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_function = &quot;root&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_settings = dict(method=&#39;hybr&#39;,#&#39;krylov&#39;,</span>
<span class="c1">#                                           tolerance=1e-9)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="sp4">SP4<a class="headerlink" href="#sp4" title="Permanent link">造</a></h3>
<div id="SP4" class="highlight"><pre><span></span><code><span class="n">SP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/SailPlane&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">FuselageFront</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingInner&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;LWingInner&#39;</span><span class="p">],</span>
                            <span class="n">FuselageBack</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BottomTail&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;Fin&#39;</span><span class="p">],</span>
                            <span class="n">RWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">RWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">LWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">BottomTail</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LHorizontalStabilizer&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RHorizontalStabilizer&#39;</span><span class="p">],</span>
                            <span class="n">RHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">Fin</span><span class="o">=</span><span class="kc">None</span>
                            <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s1">&#39;FEM/&#39;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;newton&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;linalg_norm&quot;</span><span class="p">,</span>
                                           <span class="n">kappa</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># inp.systems.sett.s1.solver_library = &quot;scipy&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_function = &quot;root&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_settings = dict(method=&#39;hybr&#39;,#&#39;krylov&#39;,</span>
<span class="c1">#                                           tolerance=1e-9)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="sp5">SP5<a class="headerlink" href="#sp5" title="Permanent link">造</a></h3>
<div id="SP5" class="highlight"><pre><span></span><code><span class="n">SP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/SailPlane&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">FuselageFront</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingInner&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;LWingInner&#39;</span><span class="p">],</span>
                            <span class="n">FuselageBack</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BottomTail&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;Fin&#39;</span><span class="p">],</span>
                            <span class="n">RWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">RWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LWingInner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LWingOuter&#39;</span><span class="p">],</span>
                            <span class="n">LWingOuter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">BottomTail</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LHorizontalStabilizer&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;RHorizontalStabilizer&#39;</span><span class="p">],</span>
                            <span class="n">RHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">LHorizontalStabilizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">Fin</span><span class="o">=</span><span class="kc">None</span>
                            <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s1">&#39;FEM/&#39;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;newton&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
                                           <span class="n">max_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;linalg_norm&quot;</span><span class="p">,</span>
                                           <span class="n">kappa</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># inp.systems.sett.s1.solver_library = &quot;scipy&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_function = &quot;root&quot;</span>
<span class="c1"># inp.systems.sett.s1.solver_settings = dict(method=&#39;hybr&#39;,#&#39;krylov&#39;,</span>
<span class="c1">#                                           tolerance=1e-9)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>
                                                      <span class="mf">2e5</span><span class="p">,</span>
                                                      <span class="mf">2.5e5</span><span class="p">,</span>
                                                      <span class="mf">3.e5</span><span class="p">,</span>
                                                      <span class="mf">4.e5</span><span class="p">,</span>
                                                      <span class="mf">4.8e5</span><span class="p">,</span>
                                                      <span class="mf">5.3e5</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">save_times</span><span class="p">()</span>
</code></pre></div>
<h2 id="postprocessing">Postprocessing<a class="headerlink" href="#postprocessing" title="Permanent link">造</a></h2>
<h3 id="plotting-functions">Plotting functions<a class="headerlink" href="#plotting-functions" title="Permanent link">造</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Format for figures: </span><span class="si">{</span><span class="n">figfmt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">figformat</span><span class="o">=</span><span class="n">figfmt</span><span class="p">,</span> <span class="n">update_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">update_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">update_layout</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="n">figname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;figs/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">figformat</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../</span><span class="si">{</span><span class="n">figname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">figname</span>
        <span class="k">return</span> <span class="n">inner</span>
    <span class="k">return</span> <span class="n">inner_decorator</span>


<span class="k">def</span> <span class="nf">fig_background</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># if fig.data[0].showlegend is None:</span>
        <span class="c1">#     showlegend = True</span>
        <span class="c1"># else:</span>
        <span class="c1">#     showlegend = fig.data[0].showlegend</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
                       <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">ticks</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
                       <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="c1">#zeroline=True,</span>
        <span class="c1">#zerolinewidth=2,</span>
            <span class="c1">#zerolinecolor=&#39;LightPink&#39;,</span>
                       <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">ticks</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
                       <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                          <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">),</span>
                          <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#showlegend,</span>
                          <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                              <span class="n">autoexpand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">b</span><span class="o">=</span><span class="mi">0</span>
                          <span class="p">))</span>
        <span class="k">return</span> <span class="n">fig</span>
    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fn_spError</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">print_info</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="n">sol_sp</span><span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./SP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
    <span class="n">err</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_L</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mf">0.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)}</span>
    <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span> <span class="c1"># loads</span>
      <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>  <span class="c1"># modes</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">r_spn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r_sp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">df_grid</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
          <span class="n">r_spn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_sp</span><span class="p">[</span><span class="n">li</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
          <span class="n">r_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol_sp</span><span class="p">[</span><span class="n">mi</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">staticsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">[</span><span class="n">li</span><span class="p">,:,</span><span class="n">index</span><span class="p">])</span>
          <span class="c1"># print(f&quot;nas = {r_spn}  ,  {r_sp}&quot;)</span>
          <span class="c1"># count += 1</span>
        <span class="n">r_spn</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_spn</span><span class="p">)</span>
        <span class="n">r_sp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_sp</span><span class="p">)</span>        
        <span class="n">err</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;M</span><span class="si">{</span><span class="n">mi</span><span class="si">}</span><span class="s2">_L</span><span class="si">{</span><span class="n">li</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r_spn</span> <span class="o">-</span> <span class="n">r_sp</span><span class="p">)</span> <span class="c1">#/ jnp.linalg.norm(r_spn)</span>
        <span class="n">err</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;M</span><span class="si">{</span><span class="n">mi</span><span class="si">}</span><span class="s2">_L</span><span class="si">{</span><span class="n">li</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_sp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">print_info</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**** LOAD: </span><span class="si">{</span><span class="n">li</span><span class="si">}</span><span class="s2">, NumModes: </span><span class="si">{</span><span class="n">mi</span><span class="si">}</span><span class="s2"> ****&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;M</span><span class="si">{</span><span class="n">mi</span><span class="si">}</span><span class="s2">_L</span><span class="si">{</span><span class="n">li</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">err</span>

<span class="k">def</span> <span class="nf">fn_spWingsection</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>

    <span class="n">sol_sp</span><span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./SP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
    <span class="n">r_spn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">r_spnl</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">r_sp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span> <span class="c1"># loads</span>
      <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="c1">#range(1,6):  # modes</span>
        <span class="n">r_spni</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r_spnli</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r_spi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r_sp0</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">df_grid</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
          <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">fe_order</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)):</span>
            <span class="n">r_sp0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>  
            <span class="n">r_spni</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_sp</span><span class="p">[</span><span class="n">li</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">r_spnli</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_spl</span><span class="p">[</span><span class="n">li</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">r_spi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol_sp</span><span class="p">[</span><span class="n">mi</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">staticsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">[</span><span class="n">li</span><span class="p">,:,</span><span class="n">index</span><span class="p">])</span>
          <span class="c1"># print(f&quot;nas = {r_spn}  ,  {r_sp}&quot;)</span>
          <span class="c1"># count += 1</span>

        <span class="n">r_spn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_spni</span><span class="p">))</span>
        <span class="n">r_spnl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_spnli</span><span class="p">))</span>
        <span class="n">r_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_spi</span><span class="p">))</span>
    <span class="n">r_sp0</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_sp0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r_sp0</span><span class="p">,</span> <span class="n">r_sp</span><span class="p">,</span> <span class="n">r_spn</span><span class="p">,</span> <span class="n">r_spnl</span>

<span class="nd">@fig_background</span>
<span class="k">def</span> <span class="nf">plot_spWingsection</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">rn</span><span class="p">,</span> <span class="n">rnl</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># colors=[&quot;darkgrey&quot;, &quot;darkgreen&quot;,</span>
    <span class="c1">#         &quot;blue&quot;, &quot;magenta&quot;, &quot;orange&quot;, &quot;black&quot;]</span>
    <span class="c1"># dash = [&#39;dash&#39;, &#39;dot&#39;, &#39;dashdot&#39;]</span>
    <span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">li</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>   
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">((</span><span class="n">r</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">r0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                                     <span class="p">),</span>
                                  <span class="nb">dict</span><span class="p">())</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">((</span><span class="n">rn</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">rn</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rn</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">r0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;FullFE-NL&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">)</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">((</span><span class="n">rnl</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">rnl</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rnl</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">r0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;FullFE-Lin&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>

      <span class="k">else</span><span class="p">:</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">((</span><span class="n">r</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">r0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                                     <span class="p">),</span>
                                  <span class="nb">dict</span><span class="p">())</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">((</span><span class="n">rn</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">rn</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rn</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">r0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">)</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">((</span><span class="n">rnl</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">rnl</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rnl</span><span class="p">[</span><span class="n">li</span><span class="p">][:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">r0</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>            
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large u_z [m]$&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large S [m]$&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mf">6.81</span><span class="p">,</span><span class="mi">36</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">),</span>
                      <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
    <span class="c1"># fig = uplotly.lines2d((rnl[:,0]**2 + rnl[:,1]**2)**0.5, rnl[:,2], fig,</span>
    <span class="c1">#                       dict(name=f&quot;NASTRAN-101&quot;,</span>
    <span class="c1">#                            line=dict(color=&quot;grey&quot;,</span>
    <span class="c1">#                                      dash=&quot;solid&quot;)</span>
    <span class="c1">#                                  ),</span>
    <span class="c1">#                             dict())</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="nd">@fig_background</span>
<span class="k">def</span> <span class="nf">fn_spPloterror</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>

    <span class="n">loads</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">530</span><span class="p">]</span>
    <span class="n">num_modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
    <span class="n">e250</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">error</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_L1&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)])</span>
    <span class="n">e400</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">error</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_L3&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)])</span>
    <span class="n">e530</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">error</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_L5&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)])</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">num_modes</span><span class="p">,</span> <span class="n">e250</span> <span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;F = 250 KN&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">num_modes</span><span class="p">,</span> <span class="n">e400</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;F = 400 KN&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">num_modes</span><span class="p">,</span> <span class="n">e530</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;F = 530 KN&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dot&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of modes&#39;</span><span class="p">})</span><span class="c1">#title=&quot;Number of modes&quot;,title_font=dict(size=20))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\Large \epsilon$&quot;</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="c1"># tickformat= &#39;.1r&#39;,</span>
                     <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span> <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
                     <span class="c1">#dtick=0.2,</span>
                     <span class="c1">#tickvals=[2e-2, 1e-2, 7e-3,5e-3,3e-3, 2e-3, 1e-3,7e-4, 5e-4,3e-4, 2e-4, 1e-4, 7e-5, 5e-5]</span>
                     <span class="p">)</span>
    <span class="c1">#fig.update_layout(height=650)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="nd">@fig_background</span>
<span class="k">def</span> <span class="nf">fn_spPloterror3D</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">error3d</span><span class="p">):</span>

    <span class="n">loads</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">530</span><span class="p">]</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">loads</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error ASET&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;square&quot;</span><span class="p">)</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">loads</span><span class="p">,</span> <span class="n">error3d</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error full 3D&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">tickformat</span><span class="o">=</span> <span class="s1">&#39;.0e&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="c1">#height=700,</span>
                      <span class="c1"># showlegend=False,</span>
                      <span class="c1">#legend=dict(x=0.7, y=0.95),</span>
                      <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Loading [KN]&#39;</span><span class="p">,</span>
                      <span class="n">yaxis_title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Large \epsilon$&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="nd">@fig_background</span>
<span class="k">def</span> <span class="nf">plot_spAD</span><span class="p">(</span><span class="n">rn</span><span class="p">,</span> <span class="n">r0</span><span class="p">):</span>

    <span class="n">loads</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">530</span><span class="p">]</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">rn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">r0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="c1">#name=&quot;Error ASET&quot;,</span>
                                     <span class="c1">#line=dict(color=&quot;red&quot;),</span>
                                     <span class="c1">#marker=dict(symbol=&quot;square&quot;)</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>


    <span class="c1">#fig.update_yaxes(type=&quot;log&quot;, tickformat= &#39;.0e&#39;)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="c1">#height=700,</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">xaxis_title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Large{\tau}$&#39;</span><span class="p">,</span>
                      <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Uz [m]&#39;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div>
<h3 id="load-nastran-data">Load Nastran data<a class="headerlink" href="#load-nastran-data" title="Permanent link">造</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">feniax.preprocessor.configuration</span> <span class="k">as</span> <span class="nn">configuration</span>  <span class="c1"># import Config, dump_to_yaml</span>
<span class="kn">from</span> <span class="nn">feniax.preprocessor.inputs</span> <span class="kn">import</span> <span class="n">Inputs</span>
<span class="kn">import</span> <span class="nn">feniax.feniax_main</span>
<span class="kn">import</span> <span class="nn">feniax.preprocessor.solution</span> <span class="k">as</span> <span class="nn">solution</span>
<span class="kn">import</span> <span class="nn">feniax.unastran.op2reader</span> <span class="k">as</span> <span class="nn">op2reader</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>


<span class="n">examples_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../../../../examples&quot;</span><span class="p">)</span>
<span class="c1">####### SailPlane ###########</span>
<span class="n">SP_folder</span> <span class="o">=</span> <span class="n">examples_path</span> <span class="o">/</span> <span class="s2">&quot;SailPlane&quot;</span>
<span class="c1">#nastran_path = wingSP_folder / &quot;NASTRAN/&quot;</span>

<span class="n">op2model</span> <span class="o">=</span> <span class="n">op2reader</span><span class="o">.</span><span class="n">NastranReader</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s2">&quot;NASTRAN/static400/run.op2&quot;</span><span class="p">,</span>
                                   <span class="n">SP_folder</span> <span class="o">/</span> <span class="s2">&quot;NASTRAN/static400/run.bdf&quot;</span><span class="p">,</span>
                                 <span class="n">static</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">op2model</span><span class="o">.</span><span class="n">readModel</span><span class="p">()</span>
<span class="n">t_sp</span><span class="p">,</span> <span class="n">u_sp</span> <span class="o">=</span> <span class="n">op2model</span><span class="o">.</span><span class="n">displacements</span><span class="p">()</span>

<span class="n">op2modell</span> <span class="o">=</span> <span class="n">op2reader</span><span class="o">.</span><span class="n">NastranReader</span><span class="p">(</span><span class="n">SP_folder</span> <span class="o">/</span> <span class="s2">&quot;NASTRAN/static400/run_linear.op2&quot;</span><span class="p">,</span>
                                   <span class="n">SP_folder</span> <span class="o">/</span> <span class="s2">&quot;NASTRAN/static400/run_linear.bdf&quot;</span><span class="p">,</span>
                                 <span class="n">static</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">op2modell</span><span class="o">.</span><span class="n">readModel</span><span class="p">()</span>
<span class="n">t_spl</span><span class="p">,</span> <span class="n">u_spl</span> <span class="o">=</span> <span class="n">op2modell</span><span class="o">.</span><span class="n">displacements</span><span class="p">()</span>
<span class="n">sp_error3d</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">examples_path</span><span class="o">/</span> <span class="s2">&quot;SailPlane/sp_err.npy&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="structural-verification-of-a-representative-configuration">Structural verification of a representative configuration<a class="headerlink" href="#structural-verification-of-a-representative-configuration" title="Permanent link">造</a></h3>
<ol>
<li>
<p>Geometrically nonlinear static response</p>
<p>The static equilibrium of the aircraft under prescribed loads is
first studied with follower loads normal to the wing applied at the
tip of each wing (nodes 25 and 48). The response for an increasing
load stepping of 200, 300, 400, 480 and 530 KN is computed. The
snippet of the inputs and simulation call are given in Listing
<code>\ref{code:static}</code>.</p>
<p><div class="highlight"><pre><span></span><code>\begin{listing}[!ht]
\begin{minted}[frame=single]{python}
import feniax.preprocessor.configuration as configuration
from feniax.preprocessor.inputs import Inputs
import feniax.feniax_main
inp = Inputs()
inp.fem.folder = &quot;./FEM/&quot;
inp.fem.num_modes = 50
inp.systems.sett.s1.solution = &quot;static&quot;
inp.systems.sett.s1.solver_library = &quot;diffrax&quot;
inp.systems.sett.s1.solver_function = &quot;newton&quot;
inp.systems.sett.s1.solver_settings = dict(rtol=1e-6,
                                           atol=1e-6,
                                           max_steps=50,
                                           norm=&quot;linalg_norm&quot;)
inp.systems.sett.s1.xloads.follower_forces = True
inp.systems.sett.s1.xloads.follower_points = [[25, 2], [48, 2]]
inp.systems.sett.s1.xloads.x = [0, 1, 2, 3, 4, 5, 6]
inp.systems.sett.s1.xloads.follower_interpolation =
[[0., 2e5, 2.5e5, 3.e5, 4.e5, 4.8e5, 5.3e5],
[0., 2e5, 2.5e5, 3.e5, 4.e5, 4.8e5, 5.3e5]]
inp.systems.sett.s1.t = [1, 2, 3, 4, 5, 6]
config =  configuration.Config(inp)
sol = feniax.feniax_main.main(input_obj=config)
\end{minted}
\caption{FENIAX inputs for structural static simulation}
\label{code:static}
\end{listing}
</code></pre></div>
Nonlinear static simulations on the original full model (before
condensation) are also carried out in MSC Nastran and are included.
The interpolation elements in the full FE solver are used to output
the displacements at the condensation nodes for direct comparison
with the NMROM results. Geometric nonlinearities are better
illustrated by representing a sectional view of the wing as in Fig.
<a href="#fig:SPWingsection">1</a>, where deformations in the z-direction
versus the metric $S = \sqrt{x^2+y^2}$ are shown. MSC Nastran linear
solutions (Solution 101) are also included to appreciate more
clearly the shortening and follower force effects in the nonlinear
computations.</p>
<div id="SPWingsection" class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">feniax.preprocessor.configuration</span> <span class="k">as</span> <span class="nn">configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;SP1/config.yaml&quot;</span><span class="p">)</span>
<span class="n">sol_sp</span><span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./SP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">r_sp0</span><span class="p">,</span> <span class="n">r_sp</span><span class="p">,</span> <span class="n">r_spn</span><span class="p">,</span> <span class="n">r_spnl</span> <span class="o">=</span> <span class="n">fn_spWingsection</span><span class="p">(</span><span class="n">sol_sp</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">plot_spWingsection</span><span class="p">)(</span><span class="n">r_sp0</span><span class="p">,</span> <span class="n">r_sp</span><span class="p">,</span> <span class="n">r_spn</span><span class="p">,</span> <span class="n">r_spnl</span><span class="p">)</span>
<span class="n">figname</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code>#+name: fig:SPWingsection
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+caption: Static geometrically-nonlinear effects on the aircraft main wing
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+attr_latex: :width 0.5\textwidth
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+results: SPWingsection
</code></pre></div>
<a href="">file:</a></p>
<p>The tolerance in the Newton solver was set to $10^{-6}$ in all
cases. A convergence analysis with the number of modes in the
solution is presented in Fig. <a href="#SPstatic_convergence">1</a>. 5, 15, 30,
50, 100 modes are used to build the corresponding NMROMs. The error
metric is defined as the $\ell^2$ norm divided by the total number
of nodes (only the condenses ones in this case):
$\epsilon = ||u_{NMROM} - u_{NASTRAN}||/N_{nodes}$. It can be seen
the solution with 50 modes already achieves a very good solution
even for the largest load which produces a 25.6$\%$ tip deformation
of the wing semi-span, $b = 28.8$ m. The displacement difference
with the full FE solution at the tip in this case is less than
0.2$\%$.</p>
<div id="SPerror" class="highlight"><pre><span></span><code><span class="n">config</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;SP1/config.yaml&quot;</span><span class="p">)</span>
<span class="n">sol_sp</span><span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./SP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">sp_error</span> <span class="o">=</span> <span class="n">fn_spError</span><span class="p">(</span><span class="n">sol_sp</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">print_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">fn_spPloterror</span><span class="p">)(</span><span class="n">sp_error</span><span class="p">)</span>
<span class="n">figname</span>
</code></pre></div>
<p><img alt="Modal convergence static solution of representative
aircraft" id="SPstatic_convergence" src="../figs/SPerror.png" /></p>
<p>The 3D structural response has been reconstructed using the approach
in Fig. . The nodes connected by the interpolation elements (RBE3s)
to the ASET solution are reconstructed first and subsequently a
model with RBFs kernels is used to extrapolate to the rest of the
nodes in the full FE. A very good agreement is found against the
geometrically-nonlinear Nastran solution (SOL 400). Fig.
<a href="#SPstatic_3D">2</a> shows the overlap in the Nastran solution (in red)
and the NMROM (in blue) for the 530 KN loading.</p>
<p><div class="highlight"><pre><span></span><code>#+name: SPstatic_3D
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+caption: Static 3D solution for a solution with 50 modes and 530 KN loading (Full NASTRAN solution in red versus the NMROM in blue).
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+attr_latex: :width 0.7\textwidth
</code></pre></div>
<img alt="" src="../figs_ext/SP_3Dloading-front2.png" />
<img alt="" src="../figs_ext/SP_3Dloading-side.png" /> The error metric of this 3D
solution is also assessed in Fig. <a href="#fig:SPerror3D">2</a>, for the
solution with 50 modes. The discrepancy metric is of the same order
than the previously shown at the reduction points. This conveys an
important point, that there is no significant accuracy loss in the
process of reconstructing the 3D solution.</p>
<div id="SPerror3D" class="highlight"><pre><span></span><code><span class="n">sp_error1D</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp_error</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;M4_L</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="c1"># fig, figname = fig_out(name)(fn_spPloterror3D)(sp_error1D, sp_error3d)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">update_layout</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">))(</span><span class="n">fn_spPloterror3D</span><span class="p">)(</span><span class="kc">None</span><span class="p">,</span> <span class="n">sp_error3d</span><span class="p">)</span>
<span class="n">figname</span>
</code></pre></div>
<p><img alt="Relative error between full FE and NMROM
solutions" id="fig:SPerror3D" src="../figs/SPerror3D.png" /></p>
<p>Next we compare the computational times for the various solutions
presented in this section in Table <a href="#table:SP_times">1</a>.
Computations of the six load steps in Fig. <a href="#fig:SPWingsection">1</a>
are included in the assessment. A near 50 times speed-up is achieved
with our solvers compared to Nastran nonlinear solution, which is
one of the main strengths of the proposed method. As expected, the
linear static solution in Nastran is the fastest of the results,
given it only entails solving a linear, very sparse system of
equations.</p>
<div id="SP_times" class="highlight"><pre><span></span><code><span class="n">dfruns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./run_times.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dfruns</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SP</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mi">45</span><span class="p">]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">1.02</span><span class="p">]</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NMROM (modes: 5, 15, 30, 50, 100)&quot;</span><span class="p">]</span>
<span class="n">header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;NASTRAN 400&quot;</span><span class="p">]</span>
<span class="n">header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;NASTRAN 101&quot;</span><span class="p">]</span>
<span class="c1"># df_sp = pd.DataFrame(dict(times=TIMES_DICT.values()),</span>
<span class="c1">#                         index=TIMES_DICT.keys())</span>

<span class="c1"># df_ = results_df[&#39;shift_conm2sLM25&#39;]</span>
<span class="c1"># df_ = df_.rename(columns={&quot;xlabel&quot;: &quot;%Chord&quot;})</span>
<span class="n">tabulate</span><span class="p">([</span><span class="n">values</span><span class="p">],</span> <span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;orgtbl&#39;</span><span class="p">)</span>
</code></pre></div>
<pre><code>           NMROM (modes: 5, 15, 30, 50, 100)   NASTRAN 400   NASTRAN 101
</code></pre>
<hr />
<dl>
<dt>Time <script type="math/tex; mode=display">s</script>   6.7, 6.63, 6.79, 7.06, 9.55         345           1.02</dt>
<dd>
<p>Computational times static solution</p>
</dd>
</dl>
</li>
<li>
<p>Differentiation of static response</p>
<p>The AD for the static solvers is first verified as follows: the load
stepping shown above becomes a pseudo-time interpolation load such
that a variable $\tau$ controls the amount of loading and we look at
the variation of the wing-tip displacement as a function of this
$\tau$. If
$f(\tau=[1, 2, 3, 4, 5, 6]) = [200, 250, 300, 400, 480, 530]$ KN,
with a linear interpolation between points, the derivative of the
z-component of the tip of the wing displacement is computed at
$\tau= 1.5, 3.5, 5.5 $, as show in Fig. <a href="#fig:sp_ad">3</a> where the
$y$-axis is the tip displacement, $\tau$ is in the $x$-axis and the
big red circles the points where the derivatives are computed
(coincident to the graph slope at those points).</p>
<div id="SP_AD" class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">plot_spAD</span><span class="p">)(</span><span class="n">r_sp</span><span class="p">,</span> <span class="n">r_sp0</span><span class="p">)</span>
<span class="c1">#figname</span>
</code></pre></div>
<dl>
<dt><div class="highlight"><pre><span></span><code>#+name: fig:sp_ad
</code></pre></div></dt>
<dt><div class="highlight"><pre><span></span><code>#+caption: Static tip displacement with pseudo-time stepping load
</code></pre></div></dt>
<dt><div class="highlight"><pre><span></span><code>#+attr_latex: :width 0.5\textwidth
</code></pre></div></dt>
<dt><file:figs_ext/sp_ad.pdf> Table <a href="#table:SP_AD">2</a> shows a very good</dt>
<dt>agreement against finite-differences (FD) with an epsilon of</dt>
<dt>$10^{-3}$. Note how the derivative at each of the marked points</dt>
<dt>corresponds approximately to the slope in the graph at those very</dt>
<dt>points, which varies as the load steps are not of equal length. And</dt>
<dt>the biggest slope occurs precisely in between $\tau$ of 4 and 5 when</dt>
<dt>the prescribed loading undergoes the biggest change from 300 to 400</dt>
<dt>KN.</dt>
<dt><div class="highlight"><pre><span></span><code>      $\tau$   $f(\tau)$ \[m\]   $f&#39;(\tau)$ (AD)   $f&#39;(\tau)$ (FD)
      -------- ----------------- ----------------- -----------------
      1.5      2.81              0.700             0.700
      3.5      4.527             1.344             1.344
      5.5      6.538             0.623             0.623
</code></pre></div></dt>
<dd>AD verification structural static problem</dd>
</dl>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Summary">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Summary
              </div>
            </div>
          </a>
        
        
          
          <a href="../../wingSP/wingSP_nb/" class="md-footer__link md-footer__link--next" aria-label="Next: Wing nonlinear dynamics">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Wing nonlinear dynamics
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>