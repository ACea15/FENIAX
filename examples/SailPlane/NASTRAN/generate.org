* House keeping
#+begin_src elisp :results none
  (setq org-confirm-babel-evaluate nil)
  (require 'org-tempo)
  (pyvenv-workon "feniax.)
#+end_src

* INPUT PARAMETERS
#+NAME: python_parameters
#+begin_src python :session py1 :var output="num_modes" :results value :tangle py1.py
  import numpy as np
  import feniax.unastran.aero as nasaero
  mach = 0.8
  Mach = str(mach).replace('.','_')
  machs = [mach]
  reduced_freqs = np.hstack([1e-6, np.linspace(1e-3,1, 50)])#np.hstack([np.linspace(1e-5,1, 50), [10-0.001, 10., 10+0.001]])
  num_modes = 50
  chord_panels = dict(wing=15, hstabilizer=10, vstabilizer=10)
  #aero['s_ref'] = 361.6
  #aero['b_ref'] = 58.0
  #aero['X_ref'] = 36.3495
  flutter_id = 9010
  mach_fact = machs
  kv_fact = [200., 220.]
  u_inf = 200.
  rho_inf = 1.5
  density_fact = [rho_inf]
  c_ref = 1.
  b_ref = 28.8*2
  S_ref = b_ref * c_ref
  rho_ref=rho_inf
  q_inf = 0.5 * rho_inf * u_inf ** 2
  alpha_sol144 = 1 * np.pi / 180
  flutter_method="PK"
  flutter_sett = dict()
  aero_sett = dict()
  num_poles = 5
  gust_lengths = [18.0,42.,67.,91.,116.,140.,165.0,189.,214.]
  eval(output)
#+end_src

#+begin_src python :session py1  :results none :tangle py1.py
  def wb2w(point_le, x_te, z_bottom, pct2le, pct2te):
      """ Wing-box to wing"""

      x = x_te - point_le[0]
      pct_wb = (pct2te - pct2le)
      chord = x / pct_wb
      LE = point_le[0] - chord * pct2le
      point_LE = [LE, point_le[1], (point_le[2] +
                                    z_bottom) / 2]
      return point_LE, chord

#+end_src
* Solution folder
#+begin_src org :tangle "./data_out/README.org" :mkdirp yes :noweb yes
  ,* DLM output analysis
  ,** GAFs:
  - Qhh:
  - Qhj:
  ,** DLM points
  
#+end_src
** clean folders
#+begin_src sh :tangle "./clean.sh" :results none
  rm -r ./GAFs ./SOL103 ./geometry ./GAFs_Qx
#+end_src

* Modal Solution
#+begin_src org :tangle "./SOL103/run_cao.bdf" :mkdirp yes :noweb yes
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ EXECUTIVE CONTROL								  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  SOL 103
  DIAG  20

  CEND

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ CASE CONTROL									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  TITLE=SailPlane #                                 
  ECHO=NONE                      	  
  DISP=ALL                                
  SPC = 2
  METHOD = 100

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ BULK   									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  BEGIN BULK
  PARAM,BAILOUT,0
  PARAM,GRDPNT,0                                                              
  PARAM,K6ROT,1.0
  PARAM,SNORM,20.0
  PARAM,POST,-1
  PARAM,MAXRATIO,1.0E07
  $PARAM,EXTOUT,DMIGPCH
  EIGRL,100,,,<<python_parameters(output="num_modes")>>

  SPC1           1  123456  999079
  SPCADD         2       1
  INCLUDE '../base.bdf'
  INCLUDE '../asets_clamped.bdf'

  ENDDATA

#+end_src

#+begin_src bash :tangle "./SOL103/run.sh" :mkdirp yes :shebang   #!/usr/bin/zsh -i :results none
  cd SOL103
  nastran run_cao.bdf
#+end_src

#+begin_src org :tangle "./SOL103/run_cfo.bdf" :mkdirp yes :noweb yes
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ EXECUTIVE CONTROL								  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  SOL 103
  DIAG  20

  CEND

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ CASE CONTROL									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  TITLE=SailPlane #                                 
  ECHO=NONE                      	  
  DISP=ALL                                
  SPC = 2
  METHOD = 100

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ BULK   									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  BEGIN BULK
  PARAM,BAILOUT,0
  PARAM,GRDPNT,0                                                              
  PARAM,K6ROT,1.0
  PARAM,SNORM,20.0
  PARAM,POST,-1
  PARAM,MAXRATIO,1.0E07
  $PARAM,EXTOUT,DMIGPCH
  EIGRL,100,,,<<python_parameters(output="num_modes")>>

  SPC1           1  123456  999079
  SPCADD         2       1
  INCLUDE '../base.bdf'
  $ INCLUDE '../asets_clamped.bdf'

  ENDDATA

#+end_src

#+begin_src bash :tangle "./SOL103/run2.sh" :mkdirp yes :shebang   #!/usr/bin/zsh -i :results none
  cd SOL103
  nastran run_cfo.bdf
#+end_src

** Build modes in OP4
#+begin_src python :session py1  :results none 
  #from feniax.utils import write_op4modes
  import feniax.unastran.op4handler as op4handler
  eigs, modes = op4handler.write_op4modes("./SOL103/run_cao",
                               num_modes,
                               op4_name=f"./data_out/Phi{num_modes}",
                               return_modes=True)

  num_nodes = 79
  eigs = np.array(eigs)
  modes4sims = np.zeros((6*(num_nodes - 1), num_modes))
  for i in range(num_modes):
      modes4sims[:, i] = np.hstack(modes[i,:(num_nodes - 1)])
  SAVE = True
  #np.load("../FEM/Ka.npy")
  #scipy.linalg.eigh(Ka, Ma)
  if SAVE:
      np.save("../FEM/eigenvecs.npy", modes4sims)
      np.save("../FEM/eigenvals.npy", eigs)

#+end_src


** VTK modes
#+begin_src python :session py1 :results none :tangle py1.py
  import feniax.plotools.nastranvtk.bdfdef as bdfdef
  import  importlib
  #importlib.reload(modes)
  bdfdef.vtkModes_fromop2("./SOL103/run_cao.bdf", "./SOL103/run_cao.op2", modes2plot=range(40))
  #modes.vtk_fromop2("./SOL103/run_cao.bdf", "./SOL103/run_cao.op2", scale = 100.)
#+end_src

#+begin_src python :session py1 :results none :tangle py1.py
  import feniax.plotools.nastranvtk.bdfdef as bdfdef
  import  importlib
  #importlib.reload(modes)
  bdfdef.vtkModes_fromop2("./SOL103/run_cfo.bdf", "./SOL103/run_cfo.op2", modes2plot=range(40))
  #modes.vtk_fromop2("./SOL103/run_cao.bdf", "./SOL103/run_cao.op2", scale = 100.)
#+end_src

* SOL400 (structure-only)
#+begin_src python :session py1 :results none :tangle py1.py
  import feniax.unastran.op2reader as op2reader
  import feniax.plotools.nastranvtk.modes as modes
  import  importlib
  import copy
  importlib.reload(modes)
  sol400s  = op2reader.NastranReader("./static400/run", "./static400/run", static=True)
  sol400s.readModel()
  u400s = sol400s.displacements()
  # from pyNastran.bdf.bdf import BDF
  # bdf = BDF()
  # bdf.read_bdf("./static400/run.bdf")
  s400 = modes.ParseBDF("./static400/run.bdf")
  noderef = copy.copy(s400.get_nodes())
  for i, ui in enumerate(u400s):
      s400.update_bdf(noderef + ui[:,:3], s400.sorted_nodeids)
      s400.plot_vtk(f"./static400/vtk/load{i}")
#+end_src

* DLM model
** Inputs
#+begin_src python :session py1  :results none :tangle py1.py
  NumSurfaces = 9
  p1 = []
  x12 = []
  p4 = []
  x43 = []
  nspan = []
  nchord = []
  set1x = []
  components = []
  ##############FUSELAGE#######################
  ###
  ##############InnerWingR#######################
  components.append("InnerWingR")
  zcorr = 0.40135 / 0.3795
  point_LE1, l1 = wb2w(point_le=[3.94, 0, 0.231 * zcorr],
                       x_te=8.49,
                       z_bottom=-0.49 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[3.94, 2.793, 0.231 * zcorr],
                       x_te=8.49,
                       z_bottom=-0.49 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)

  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(4)
  nchord.append(chord_panels['wing'])
  #set1x.append([10040069, 10040066, 10040063, 10040060, 10040000])
  set1x.append([999023, 999022, 999021, 999020, 999000])
  ##################OuterWingR#####################
  components.append("OuterWingR")
  point_LE1, l1 = wb2w(point_le=[3.94, 2.793, 0.231 * zcorr],
                       x_te=8.49,
                       z_bottom=-0.49 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[19.23, 28.8, -0.304 * zcorr],
                       x_te=20.47,
                       z_bottom=-0.455 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)
  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(19)
  nchord.append(chord_panels['wing'])
  set1x.append([999000,
                999001,
                999002,
                999003,
                999004,
                999005,
                999006,
                999007,
                999008,
                999009,
                999010,
                999011,
                999012,
                999013,
                999014,
                999015,
                999016,
                999017,
                999018,
                999019])

  ##############InnerWingL#######################
  components.append("InnerWingL")
  point_LE1, l1 = wb2w(point_le=[3.94, 0, 0.231 * zcorr],
                       x_te=8.49,
                       z_bottom=-0.49 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[3.94, -2.793, 0.231 * zcorr],
                       x_te=8.49,
                       z_bottom=-0.49 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)

  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(4)
  nchord.append(chord_panels['wing'])
  #set1x.append([10040069, 10040066, 10040063, 10040060, 10040000])
  set1x.append([999023, 999057, 999056, 999055, 999035])
  ##################OuterWingL#####################
  components.append("OuterWingL")
  point_LE1, l1 = wb2w(point_le=[3.94, -2.793, 0.231 * zcorr],
                       x_te=8.49,
                       z_bottom=-0.49 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[19.23, -28.8, -0.304 * zcorr],
                       x_te=20.47,
                       z_bottom=-0.455 * zcorr,
                       pct2le=0.15,
                       pct2te=0.6)
  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(19)
  nchord.append(chord_panels['wing'])
  set1x.append([999035,
                999036,
                999037,
                999038,
                999039,
                999040,
                999041,
                999042,
                999043,
                999044,
                999045,
                999046,
                999047,
                999048,
                999049,
                999050,
                999051,
                999052,
                999053,
                999054])

  ##################ENGINES######################
  ###
  #####################TAILPLANE######
  #hstabilizerInnerR
  components.append("hstabilizerInnerR")
  point_LE1, l1 = wb2w(point_le=[36.363, 0, 3.225],
                       x_te=40.236,
                       z_bottom=2.875,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[36.363, 0.5, 3.225],
                       x_te=40.236,
                       z_bottom=2.875,
                       pct2le=0.15,
                       pct2te=0.6)

  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(1)
  nchord.append(chord_panels['hstabilizer'])
  set1x.append([999034, 999024])
  #hstabilizerOuterR
  components.append("hstabilizerOuterR")
  point_LE1, l1 = wb2w(point_le=[36.363, 0.5, 3.225],
                       x_te=40.236,
                       z_bottom=2.875,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[42.377, 8.9, 3.96],
                       x_te=43.781,
                       z_bottom=3.82,
                       pct2le=0.15,
                       pct2te=0.6)

  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(9)
  nchord.append(chord_panels['hstabilizer'])
  set1x.append([999024,
                999025,
                999026,
                999027,
                999028,
                999029,
                999030,
                999031,
                999032,
                999033])
  #hstabilizerInnerL
  components.append("hstabilizerInnerL")
  point_LE1, l1 = wb2w(point_le=[36.363, 0, 3.225],
                       x_te=40.236,
                       z_bottom=2.875,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[36.363, -0.5, 3.225],
                       x_te=40.236,
                       z_bottom=2.875,
                       pct2le=0.15,
                       pct2te=0.6)

  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(1)
  nchord.append(chord_panels['hstabilizer'])
  set1x.append([999034,
                999068])

  #hstabilizerOuterL
  components.append("hstabilizerOuterL")
  point_LE1, l1 = wb2w(point_le=[36.363, -0.5, 3.225],
                       x_te=40.236,
                       z_bottom=2.875,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[42.377, -8.9, 3.96],
                       x_te=43.781,
                       z_bottom=3.82,
                       pct2le=0.15,
                       pct2te=0.6)

  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(9)
  nchord.append(chord_panels['hstabilizer'])
  set1x.append([999068,
                999069,
                999070,
                999071,
                999072,
                999073,
                999074,
                999075,
                999076,
                999077])
  #vstabilizer
  # WARNING: y-midplane not implemented
  components.append("vstabilizer")
  point_LE1, l1 = wb2w(point_le=[34.54, 0., 3.3],
                       x_te=39.983,
                       z_bottom=3.3,
                       pct2le=0.15,
                       pct2te=0.6)
  point_LE2, l2 = wb2w(point_le=[42.236, 0., 13],
                       x_te=44.227,
                       z_bottom=13,
                       pct2le=0.15,
                       pct2te=0.6)

  p1.append(point_LE1)
  x12.append(l1)
  p4.append(point_LE2)
  x43.append(l2)
  nspan.append(9)
  nchord.append(chord_panels['vstabilizer'])
  set1x.append([999058,
                999059,
                999060,
                999061,
                999062,
                999063,
                999064,
                999065,
                999066,
                999067])

#+end_src
** Build
#+begin_src python :session py1 :results none :tangle py1.py
  dlm_panels = nasaero.GenDLMPanels(components,
                                    NumSurfaces,
                                    p1,
                                    x12,
                                    p4,
                                    x43,
                                    nspan,
                                    nchord,
                                    set1x,
                                    spline_type=6)
  dlm_panels.build_model()
  dlm_panels.model.write_bdf("./dlm_model.bdf")
  dlm_panels.save_yaml("./dlm_model.yaml")
  dlm_panels2= nasaero.GenDLMPanels.from_file("./dlm_model.yaml")
  dlm_panels2 == dlm_panels
#+end_src

** Plot
#+begin_src python :session py1 :results none :tangle py1.py
  import feniax.aeromodal.panels as panels
  import pathlib
  grid = panels.caero2grid(components, dlm_panels.caero1)
  panels.build_gridmesh(grid, 'dlm_mesh')

#+end_src

#+begin_src python :session py1 :results none
  import pyvista
  import pathlib
  file_path = pathlib.Path('./try')
  file_path.mkdir(parents=True, exist_ok=True)
  npanels, npoints = dlm_panels.model.caeros[10080000].get_npanel_points_elements()
  from dataclasses import dataclass
  @dataclass
  class Grid:
      caeros: list
      labels: dict
      npanels: dict
      npoints: dict
      panel_ids: dict
      points: dict
      cells: dict
      def get(self, name, label):
          caero = self.labels[label]
          attr = getattr(self, name)
          return attr[caero]

  def build_grid(model) -> Grid:
      npanels = dict()
      npoints = dict()
      panel_ids = dict()
      points = dict()
      cells = dict()
      caeros = list()
      labels = dict()
      for i, ci in enumerate(model.caeros.keys()):
          caeros.append(ci)
          labels[model.caeros[ci].comment.strip()] = ci
          _npanels, _npoints = model.caeros[ci].get_npanel_points_elements()
          npanels[ci] = _npanels
          npoints[ci] = _npoints
          panel_ids[ci] = model.caeros[ci]._init_ids()
          _points, _cells = model.caeros[ci].panel_points_elements()
          points[ci] = _points
          cells[ci] = _cells
      return Grid(caeros, labels, npanels, npoints, panel_ids, points, cells)

  # cells = np.hstack([4*np.ones(len(_cells),dtype=int).reshape(len(_cells),1),_cells])
  # mesh = pyvista.PolyData(_points, cells)
  # mesh.save(file_path / f"{components[i]}.ply",
  #         binary=False)
  grid = build_grid(dlm_panels.model)
#+end_src

#+begin_src python :session py1 :results none :tangle py1.py
  import feniax.plotools.grid
  from pyNastran.bdf.bdf import BDF
  import pandas as pd
  import importlib
  importlib.reload(feniax.plotools.grid)
  aerogrid = feniax.plotools.grid.AeroGrid.build_DLMgrid(dlm_panels.model)
  df_grid = pd.read_csv('../FEM/structuralGrid', comment="#", sep=" ",
                      names=['x1', 'x2', 'x3', 'fe_order', 'component'])
  model = BDF(debug=True)
  model.read_bdf("./SOL103/run_cao.bdf", punch=False)
  X = df_grid[['x1','x2','x3']].to_numpy()
  panelmodel = feniax.plotools.grid.ASETModel(aerogrid, set1x, X, model)
  #collocationmodel = feniax.plotools.grid.ASETModel(aerogrid_collocation, set1x, X, model)
#+end_src

#+begin_src python :session py1 :results none :tangle py1.py
  aerogrid_collocation = feniax.plotools.grid.AeroGrid.build_DLMcollocation(dlm_panels.model)
  #collocationmodel = feniax.plotools.grid.ASETModel(aerogrid_collocation, set1x, X, model)
  collocation_points = np.vstack([aerogrid_collocation.points[i] for i in aerogrid_collocation.points.keys()])
  np.save("./data_out/collocation_points.npy", collocation_points)
#+end_src

#+begin_src python :session py1 :results none
  import pandas as pd
  from pyNastran.bdf.bdf import BDF
  df_grid = pd.read_csv('../FEM/structuralGrid', comment="#", sep=" ",
                      names=['x1', 'x2', 'x3', 'fe_order', 'component'])

  model = BDF(debug=True)
  #np.array([model.nodes[i].get_position() for i in set1x[0]])
  model.read_bdf("./SOL103/run_cao.bdf", punch=False)
  #panel_ids = dlm_panels.model.caeros[10000000]._init_ids()
  def point2aset(model, points, asets):

      aset_map = {ai: [] for ai in asets}
      asets_vect = np.array([model.nodes[i].get_position() for i in asets])
      pa = list()
      for i, pi in enumerate(points):
          cos_a = list()
          for j, vj in enumerate(asets_vect):
              if j < len(asets_vect)-1:
                  axis = asets_vect[j+1] - vj
              else:
                  axis = asets_vect[j-1] - vj
              #pa_i = pi - vj
              #cos_a.append(abs(pa_i[1]))
              normal2arm = np.linalg.norm([0, pi[1]-vj[1], pi[2]-vj[2]])
              cos_a.append(normal2arm)
          index = cos_a.index(min(cos_a))
          aset_map[asets[index]].append(i)
          pa.append(pi - asets_vect[index])
      return aset_map, asets_vect, np.array(pa)

  def point2aset2(model, points, asets):

      aset_map = {ai: [] for ai in asets}
      asets_vect = np.array([model.nodes[i].get_position() for i in asets])
      pa = list()
      for i, pi in enumerate(points):
          cos_a = list()
          for j, vj in enumerate(asets_vect):
              if j < len(asets_vect)-1:
                  axis = asets_vect[j+1] - vj
              else:
                  axis = asets_vect[j-1] - vj
              pa_i = pi - vj
              pa_i /= np.linalg.norm(pa_i)
              axis /= np.linalg.norm(axis) 
              cos_a.append(abs(pa_i.dot(axis)))
          index = cos_a.index(min(cos_a))
          aset_map[asets[index]].append(i)
          pa.append(pi - asets_vect[index])
      return aset_map, asets_vect, np.array(pa)

  def aset2id_intrinsic(X, asets, asets_vect, tolerance=1e-6):

      intrinsic_map = dict()
      for i, vi in enumerate(asets_vect):
          norm_ = np.linalg.norm(vi.reshape((1,3)) - X, axis=1)
          min_ = np.min(norm_)
          if min_ < tolerance:
              index = np.where(norm_ == min_)[0][0]
              intrinsic_map[asets[i]] = index
          else:
              intrinsic_map[asets[i]] = None
      return intrinsic_map

  aset_map, asets_vect, pa = point2aset(model,
                                        grid.get('points', '$vstabilizer'),
                                        asets=set1x[-1])
  intrinsic_map = aset2id_intrinsic(X=df_grid[['x1','x2','x3']].to_numpy(),
                                    asets=set1x[0],
                                    asets_vect=asets_vect,
                                    tolerance=1e-3)
  def build_pa_tensor():
      ...
#+end_src

#+begin_src python :session py1 :results none :tangle py1.py
  from feniax.preprocessor import solution
  ireader = solution.IntrinsicReader("../results_2023-11-13_11:25:09/")

  #sol_path = "/home/ac5015/programs/FENIAX.examples/SailPlane/results_2023-10-25_14:30:25"
  # sol = solution.IntrinsicSolution(sol_path)
  # sol.load_container("Modes")
  # sol.load_container("Couplings")
  # sol.load_container("StaticSystem", label="_s1")
  panelmodel.set_solution(ireader.data.staticsystem_s1.ra[0],
                          ireader.data.staticsystem_s1.Cab[0],
                          ireader.data.modes.C0ab)
  panelmodel.mesh_plot(folder_path="./static400/data_m1", data_name= "data_m1")
  panelmodel.mesh_plot(folder_path="./static400/data_mx", data_name= "data_mx")

#+end_src

#+begin_src python :session py1 :results none :tangle py1.py
  import feniax.plotools.interpolation as interpolation
  import feniax.plotools.nastranvtk.bdfdef as bdfdef
  importlib.reload(bdfdef)
  bdf = bdfdef.DefBdf("./SOL103/run_cao.bdf")
  bdf.plot_vtk("./paraview/results/ref.bdf")
  nodesX = bdf.get_nodes()
  disp, coord = interpolation.compute(panelmodel.datam1_merged,
                                      panelmodel.data_mx_merged,
                                      nodesX)
  bdf.update_bdf(coord, bdf.mbdf.node_ids)
  bdf.plot_vtk("./static400/defL0.bdf")
#+end_src

#+begin_src python :session py1 :results none :tangle py1.py
  importlib.reload(feniax.plotools.grid)
  bdf_interpol = feniax.plotools.grid.PanelsBDFInterpol("./dlm_model.yaml",
                                                          "./SOL103/run_cao.bdf",
                                                          X,
                                                          "../results_2023-11-13_11:25:09/"
                                                          )
  bdf_interpol.vtk("./static400/vtknew/",
                   "model",
                   range(6)
                   )
#+end_src

* GAFs extraction

#+begin_src python :session py1 :results none
  dlm_gafs = nasaero.GenFlutter(flutter_id,
                                density_fact,
                                mach_fact,
                                kv_fact,
                                machs,
                                reduced_freqs,
                                u_inf,
                                c_ref,
                                rho_ref,
                                flutter_method,
                                flutter_sett,
                                aero_sett)

  dlm_gafs.build_model()
  dlm_gafs.model.write_bdf("./GAFs/aero_flutter.bdf")

#+end_src

#+begin_src org :tangle "./GAFs/run_cao.bdf" :mkdirp yes :noweb yes
  $EXECUTIVE CONTROL DECK
  assign OUTPUT4='../data_out/Qhh<<python_parameters(output="Mach")>>-<<python_parameters(output="num_modes")>>.op4',formatted,UNIT=11
  assign OUTPUT4='../data_out/Qhj<<python_parameters(output="Mach")>>-<<python_parameters(output="num_modes")>>.op4',formatted,UNIT=12
  assign INPUTT4='../data_out/Phi<<python_parameters(output="num_modes")>>.op4',formatted,UNIT=90
  $assign INPUTT4= 'Phi1.op4',formatted,UNIT=91
  $NASTRAN NLINES=999999
  NASTRAN QUARTICDLM=1
  SOL 145
  $TIME 10000
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $   K : AERODYNAMIC DOF = 2 * N AERO BOX
  $   A : STRUCTURAL DOF  = 6 * N GRID
  $   J : N AERO BOX
  $   H : N MODES012
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ Retrieve the Spline Matrices form AERO0 and store them in DBALL
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  COMPILE AERO0
  ALTER 'CALL.*PLINOUT.*AECASE.*AEBGPDTS.*AEUSETS.*GPGK0.*GDGK0'
  EQUIVX GPGK0/SPL_F_AK/ALWAYS
  EQUIVX GDGK0/SPL_D_AK/ALWAYS $
  CALL DBSTORE SPL_F_AK,,,,//111/112/'DBALL'/0 $
  CALL DBSTORE SPL_D_AK,,,,//113/114/'DBALL'/0 $
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ Retrieve the Matrices AJJ D12JK SKJ form PFAERO and store them in DBALL
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  COMPILE PFAERO
  ALTER 'AMG.*MKLIST,ACPT/'
  TYPE PARM,,I,N,EXIST $
  TYPE PARM,,CS,N,CK $
  CALL DBFETCH /SPL_F_AK,,,,/111/112/0/0/S,EXIST $
  CALL DBFETCH /SPL_D_AK,,,,/113/114/0/0/S,EXIST $
  EQUIVX AJJT/A_JJT/ALWAYS $
  EQUIVX SKJ/S_KJ/ALWAYS $
  EQUIVX D1JK/D1_KJ/ALWAYS $
  EQUIVX D2JK/D2_KJ/ALWAYS $
  IF ( YESWKK ) THEN $
      EQUIVX WKK/W_KK/ALWAYS $
      MPYAD W_KK,S_KJ,/WS_KJ $
      EQUIVX WS_KJ/S_KJ/ALWAYS $
  ENDIF $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $
  $    EVALUATE THE QAA_ MATRIX:
  $
  $    Q_HH=Phi_HA*SPL_F_AK*S_KJ*INV(A_JJ)*D_JK*SPL_D_KA*Phi_AH
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  INPUTT4 /Phi_AH,,,,/1/90 $
  $INPUTT4 /Phi_AH1,,,,/1/91 $
  TRNSP Phi_AH/Phi_HA $
  $TRNSP Phi_AH1/Phi_HA $
  TRNSP A_JJT/A_JJ $
  TRNSP SPL_D_AK/SPL_D_KA $
  DECOMP A_JJ/L_AJJ,U_AJJ,, $
  CK = CMPLX(0.,KBAR) $
  ADD5 D1_KJ,D2_KJ,,,/D_KJ//CK $
  TRNSP D_KJ/D_JK $
  MPYAD D_JK,SPL_D_KA,/D_JA $
  FBS L_AJJ,U_AJJ,D_JA/Q_JA $
  MPYAD S_KJ,Q_JA,/Q_KA $
  MPYAD SPL_F_AK,Q_KA,/Q_AA $
  MPYAD Phi_HA,Q_AA,/Q_HA $
  MPYAD Q_HA,Phi_AH,/Q_HH $
  OUTPUT4 Q_HH,,,,//0/11///9 $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $
  $    EVALUATE THE QHJ_ MATRIX:
  $
  $    Q_HJ=Phi_HA*SPL_F_AK*S_KJ*INV(A_JJ)*D_JK*SPL_D_KA
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  PARAML A_JJ//'TRAILER'/1/S,N,COL $
  MATGEN ,/ID/1/COL $
  FBS L_AJJ,U_AJJ,ID/INVAJJ $
  MPYAD S_KJ,INVAJJ,/Q_KJ $
  MPYAD SPL_F_AK,Q_KJ,/Q_AJ $
  MPYAD Phi_HA,Q_AJ,/Q_HJ $
  OUTPUT4 Q_HJ,,,,//0/12///9 $
  CEND

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ CASE CONTROL									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  TITLE=Sailplane #                                 
  $SPC=  100001                                                            
  $MPC=  100001
  SPC = 2                  
  METHOD = 100
  FMETHOD = <<python_parameters(output="flutter_id")>>
  $
  DISP(PLOT) = ALL
  $
  RESVEC = YES
  MODESELECT (STRUCTURE, LMODES = 20)
  $ MODESELECT (STRUCTURE,LFREQ=0.001,HFREQ=15.0) 
  $ MODESELECT (FLUID,LFREQ=0.001,HFREQ=15.0)
  ECHO=NONE

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ BULK   									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  BEGIN BULK
  PARAM,BAILOUT,0
  PARAM,GRDPNT,0                                                              
  PARAM,K6ROT,1.0
  PARAM,SNORM,20.0
  PARAM,POST,0
  $PARAM,MAXRATIO,1.0E07 $Default anyway
  $PARAM   AUTOSPC YES
  MDLPRM  MLTSPLIN 1 $Aero grids can be defined in multiple splines (dafault 0)
  PARAM   WTMASS  1.0  
  PARAM   OPPHIB  1
  PARAM   OPPHIPA 1

  EIGRL,100,,,<<python_parameters(output="num_modes")>>
  SPC1           1  123456  999079
  SPCADD         2       1
  INCLUDE ../base.bdf
  INCLUDE ../dlm_model.bdf
  INCLUDE ./aero_flutter.bdf

#+end_src

#+begin_src bash :tangle "./GAFs/run.sh" :mkdirp yes :shebang   #!/usr/bin/zsh -i :results none
  cd GAFs
  nastran run_cao.bdf
#+end_src

#+begin_src python :session py1  :results none :noweb yes
  import pyNastran.op4.op4 as op4
  from scipy.io import savemat

  Qhh = op4.read_op4(f"./data_out/Qhh{Mach}-{num_modes}.op4")
  # savemat(f"./GAFs/matlab_Qhh{Mach}-{num_modes}.mat", dict(Qhh=Qhh['Q_HH'][1],
  #                                                          reduced_freqs=reduced_freqs))

#+end_src
** Roger RFA
perform RFA 
#+begin_src python :session py1  :results none
  import sys
  #sys.path.append("/media/acea/work/projects/FENIAX.")
  import numpy as np
  import pdb
  import argparse
  import os
  from intrinsic.functions import my_timer
  import Utils.FEM_Readers
  import Aerodynamics.rfa as rfa
  import Aerodynamics.opt_poles as opt_poles
  import Aerodynamics.rfa_plot as rfa_plot

  #Input_file= args.config_file     #'/Configuration_File.txt'
  mkaero_file="./GAFs/aero_flutter.bdf"
  reduced_freq=reduced_freqs
  #Utils.FEM_Readers.read_mkaero_file(mkaero_file)
  RFA_Method='r'
  #RFA_Method='e'
  Gaf_file=f"./data_out/Qhh{Mach}-{num_modes}.op4"
  Gaf_filej=f"./data_out/Qhj{Mach}-{num_modes}.op4"
  aero_matrices_real,aero_matrices_imag,aero_matrices=Utils.FEM_Readers.read_complex_nastran_matrices2(Gaf_file)
  aero_matrices_realj,aero_matrices_imagj,aero_matricesj=Utils.FEM_Readers.read_complex_nastran_matrices2(Gaf_filej)
  NumModes=np.shape(aero_matrices_real)[1]
  NumPoles=num_poles
  rfa0 = 1.
  kstep = 0.1
  err_type = 'quadratic'
  kmax = reduced_freq[-1]
  save_AICs = f'data_out/Qhh{Mach}-{num_modes}r{num_poles}.npy'
  save_Poles = f'data_out/Poles{Mach}-{num_modes}r{num_poles}.npy'
  save_AICsj = f'data_out/Qhj{Mach}-{num_modes}r{num_poles}.npy'
  opt_brute = True
  opt_least = True
  sol_step = 0.1
  Matrix_type="qhh"
  poles0=np.zeros((NumPoles))
  if NumPoles>=0:
      for i in range(NumPoles):
        poles0[i]=kmax/(i+1)

  poles = poles0
  #rfa0=1
  #opt_least = 0
  if opt_brute:
    err_brute,poles_brute = opt_poles.min_brute(reduced_freq,RFA_Method,aero_matrices_real,aero_matrices_imag,kmax,kstep,NumPoles,err_type,sol_step,rfa0)
    poles = poles_brute
  if opt_least:
    if opt_brute:
      err_least,poles_least = opt_poles.min_least_squares(poles_brute,reduced_freq,RFA_Method,aero_matrices_real,aero_matrices_imag,err_type,sol_step,rfa0)
    else:
      err_least,poles_least = opt_poles.min_least_squares(poles0,reduced_freq,RFA_Method,aero_matrices_real,aero_matrices_imag,err_type,sol_step,rfa0)
      poles = poles_least
      #k_matrix,k_matrix2,RFA_mat,RFA_mat2,err,err2 = opt.poles.y_poles(poles_brute,reduced_freq,RFA_Method,aero_matrices_real,aero_matrices_imag,err_type)

  k_matrix,RFA_mat,err = opt_poles.y_poles(poles,reduced_freq,RFA_Method,aero_matrices_real,aero_matrices_imag,aero_matrices,err_type,sol_step,rfa0)
  #k_matrix,k_matrix2,RFA_mat,RFA_mat2,err,err2 = opt_poles.y_poles2(poles,reduced_freq,RFA_Method,aero_matrices_real,aero_matrices_imag,aero_matrices,err_type,sol_step,rfa0)

  if save_AICs:
    np.save(save_AICs,np.array(RFA_mat))
  if save_Poles:
    np.save(save_Poles,poles)

  k_matrixj,RFA_matj,errj = opt_poles.y_poles(poles,reduced_freq,RFA_Method,aero_matrices_realj,aero_matrices_imagj,aero_matricesj,err_type,sol_step,rfa0)
  if save_AICsj:
    np.save(save_AICsj,np.array(RFA_matj))

#+end_src

plot GAFs

#+begin_src python :session py1  :results none
  plot_points = np.asarray([[0,0],[0,1],[0,2],
                            [1,0],[1,1],[1,2],
                            [19,0],[19,1],[19,2]])
  rfa_plot.plot1(reduced_freq,plot_points,poles,RFA_mat,RFA_Method,aero_matrices_real,aero_matrices_imag)
  rfa_plot.plot1(reduced_freq,plot_points,poles,RFA_matj,RFA_Method,aero_matrices_realj,aero_matrices_imagj)
#+end_src

* Qalpha GAFs extraction

#+begin_src org :tangle "./GAFs_Qx/setupQx.bdf" :mkdirp yes :noweb yes
  $
  $--------------------------------------------------------------------------------
  $   AERODYNAMIC DOFS
  $--------------------------------------------------------------------------------
  $
  AESTAT  1       ANGLEA  
  AESTAT  2       SIDES  
  AESTAT  3       PITCH  
  AESTAT  4       ROLL  
  AESTAT  5       YAW  
  AESTAT  6       URDD1  
  AESTAT  7       URDD2  
  AESTAT  8       URDD3  
  AESTAT  9       URDD4  
  AESTAT  10      URDD5  
  AESTAT  11      URDD6  

  $AEROS                   4.163   44.8    146.6  
  AEROS,,,<<python_parameters(output="c_ref")>>,<<python_parameters(output="b_ref")>>,<<python_parameters(output="S_ref")>>,,1
  $
  $--------------------------------------------------------------------------------
  $   BOUNDARY CONDITIONS
  $--------------------------------------------------------------------------------
  $ SPCs
  $
  $--------------------------------------------------------------------------------
  $   h=0 ft - m=0.3
  $--------------------------------------------------------------------------------
  $
  $ TRIM    960     0.81    15762.81  URDD1   0.      URDD2   0.      1.
  $         URDD3   0.      URDD4   0.      URDD5   0.      URDD6   0.
  $         ROLL    0.      YAW     0.      SIDES   0.      PITCH   0.
  $         Flprn_r 0.      WTAil_r 0.      Elev_r  0.      ANGLEA  0.261799
  TRIM,960,<<python_parameters(output="mach")>>,<<python_parameters(output="q_inf")>>,URDD1,0.,URDD2,0.,1.
  ,URDD3,   0.,      URDD4,   0.,      URDD5,   0.,      URDD6,   0.,
  ,ROLL,    0.,      YAW,     0.,      SIDES,   0.,      PITCH,   0.
  $ANGLEA  0.261799

#+end_src

#+begin_src org :tangle "./GAFs_Qx/run_cao.bdf" :mkdirp yes :noweb yes
  assign OUTPUT4='../data_out/Qax<<python_parameters(output="num_modes")>>-<<python_parameters(output="mach")>>.op4',formatted,UNIT=11
  assign OUTPUT4='../data_out/Qah<<python_parameters(output="num_modes")>>-<<python_parameters(output="mach")>>.op4',formatted,UNIT=12
  assign OUTPUT4='../data_out/Qhx<<python_parameters(output="num_modes")>>-<<python_parameters(output="mach")>>.op4',formatted,UNIT=13
  assign INPUTT4='../data_out/Phi<<python_parameters(output="num_modes")>>.op4',formatted,UNIT=90
  $ NASTRAN NLINES=999999
  NASTRAN QUARTICDLM=1
  SOL 144
  TIME 10000
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $
  $       * * *   DMAP code by ANDREA CASTRICHINI  * * *
  $                andrea.castrichini@gmail.com
  $   K : AERODYNAMIC DOF = 2 * N AERO BOX
  $   A : STRUCTURAL DOF  = 6 * N GRID
  $   J : N AERO BOX 
  $   H : N MODES 
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ Retrieve the Spline Matrices form AERO0 and store them in DBALL
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  COMPILE AERO0
  ALTER 'CALL.*PLINOUT.*AECASE.*AEBGPDTS.*AEUSETS.*GPGK0.*GDGK0'                                                       
  EQUIVX GPGK0/SPL_F_AK/ALWAYS 
  EQUIVX GDGK0/SPL_D_AK/ALWAYS $                              
  CALL DBSTORE SPL_F_AK,,,,//111/112/'DBALL'/0 $        
  CALL DBSTORE SPL_D_AK,,,,//113/114/'DBALL'/0 $                 
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ Retrieve the Matrices AJJ DJX SKJ form PFAERO and store them in DBALL
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  COMPILE PFAERO
  ALTER 'ADG.*CONTROL.*CSTMA.*AERO.*AECOMP.*W2GJ.*ACPT' 
  EQUIVX WJVBRL/D_JX/ALWAYS $                                 
  CALL DBSTORE D_JX,,,,//121/122/'DBALL'/0 $    
  ALTER 'AMG.*ACPT/'                                                                                             
  EQUIVX SKJ/S_KJ/ALWAYS $                                                       
  EQUIVX SKJ/S_KJnc/ALWAYS $                                                       
  IF ( YESWKK ) THEN $   
      EQUIVX WKK/W_KK/ALWAYS $                                           
      MPYAD W_KK,S_KJ,/WS_KJ $ 
      EQUIVX WS_KJ/S_KJ/ALWAYS $                             
  ENDIF $                     
  CALL DBSTORE S_KJ,,,,//117/118/'DBALL'/0 $    
  IF ( NOFA2J < 0 ) THEN
      MPYAD S_KJnc,FA2J,/FA2J_K $ 
     IF (NOFA2DMI) THEN
     ELSE
         PARAML  S_KJnc//'TRAILER'/2/S,N,ROW
         MATGEN ,/FA2J_K/7/ROW/1 
     ENDIF
  ENDIF
  CALL DBSTORE FA2J_K,,,,//119/120/'DBALL'/0 $  
  $   
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ Retrieve the stored Matrices and evaluate:
  $ Q_AX=SPL_F_AK*S_KJ*INV(A_JJ)*D_JX
  $ Q_AA=SPL_F_AK*S_KJ*INV(A_JJ)*D_JK*SPL_D_KA
  $ S_KJ=Area Matrix, D_JK=Derivative Matrix, A_JJ=AIC Matrix     
  $ WKK=Correction Matrix not defined
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $
  COMPILE AESTATRS $                                         
  ALTER 'AEKX.*DGAK.*WSKJ.*LAJJ.*UAJJ.*D1JK.*AEQGDKL.*URLR.*PURLR' 
  TYPE PARM,,I,N,EXIST $                           
  CALL DBFETCH /SPL_F_AK,,,,/111/112/0/0/S,EXIST $       
  CALL DBFETCH /SPL_D_AK,,,,/113/114/0/0/S,EXIST $       
  CALL DBFETCH /S_KJ,,,,/117/118/0/0/S,EXIST $    
  CALL DBFETCH /FA2J_K,,,,/119/120/0/0/S,EXIST $    
  CALL DBFETCH /D_JX,,,,/121/122/0/0/S,EXIST $         
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    
  $
  $    EVALUATE THE QAA_ MATRIX:
  $
  $    Q_AX=SPL_F_AK*S_KJ*INV(A_JJ)*D_JX
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 
  FBS LAJJ,UAJJ,D_JX/Q_JX $    
  MPYAD S_KJ,Q_JX,/Q_KX $                                         
  MPYAD SPL_F_AK,Q_KX,/Q_AX $   
  OUTPUT4 Q_AX,,,,//0/11///8 $ 

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    
  $
  $    EVALUATE THE QAA_ MATRIX:
  $
  $    Q_AH=SPL_F_AK*S_KJ*INV(A_JJ)*D_JK*SPL_D_KA*Phi_AH
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  INPUTT4 /Phi_AH,,,,/1/90 $
  TRNSP Phi_AH/Phi_HA $  
  TRNSP D1JK/D_JK $                                                                                     
  TRNSP SPL_D_AK/SPL_D_KA $                                                                                      
  MPYAD D_JK,SPL_D_KA,/D_JA $                                                  
  FBS LAJJ,UAJJ,D_JA/Q_JA $                                              
  MPYAD S_KJ,Q_JA,/Q_KA $                                         
  MPYAD SPL_F_AK,Q_KA,/Q_AA $ 
  MPYAD Q_AA,Phi_AH,/Q_AH $                                                                                 
  OUTPUT4 Q_AH,,,,//0/12///8 $   

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    
  $
  $    EVALUATE THE QAA_ MATRIX:
  $
  $    Q_HX=Phi_HA*SPL_F_AK*S_KJ*INV(A_JJ)*D_JX
  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 
  $FBS LAJJ,UAJJ,D_JX/Q_JX $    
  $MPYAD S_KJ,Q_JX,/Q_KX $                                         
  $MPYAD SPL_F_AK,Q_KX,/Q_AX $   
  MPYAD Phi_HA,Q_AX,/Q_HX $                                                                                 
  OUTPUT4 Q_HX,,,,//0/13///8 $ 

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  CEND

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ CASE CONTROL									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  TITLE=Sailplane #                                 
  $SPC=  100001                                                            
  $MPC=  100001
  SPC = 2                  
  $
  $
  TRIM = 960
  $LOAD = 2000
  $
  DISP = ALL
  FORCE = ALL
  AEROF = ALL
  MONITOR = ALL
  TRIMF = ALL
  OLOAD(CID) = ALL
  ECHO=NONE

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ BULK   									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  BEGIN BULK
  PARAM,BAILOUT,0
  PARAM,GRDPNT,0                                                              
  PARAM,K6ROT,1.0
  PARAM,SNORM,20.0
  PARAM,POST,0
  $PARAM,MAXRATIO,1.0E07 $Default anyway
  $PARAM   AUTOSPC YES
  MDLPRM  MLTSPLIN 1 $Aero grids can be defined in multiple splines (dafault 0)
  PARAM   WTMASS  1.0  
  PARAM   AUNITS  .1019716  $ 1/g  

  SPC1           1  123456  999079
  SPCADD         2       1
  $SUPORT,999079,5
  INCLUDE ../base.bdf
  INCLUDE ../dlm_model.bdf
  INCLUDE './setupQx.bdf'

#+end_src

#+begin_src bash :tangle "./GAFs_Qx/run.sh" :mkdirp yes :shebang  #!/usr/bin/zsh -i :results none
  cd ./GAFs_Qx
  nastran run_cao.bdf
#+end_src

#+begin_src python :session py1  :results none :noweb yes
  import pyNastran.op4.op4 as op4
  Qalpha = op4.read_op4(f"./data_out/Qhx{num_modes}-{mach}.op4")
  np.save(f"./data_out/Qhx{num_modes}-{mach}.op4", Qalpha['Q_HX'][1][:, 1:])
#+end_src

* DLM dihedral extraction
#+begin_src org :tangle "./geometry/dummy_gust.bdf" :mkdirp yes :noweb yes
  TLOAD1  100     99999999                1       
  DLOAD   1       1.      1.      100     
  GUST    10      1       0.01469 0.      68.06   
  TABLED1 1       
          0.0     0.0     0.01    0.12878 0.02    0.50804 0.03    1.11695 
          0.04    1.92203 0.05    2.87905 0.06    3.93542 0.07    5.03308 
          0.08    6.11171 0.09    7.11204 0.1     7.97909 0.11    8.66521 
          0.12    9.13270 0.13    9.35588 0.14    9.32247 0.15    9.03431 
          0.16    8.50723 0.17    7.77021 0.18    6.86374 0.19    5.83764 
          0.2     4.74830 0.21    3.65557 0.22    2.61952 0.23    1.69708 
          0.24    0.93893 0.25    0.38675 0.26    0.07087 0.27    0.0     
          0.28    0.0     0.29    0.0     0.3     0.0     0.31    0.0     
          0.32    0.0     0.33    0.0     0.34    0.0     0.35    0.0     
          0.36    0.0     0.37    0.0     0.38    0.0     0.39    0.0     
          0.4     0.0     0.41    0.0     0.42    0.0     0.43    0.0     
          0.44    0.0     0.45    0.0     0.46    0.0     0.47    0.0     
          0.48    0.0     0.49    0.0     0.5     0.0     0.51    0.0     
          0.52    0.0     0.53    0.0     0.54    0.0     0.55    0.0     
          0.56    0.0     0.57    0.0     0.58    0.0     0.59    0.0     
          0.6     0.0     0.61    0.0     0.62    0.0     0.63    0.0     
          0.64    0.0     0.65    0.0     0.66    0.0     0.67    0.0     
          0.68    0.0     0.69    0.0     0.7     0.0     0.71    0.0     
          0.72    0.0     0.73    0.0     0.74    0.0     0.75    0.0     
          0.76    0.0     0.77    0.0     0.78    0.0     0.79    0.0     
          0.8     0.0     0.81    0.0     0.82    0.0     0.83    0.0     
          0.84    0.0     0.85    0.0     0.86    0.0     0.87    0.0     
          0.88    0.0     0.89    0.0     0.9     0.0     0.91    0.0     
          0.92    0.0     0.93    0.0     0.94    0.0     0.95    0.0     
          0.96    0.0     0.97    0.0     0.98    0.0     0.99    0.0     
          1.0     0.0     1.01    0.0     1.02    0.0     1.03    0.0     
          1.04    0.0     1.05    0.0     1.06    0.0     1.07    0.0     
          1.08    0.0     1.09    0.0     1.1     0.0     1.11    0.0     
          1.12    0.0     1.13    0.0     1.14    0.0     1.15    0.0     
          1.16    0.0     1.17    0.0     1.18    0.0     1.19    0.0     
          1.2     0.0     1.21    0.0     1.22    0.0     1.23    0.0     
          1.24    0.0     1.25    0.0     1.26    0.0     1.27    0.0     
          1.28    0.0     1.29    0.0     1.3     0.0     1.31    0.0     
          1.32    0.0     1.33    0.0     1.34    0.0     1.35    0.0     
          1.36    0.0     1.37    0.0     1.38    0.0     1.39    0.0     
          1.4     0.0     1.41    0.0     1.42    0.0     1.43    0.0     
          1.44    0.0     1.45    0.0     1.46    0.0     1.47    0.0     
          1.48    0.0     1.49    0.0     1.5     0.0     1.51    0.0     
          1.52    0.0     1.53    0.0     1.54    0.0     1.55    0.0     
          1.56    0.0     1.57    0.0     1.58    0.0     1.59    0.0     
          1.6     0.0     1.61    0.0     1.62    0.0     1.63    0.0     
          1.64    0.0     1.65    0.0     1.66    0.0     1.67    0.0     
          1.68    0.0     1.69    0.0     1.7     0.0     1.71    0.0     
          1.72    0.0     1.73    0.0     1.74    0.0     1.75    0.0     
          1.76    0.0     1.77    0.0     1.78    0.0     1.79    0.0     
          1.8     0.0     1.81    0.0     1.82    0.0     1.83    0.0     
          1.84    0.0     1.85    0.0     1.86    0.0     1.87    0.0     
          1.88    0.0     1.89    0.0     1.9     0.0     1.91    0.0     
          1.92    0.0     1.93    0.0     1.94    0.0     1.95    0.0     
          1.96    0.0     1.97    0.0     1.98    0.0     1.99    0.0     
          2.0     0.0     2.01    0.0     2.02    0.0     2.03    0.0     
          2.04    0.0     2.05    0.0     2.06    0.0     2.07    0.0     
          2.08    0.0     2.09    0.0     2.1     0.0     2.11    0.0     
          2.12    0.0     2.13    0.0     2.14    0.0     2.15    0.0     
          2.16    0.0     2.17    0.0     2.18    0.0     2.19    0.0     
          2.2     0.0     2.21    0.0     2.22    0.0     2.23    0.0     
          2.24    0.0     2.25    0.0     2.26    0.0     2.27    0.0     
          2.28    0.0     2.29    0.0     2.3     0.0     2.31    0.0     
          2.32    0.0     2.33    0.0     2.34    0.0     2.35    0.0     
          2.36    0.0     2.37    0.0     2.38    0.0     2.39    0.0     
          2.4     0.0     2.41    0.0     2.42    0.0     2.43    0.0     
          2.44    0.0     2.45    0.0     2.46    0.0     2.47    0.0     
          2.48    0.0     2.49    0.0     2.5     0.0     2.51    0.0     
          2.52    0.0     2.53    0.0     2.54    0.0     2.55    0.0     
          2.56    0.0     2.57    0.0     2.58    0.0     2.59    0.0     
          2.6     0.0     2.61    0.0     2.62    0.0     2.63    0.0     
          2.64    0.0     2.65    0.0     2.66    0.0     2.67    0.0     
          2.68    0.0     2.69    0.0     2.7     0.0     2.71    0.0     
          2.72    0.0     2.73    0.0     2.74    0.0     2.75    0.0     
          2.76    0.0     2.77    0.0     2.78    0.0     2.79    0.0     
          2.8     0.0     2.81    0.0     2.82    0.0     2.83    0.0     
          2.84    0.0     2.85    0.0     2.86    0.0     2.87    0.0     
          2.88    0.0     2.89    0.0     2.9     0.0     2.91    0.0     
          2.92    0.0     2.93    0.0     2.94    0.0     2.95    0.0     
          2.96    0.0     2.97    0.0     2.98    0.0     2.99    0.0     
          3.0     0.0     3.01    0.0     3.02    0.0     3.03    0.0     
          3.04    0.0     3.05    0.0     3.06    0.0     3.07    0.0     
          3.08    0.0     3.09    0.0     3.1     0.0     3.11    0.0     
          3.12    0.0     3.13    0.0     3.14    0.0     3.15    0.0     
          3.16    0.0     3.17    0.0     3.18    0.0     3.19    0.0     
          3.2     0.0     3.21    0.0     3.22    0.0     3.23    0.0     
          3.24    0.0     3.25    0.0     3.26    0.0     3.27    0.0     
          3.28    0.0     3.29    0.0     3.3     0.0     3.31    0.0     
          3.32    0.0     3.33    0.0     3.34    0.0     3.35    0.0     
          3.36    0.0     3.37    0.0     3.38    0.0     3.39    0.0     
          3.4     0.0     3.41    0.0     3.42    0.0     3.43    0.0     
          3.44    0.0     3.45    0.0     3.46    0.0     3.47    0.0     
          3.48    0.0     3.49    0.0     3.5     0.0     3.51    0.0     
          3.52    0.0     3.53    0.0     3.54    0.0     3.55    0.0     
          3.56    0.0     3.57    0.0     3.58    0.0     3.59    0.0     
          3.6     0.0     3.61    0.0     3.62    0.0     3.63    0.0     
          3.64    0.0     3.65    0.0     3.66    0.0     3.67    0.0     
          3.68    0.0     3.69    0.0     3.7     0.0     3.71    0.0     
          3.72    0.0     3.73    0.0     3.74    0.0     3.75    0.0     
          3.76    0.0     3.77    0.0     3.78    0.0     3.79    0.0     
          3.8     0.0     3.81    0.0     3.82    0.0     3.83    0.0     
          3.84    0.0     3.85    0.0     3.86    0.0     3.87    0.0     
          3.88    0.0     3.89    0.0     3.9     0.0     3.91    0.0     
          3.92    0.0     3.93    0.0     3.94    0.0     3.95    0.0     
          3.96    0.0     3.97    0.0     3.98    0.0     3.99    0.0     
          4.0     0.0     4.01    0.0     4.02    0.0     4.03    0.0     
          4.04    0.0     4.05    0.0     4.06    0.0     4.07    0.0     
          4.08    0.0     4.09    0.0     4.1     0.0     4.11    0.0     
          4.12    0.0     4.13    0.0     4.14    0.0     4.15    0.0     
          4.16    0.0     4.17    0.0     4.18    0.0     4.19    0.0     
          4.2     0.0     4.21    0.0     4.22    0.0     4.23    0.0     
          4.24    0.0     4.25    0.0     4.26    0.0     4.27    0.0     
          4.28    0.0     4.29    0.0     4.3     0.0     4.31    0.0     
          4.32    0.0     4.33    0.0     4.34    0.0     4.35    0.0     
          4.36    0.0     4.37    0.0     4.38    0.0     4.39    0.0     
          4.4     0.0     4.41    0.0     4.42    0.0     4.43    0.0     
          4.44    0.0     4.45    0.0     4.46    0.0     4.47    0.0     
          4.48    0.0     4.49    0.0     4.5     0.0     4.51    0.0     
          4.52    0.0     4.53    0.0     4.54    0.0     4.55    0.0     
          4.56    0.0     4.57    0.0     4.58    0.0     4.59    0.0     
          4.6     0.0     4.61    0.0     4.62    0.0     4.63    0.0     
          4.64    0.0     4.65    0.0     4.66    0.0     4.67    0.0     
          4.68    0.0     4.69    0.0     4.7     0.0     4.71    0.0     
          4.72    0.0     4.73    0.0     4.74    0.0     4.75    0.0     
          4.76    0.0     4.77    0.0     4.78    0.0     4.79    0.0     
          4.8     0.0     4.81    0.0     4.82    0.0     4.83    0.0     
          4.84    0.0     4.85    0.0     4.86    0.0     4.87    0.0     
          4.88    0.0     4.89    0.0     4.9     0.0     4.91    0.0     
          4.92    0.0     4.93    0.0     4.94    0.0     4.95    0.0     
          4.96    0.0     4.97    0.0     4.98    0.0     4.99    0.0     
          5.0     0.0     5.01    0.0     5.02    0.0     5.03    0.0     
          5.04    0.0     5.05    0.0     5.06    0.0     5.07    0.0     
          5.08    0.0     5.09    0.0     5.1     0.0     5.11    0.0     
          5.12    0.0     5.13    0.0     5.14    0.0     5.15    0.0     
          5.16    0.0     5.17    0.0     5.18    0.0     5.19    0.0     
          5.2     0.0     5.21    0.0     5.22    0.0     5.23    0.0     
          5.24    0.0     5.25    0.0     5.26    0.0     5.27    0.0     
          5.28    0.0     5.29    0.0     5.3     0.0     5.31    0.0     
          5.32    0.0     5.33    0.0     5.34    0.0     5.35    0.0     
          5.36    0.0     5.37    0.0     5.38    0.0     5.39    0.0     
          5.4     0.0     5.41    0.0     5.42    0.0     5.43    0.0     
          5.44    0.0     5.45    0.0     5.46    0.0     5.47    0.0     
          5.48    0.0     5.49    0.0     5.5     0.0     5.51    0.0     
          5.52    0.0     5.53    0.0     5.54    0.0     5.55    0.0     
          5.56    0.0     5.57    0.0     5.58    0.0     5.59    0.0     
          5.6     0.0     5.61    0.0     5.62    0.0     5.63    0.0     
          5.64    0.0     5.65    0.0     5.66    0.0     5.67    0.0     
          5.68    0.0     5.69    0.0     5.7     0.0     5.71    0.0     
          5.72    0.0     5.73    0.0     5.74    0.0     5.75    0.0     
          5.76    0.0     5.77    0.0     5.78    0.0     5.79    0.0     
          5.8     0.0     5.81    0.0     5.82    0.0     5.83    0.0     
          5.84    0.0     5.85    0.0     5.86    0.0     5.87    0.0     
          5.88    0.0     5.89    0.0     5.9     0.0     5.91    0.0     
          5.92    0.0     5.93    0.0     5.94    0.0     5.95    0.0     
          5.96    0.0     5.97    0.0     5.98    0.0     5.99    0.0     
          6.0     0.0     6.01    0.0     6.02    0.0     6.03    0.0     
          6.04    0.0     6.05    0.0     6.06    0.0     6.07    0.0     
          6.08    0.0     6.09    0.0     6.1     0.0     6.11    0.0     
          6.12    0.0     6.13    0.0     6.14    0.0     6.15    0.0     
          6.16    0.0     6.17    0.0     6.18    0.0     6.19    0.0     
          6.2     0.0     6.21    0.0     6.22    0.0     6.23    0.0     
          6.24    0.0     6.25    0.0     6.26    0.0     6.27    0.0     
          6.28    0.0     6.29    0.0     6.3     0.0     6.31    0.0     
          6.32    0.0     6.33    0.0     6.34    0.0     6.35    0.0     
          6.36    0.0     6.37    0.0     6.38    0.0     6.39    0.0     
          6.4     0.0     6.41    0.0     6.42    0.0     6.43    0.0     
          6.44    0.0     6.45    0.0     6.46    0.0     6.47    0.0     
          6.48    0.0     6.49    0.0     6.5     0.0     6.51    0.0     
          6.52    0.0     6.53    0.0     6.54    0.0     6.55    0.0     
          6.56    0.0     6.57    0.0     6.58    0.0     6.59    0.0     
          6.6     0.0     6.61    0.0     6.62    0.0     6.63    0.0     
          6.64    0.0     6.65    0.0     6.66    0.0     6.67    0.0     
          6.68    0.0     6.69    0.0     6.7     0.0     6.71    0.0     
          6.72    0.0     6.73    0.0     6.74    0.0     6.75    0.0     
          6.76    0.0     6.77    0.0     6.78    0.0     6.79    0.0     
          6.8     0.0     6.81    0.0     6.82    0.0     6.83    0.0     
          6.84    0.0     6.85    0.0     6.86    0.0     6.87    0.0     
          6.88    0.0     6.89    0.0     6.9     0.0     6.91    0.0     
          6.92    0.0     6.93    0.0     6.94    0.0     6.95    0.0     
          6.96    0.0     6.97    0.0     6.98    0.0     6.99    0.0     
          7.0     0.0     7.01    0.0     7.02    0.0     7.03    0.0     
          7.04    0.0     7.05    0.0     7.06    0.0     7.07    0.0     
          7.08    0.0     7.09    0.0     7.1     0.0     7.11    0.0     
          7.12    0.0     7.13    0.0     7.14    0.0     7.15    0.0     
          7.16    0.0     7.17    0.0     7.18    0.0     7.19    0.0     
          7.2     0.0     7.21    0.0     7.22    0.0     7.23    0.0     
          7.24    0.0     7.25    0.0     7.26    0.0     7.27    0.0     
          7.28    0.0     7.29    0.0     7.3     0.0     7.31    0.0     
          7.32    0.0     7.33    0.0     7.34    0.0     7.35    0.0     
          7.36    0.0     7.37    0.0     7.38    0.0     7.39    0.0     
          7.4     0.0     7.41    0.0     7.42    0.0     7.43    0.0     
          7.44    0.0     7.45    0.0     7.46    0.0     7.47    0.0     
          7.48    0.0     7.49    0.0     7.5     0.0     7.51    0.0     
          7.52    0.0     7.53    0.0     7.54    0.0     7.55    0.0     
          7.56    0.0     7.57    0.0     7.58    0.0     7.59    0.0     
          7.6     0.0     7.61    0.0     7.62    0.0     7.63    0.0     
          7.64    0.0     7.65    0.0     7.66    0.0     7.67    0.0     
          7.68    0.0     7.69    0.0     7.7     0.0     7.71    0.0     
          7.72    0.0     7.73    0.0     7.74    0.0     7.75    0.0     
          7.76    0.0     7.77    0.0     7.78    0.0     7.79    0.0     
          7.8     0.0     7.81    0.0     7.82    0.0     7.83    0.0     
          7.84    0.0     7.85    0.0     7.86    0.0     7.87    0.0     
          7.88    0.0     7.89    0.0     7.9     0.0     7.91    0.0     
          7.92    0.0     7.93    0.0     7.94    0.0     7.95    0.0     
          7.96    0.0     7.97    0.0     7.98    0.0     7.99    0.0     
          8.0     0.0     8.01    0.0     8.02    0.0     8.03    0.0     
          8.04    0.0     8.05    0.0     8.06    0.0     8.07    0.0     
          8.08    0.0     8.09    0.0     8.1     0.0     8.11    0.0     
          8.12    0.0     8.13    0.0     8.14    0.0     8.15    0.0     
          8.16    0.0     8.17    0.0     8.18    0.0     8.19    0.0     
          8.2     0.0     8.21    0.0     8.22    0.0     8.23    0.0     
          8.24    0.0     8.25    0.0     8.26    0.0     8.27    0.0     
          8.28    0.0     8.29    0.0     8.3     0.0     8.31    0.0     
          8.32    0.0     8.33    0.0     8.34    0.0     8.35    0.0     
          8.36    0.0     8.37    0.0     8.38    0.0     8.39    0.0     
          8.4     0.0     8.41    0.0     8.42    0.0     8.43    0.0     
          8.44    0.0     8.45    0.0     8.46    0.0     8.47    0.0     
          8.48    0.0     8.49    0.0     8.5     0.0     8.51    0.0     
          8.52    0.0     8.53    0.0     8.54    0.0     8.55    0.0     
          8.56    0.0     8.57    0.0     8.58    0.0     8.59    0.0     
          8.6     0.0     8.61    0.0     8.62    0.0     8.63    0.0     
          8.64    0.0     8.65    0.0     8.66    0.0     8.67    0.0     
          8.68    0.0     8.69    0.0     8.7     0.0     8.71    0.0     
          8.72    0.0     8.73    0.0     8.74    0.0     8.75    0.0     
          8.76    0.0     8.77    0.0     8.78    0.0     8.79    0.0     
          8.8     0.0     8.81    0.0     8.82    0.0     8.83    0.0     
          8.84    0.0     8.85    0.0     8.86    0.0     8.87    0.0     
          8.88    0.0     8.89    0.0     8.9     0.0     8.91    0.0     
          8.92    0.0     8.93    0.0     8.94    0.0     8.95    0.0     
          8.96    0.0     8.97    0.0     8.98    0.0     8.99    0.0     
          9.0     0.0     9.01    0.0     9.02    0.0     9.03    0.0     
          9.04    0.0     9.05    0.0     9.06    0.0     9.07    0.0     
          9.08    0.0     9.09    0.0     9.1     0.0     9.11    0.0     
          9.12    0.0     9.13    0.0     9.14    0.0     9.15    0.0     
          9.16    0.0     9.17    0.0     9.18    0.0     9.19    0.0     
          9.2     0.0     9.21    0.0     9.22    0.0     9.23    0.0     
          9.24    0.0     9.25    0.0     9.26    0.0     9.27    0.0     
          9.28    0.0     9.29    0.0     9.3     0.0     9.31    0.0     
          9.32    0.0     9.33    0.0     9.34    0.0     9.35    0.0     
          9.36    0.0     9.37    0.0     9.38    0.0     9.39    0.0     
          9.4     0.0     9.41    0.0     9.42    0.0     9.43    0.0     
          9.44    0.0     9.45    0.0     9.46    0.0     9.47    0.0     
          9.48    0.0     9.49    0.0     9.5     0.0     9.51    0.0     
          9.52    0.0     9.53    0.0     9.54    0.0     9.55    0.0     
          9.56    0.0     9.57    0.0     9.58    0.0     9.59    0.0     
          9.6     0.0     9.61    0.0     9.62    0.0     9.63    0.0     
          9.64    0.0     9.65    0.0     9.66    0.0     9.67    0.0     
          9.68    0.0     9.69    0.0     9.7     0.0     9.71    0.0     
          9.72    0.0     9.73    0.0     9.74    0.0     9.75    0.0     
          9.76    0.0     9.77    0.0     9.78    0.0     9.79    0.0     
          9.8     0.0     9.81    0.0     9.82    0.0     9.83    0.0     
          9.84    0.0     9.85    0.0     9.86    0.0     9.87    0.0     
          9.88    0.0     9.89    0.0     9.9     0.0     9.91    0.0     
          9.92    0.0     9.93    0.0     9.94    0.0     9.95    0.0     
          9.96    0.0     9.97    0.0     9.98    0.0     9.99    0.0     
          10.0    0.0     10.01   -0.2575 10.02   -1.0160 10.03   -2.2339 
          10.04   -3.8440 10.05   -5.7581 10.06   -7.8708 10.07   -10.066 
          10.08   -12.223 10.09   -14.224 10.1    -15.958 10.11   -17.330 
          10.12   -18.265 10.13   -18.711 10.14   -18.644 10.15   -18.068 
          10.16   -17.014 10.17   -15.540 10.18   -13.727 10.19   -11.675 
          10.2    -9.4966 10.21   -7.3111 10.22   -5.2390 10.23   -3.3941 
          10.24   -1.8778 10.25   -0.7735 10.26   -0.1417 10.27   0.0     
          10.28   0.0     10.29   0.0     10.3    0.0     10.31   0.0     
          10.32   0.0     10.33   0.0     10.34   0.0     10.35   0.0     
          10.36   0.0     10.37   0.0     10.38   0.0     10.39   0.0     
          10.4    0.0     10.41   0.0     10.42   0.0     10.43   0.0     
          10.44   0.0     10.45   0.0     10.46   0.0     10.47   0.0     
          10.48   0.0     10.49   0.0     10.5    0.0     10.51   0.0     
          10.52   0.0     10.53   0.0     10.54   0.0     10.55   0.0     
          10.56   0.0     10.57   0.0     10.58   0.0     10.59   0.0     
          10.6    0.0     10.61   0.0     10.62   0.0     10.63   0.0     
          10.64   0.0     10.65   0.0     10.66   0.0     10.67   0.0     
          10.68   0.0     10.69   0.0     10.7    0.0     10.71   0.0     
          10.72   0.0     10.73   0.0     10.74   0.0     10.75   0.0     
          10.76   0.0     10.77   0.0     10.78   0.0     10.79   0.0     
          10.8    0.0     10.81   0.0     10.82   0.0     10.83   0.0     
          10.84   0.0     10.85   0.0     10.86   0.0     10.87   0.0     
          10.88   0.0     10.89   0.0     10.9    0.0     10.91   0.0     
          10.92   0.0     10.93   0.0     10.94   0.0     10.95   0.0     
          10.96   0.0     10.97   0.0     10.98   0.0     10.99   0.0     
          11.0    0.0     11.01   0.0     11.02   0.0     11.03   0.0     
          11.04   0.0     11.05   0.0     11.06   0.0     11.07   0.0     
          11.08   0.0     11.09   0.0     11.1    0.0     11.11   0.0     
          11.12   0.0     11.13   0.0     11.14   0.0     11.15   0.0     
          11.16   0.0     11.17   0.0     11.18   0.0     11.19   0.0     
          11.2    0.0     11.21   0.0     11.22   0.0     11.23   0.0     
          11.24   0.0     11.25   0.0     11.26   0.0     11.27   0.0     
          11.28   0.0     11.29   0.0     11.3    0.0     11.31   0.0     
          11.32   0.0     11.33   0.0     11.34   0.0     11.35   0.0     
          11.36   0.0     11.37   0.0     11.38   0.0     11.39   0.0     
          11.4    0.0     11.41   0.0     11.42   0.0     11.43   0.0     
          11.44   0.0     11.45   0.0     11.46   0.0     11.47   0.0     
          11.48   0.0     11.49   0.0     11.5    0.0     11.51   0.0     
          11.52   0.0     11.53   0.0     11.54   0.0     11.55   0.0     
          11.56   0.0     11.57   0.0     11.58   0.0     11.59   0.0     
          11.6    0.0     11.61   0.0     11.62   0.0     11.63   0.0     
          11.64   0.0     11.65   0.0     11.66   0.0     11.67   0.0     
          11.68   0.0     11.69   0.0     11.7    0.0     11.71   0.0     
          11.72   0.0     11.73   0.0     11.74   0.0     11.75   0.0     
          11.76   0.0     11.77   0.0     11.78   0.0     11.79   0.0     
          11.8    0.0     11.81   0.0     11.82   0.0     11.83   0.0     
          11.84   0.0     11.85   0.0     11.86   0.0     11.87   0.0     
          11.88   0.0     11.89   0.0     11.9    0.0     11.91   0.0     
          11.92   0.0     11.93   0.0     11.94   0.0     11.95   0.0     
          11.96   0.0     11.97   0.0     11.98   0.0     11.99   0.0     
          12.0    0.0     12.01   0.0     12.02   0.0     12.03   0.0     
          12.04   0.0     12.05   0.0     12.06   0.0     12.07   0.0     
          12.08   0.0     12.09   0.0     12.1    0.0     12.11   0.0     
          12.12   0.0     12.13   0.0     12.14   0.0     12.15   0.0     
          12.16   0.0     12.17   0.0     12.18   0.0     12.19   0.0     
          12.2    0.0     12.21   0.0     12.22   0.0     12.23   0.0     
          12.24   0.0     12.25   0.0     12.26   0.0     12.27   0.0     
          12.28   0.0     12.29   0.0     12.3    0.0     12.31   0.0     
          12.32   0.0     12.33   0.0     12.34   0.0     12.35   0.0     
          12.36   0.0     12.37   0.0     12.38   0.0     12.39   0.0     
          12.4    0.0     12.41   0.0     12.42   0.0     12.43   0.0     
          12.44   0.0     12.45   0.0     12.46   0.0     12.47   0.0     
          12.48   0.0     12.49   0.0     12.5    0.0     12.51   0.0     
          12.52   0.0     12.53   0.0     12.54   0.0     12.55   0.0     
          12.56   0.0     12.57   0.0     12.58   0.0     12.59   0.0     
          12.6    0.0     12.61   0.0     12.62   0.0     12.63   0.0     
          12.64   0.0     12.65   0.0     12.66   0.0     12.67   0.0     
          12.68   0.0     12.69   0.0     12.7    0.0     12.71   0.0     
          12.72   0.0     12.73   0.0     12.74   0.0     12.75   0.0     
          12.76   0.0     12.77   0.0     12.78   0.0     12.79   0.0     
          12.8    0.0     12.81   0.0     12.82   0.0     12.83   0.0     
          12.84   0.0     12.85   0.0     12.86   0.0     12.87   0.0     
          12.88   0.0     12.89   0.0     12.9    0.0     12.91   0.0     
          12.92   0.0     12.93   0.0     12.94   0.0     12.95   0.0     
          12.96   0.0     12.97   0.0     12.98   0.0     12.99   0.0     
          13.0    0.0     13.01   0.0     13.02   0.0     13.03   0.0     
          13.04   0.0     13.05   0.0     13.06   0.0     13.07   0.0     
          13.08   0.0     13.09   0.0     13.1    0.0     13.11   0.0     
          13.12   0.0     13.13   0.0     13.14   0.0     13.15   0.0     
          13.16   0.0     13.17   0.0     13.18   0.0     13.19   0.0     
          13.2    0.0     13.21   0.0     13.22   0.0     13.23   0.0     
          13.24   0.0     13.25   0.0     13.26   0.0     13.27   0.0     
          13.28   0.0     13.29   0.0     13.3    0.0     13.31   0.0     
          13.32   0.0     13.33   0.0     13.34   0.0     13.35   0.0     
          13.36   0.0     13.37   0.0     13.38   0.0     13.39   0.0     
          13.4    0.0     13.41   0.0     13.42   0.0     13.43   0.0     
          13.44   0.0     13.45   0.0     13.46   0.0     13.47   0.0     
          13.48   0.0     13.49   0.0     13.5    0.0     13.51   0.0     
          13.52   0.0     13.53   0.0     13.54   0.0     13.55   0.0     
          13.56   0.0     13.57   0.0     13.58   0.0     13.59   0.0     
          13.6    0.0     13.61   0.0     13.62   0.0     13.63   0.0     
          13.64   0.0     13.65   0.0     13.66   0.0     13.67   0.0     
          13.68   0.0     13.69   0.0     13.7    0.0     13.71   0.0     
          13.72   0.0     13.73   0.0     13.74   0.0     13.75   0.0     
          13.76   0.0     13.77   0.0     13.78   0.0     13.79   0.0     
          13.8    0.0     13.81   0.0     13.82   0.0     13.83   0.0     
          13.84   0.0     13.85   0.0     13.86   0.0     13.87   0.0     
          13.88   0.0     13.89   0.0     13.9    0.0     13.91   0.0     
          13.92   0.0     13.93   0.0     13.94   0.0     13.95   0.0     
          13.96   0.0     13.97   0.0     13.98   0.0     13.99   0.0     
          14.0    0.0     14.01   0.0     14.02   0.0     14.03   0.0     
          14.04   0.0     14.05   0.0     14.06   0.0     14.07   0.0     
          14.08   0.0     14.09   0.0     14.1    0.0     14.11   0.0     
          14.12   0.0     14.13   0.0     14.14   0.0     14.15   0.0     
          14.16   0.0     14.17   0.0     14.18   0.0     14.19   0.0     
          14.2    0.0     14.21   0.0     14.22   0.0     14.23   0.0     
          14.24   0.0     14.25   0.0     14.26   0.0     14.27   0.0     
          14.28   0.0     14.29   0.0     14.3    0.0     14.31   0.0     
          14.32   0.0     14.33   0.0     14.34   0.0     14.35   0.0     
          14.36   0.0     14.37   0.0     14.38   0.0     14.39   0.0     
          14.4    0.0     14.41   0.0     14.42   0.0     14.43   0.0     
          14.44   0.0     14.45   0.0     14.46   0.0     14.47   0.0     
          14.48   0.0     14.49   0.0     14.5    0.0     14.51   0.0     
          14.52   0.0     14.53   0.0     14.54   0.0     14.55   0.0     
          14.56   0.0     14.57   0.0     14.58   0.0     14.59   0.0     
          14.6    0.0     14.61   0.0     14.62   0.0     14.63   0.0     
          14.64   0.0     14.65   0.0     14.66   0.0     14.67   0.0     
          14.68   0.0     14.69   0.0     14.7    0.0     14.71   0.0     
          14.72   0.0     14.73   0.0     14.74   0.0     14.75   0.0     
          14.76   0.0     14.77   0.0     14.78   0.0     14.79   0.0     
          14.8    0.0     14.81   0.0     14.82   0.0     14.83   0.0     
          14.84   0.0     14.85   0.0     14.86   0.0     14.87   0.0     
          14.88   0.0     14.89   0.0     14.9    0.0     14.91   0.0     
          14.92   0.0     14.93   0.0     14.94   0.0     14.95   0.0     
          14.96   0.0     14.97   0.0     14.98   0.0     14.99   0.0     
          15.0    0.0     15.01   0.0     15.02   0.0     15.03   0.0     
          15.04   0.0     15.05   0.0     15.06   0.0     15.07   0.0     
          15.08   0.0     15.09   0.0     15.1    0.0     15.11   0.0     
          15.12   0.0     15.13   0.0     15.14   0.0     15.15   0.0     
          15.16   0.0     15.17   0.0     15.18   0.0     15.19   0.0     
          15.2    0.0     15.21   0.0     15.22   0.0     15.23   0.0     
          15.24   0.0     15.25   0.0     15.26   0.0     15.27   0.0     
          15.28   0.0     15.29   0.0     15.3    0.0     15.31   0.0     
          15.32   0.0     15.33   0.0     15.34   0.0     15.35   0.0     
          15.36   0.0     15.37   0.0     15.38   0.0     15.39   0.0     
          15.4    0.0     15.41   0.0     15.42   0.0     15.43   0.0     
          15.44   0.0     15.45   0.0     15.46   0.0     15.47   0.0     
          15.48   0.0     15.49   0.0     15.5    0.0     15.51   0.0     
          15.52   0.0     15.53   0.0     15.54   0.0     15.55   0.0     
          15.56   0.0     15.57   0.0     15.58   0.0     15.59   0.0     
          15.6    0.0     15.61   0.0     15.62   0.0     15.63   0.0     
          15.64   0.0     15.65   0.0     15.66   0.0     15.67   0.0     
          15.68   0.0     15.69   0.0     15.7    0.0     15.71   0.0     
          15.72   0.0     15.73   0.0     15.74   0.0     15.75   0.0     
          15.76   0.0     15.77   0.0     15.78   0.0     15.79   0.0     
          15.8    0.0     15.81   0.0     15.82   0.0     15.83   0.0     
          15.84   0.0     15.85   0.0     15.86   0.0     15.87   0.0     
          15.88   0.0     15.89   0.0     15.9    0.0     15.91   0.0     
          15.92   0.0     15.93   0.0     15.94   0.0     15.95   0.0     
          15.96   0.0     15.97   0.0     15.98   0.0     15.99   0.0     
          16.0    0.0     16.01   0.0     16.02   0.0     16.03   0.0     
          16.04   0.0     16.05   0.0     16.06   0.0     16.07   0.0     
          16.08   0.0     16.09   0.0     16.1    0.0     16.11   0.0     
          16.12   0.0     16.13   0.0     16.14   0.0     16.15   0.0     
          16.16   0.0     16.17   0.0     16.18   0.0     16.19   0.0     
          16.2    0.0     16.21   0.0     16.22   0.0     16.23   0.0     
          16.24   0.0     16.25   0.0     16.26   0.0     16.27   0.0     
          16.28   0.0     16.29   0.0     16.3    0.0     16.31   0.0     
          16.32   0.0     16.33   0.0     16.34   0.0     16.35   0.0     
          16.36   0.0     16.37   0.0     16.38   0.0     16.39   0.0     
          16.4    0.0     16.41   0.0     16.42   0.0     16.43   0.0     
          16.44   0.0     16.45   0.0     16.46   0.0     16.47   0.0     
          16.48   0.0     16.49   0.0     16.5    0.0     16.51   0.0     
          16.52   0.0     16.53   0.0     16.54   0.0     16.55   0.0     
          16.56   0.0     16.57   0.0     16.58   0.0     16.59   0.0     
          16.6    0.0     16.61   0.0     16.62   0.0     16.63   0.0     
          16.64   0.0     16.65   0.0     16.66   0.0     16.67   0.0     
          16.68   0.0     16.69   0.0     16.7    0.0     16.71   0.0     
          16.72   0.0     16.73   0.0     16.74   0.0     16.75   0.0     
          16.76   0.0     16.77   0.0     16.78   0.0     16.79   0.0     
          16.8    0.0     16.81   0.0     16.82   0.0     16.83   0.0     
          16.84   0.0     16.85   0.0     16.86   0.0     16.87   0.0     
          16.88   0.0     16.89   0.0     16.9    0.0     16.91   0.0     
          16.92   0.0     16.93   0.0     16.94   0.0     16.95   0.0     
          16.96   0.0     16.97   0.0     16.98   0.0     16.99   0.0     
          17.0    0.0     17.01   0.0     17.02   0.0     17.03   0.0     
          17.04   0.0     17.05   0.0     17.06   0.0     17.07   0.0     
          17.08   0.0     17.09   0.0     17.1    0.0     17.11   0.0     
          17.12   0.0     17.13   0.0     17.14   0.0     17.15   0.0     
          17.16   0.0     17.17   0.0     17.18   0.0     17.19   0.0     
          17.2    0.0     17.21   0.0     17.22   0.0     17.23   0.0     
          17.24   0.0     17.25   0.0     17.26   0.0     17.27   0.0     
          17.28   0.0     17.29   0.0     17.3    0.0     17.31   0.0     
          17.32   0.0     17.33   0.0     17.34   0.0     17.35   0.0     
          17.36   0.0     17.37   0.0     17.38   0.0     17.39   0.0     
          17.4    0.0     17.41   0.0     17.42   0.0     17.43   0.0     
          17.44   0.0     17.45   0.0     17.46   0.0     17.47   0.0     
          17.48   0.0     17.49   0.0     17.5    0.0     17.51   0.0     
          17.52   0.0     17.53   0.0     17.54   0.0     17.55   0.0     
          17.56   0.0     17.57   0.0     17.58   0.0     17.59   0.0     
          17.6    0.0     17.61   0.0     17.62   0.0     17.63   0.0     
          17.64   0.0     17.65   0.0     17.66   0.0     17.67   0.0     
          17.68   0.0     17.69   0.0     17.7    0.0     17.71   0.0     
          17.72   0.0     17.73   0.0     17.74   0.0     17.75   0.0     
          17.76   0.0     17.77   0.0     17.78   0.0     17.79   0.0     
          17.8    0.0     17.81   0.0     17.82   0.0     17.83   0.0     
          17.84   0.0     17.85   0.0     17.86   0.0     17.87   0.0     
          17.88   0.0     17.89   0.0     17.9    0.0     17.91   0.0     
          17.92   0.0     17.93   0.0     17.94   0.0     17.95   0.0     
          17.96   0.0     17.97   0.0     17.98   0.0     17.99   0.0     
          18.0    0.0     18.01   0.0     18.02   0.0     18.03   0.0     
          18.04   0.0     18.05   0.0     18.06   0.0     18.07   0.0     
          18.08   0.0     18.09   0.0     18.1    0.0     18.11   0.0     
          18.12   0.0     18.13   0.0     18.14   0.0     18.15   0.0     
          18.16   0.0     18.17   0.0     18.18   0.0     18.19   0.0     
          18.2    0.0     18.21   0.0     18.22   0.0     18.23   0.0     
          18.24   0.0     18.25   0.0     18.26   0.0     18.27   0.0     
          18.28   0.0     18.29   0.0     18.3    0.0     18.31   0.0     
          18.32   0.0     18.33   0.0     18.34   0.0     18.35   0.0     
          18.36   0.0     18.37   0.0     18.38   0.0     18.39   0.0     
          18.4    0.0     18.41   0.0     18.42   0.0     18.43   0.0     
          18.44   0.0     18.45   0.0     18.46   0.0     18.47   0.0     
          18.48   0.0     18.49   0.0     18.5    0.0     18.51   0.0     
          18.52   0.0     18.53   0.0     18.54   0.0     18.55   0.0     
          18.56   0.0     18.57   0.0     18.58   0.0     18.59   0.0     
          18.6    0.0     18.61   0.0     18.62   0.0     18.63   0.0     
          18.64   0.0     18.65   0.0     18.66   0.0     18.67   0.0     
          18.68   0.0     18.69   0.0     18.7    0.0     18.71   0.0     
          18.72   0.0     18.73   0.0     18.74   0.0     18.75   0.0     
          18.76   0.0     18.77   0.0     18.78   0.0     18.79   0.0     
          18.8    0.0     18.81   0.0     18.82   0.0     18.83   0.0     
          18.84   0.0     18.85   0.0     18.86   0.0     18.87   0.0     
          18.88   0.0     18.89   0.0     18.9    0.0     18.91   0.0     
          18.92   0.0     18.93   0.0     18.94   0.0     18.95   0.0     
          18.96   0.0     18.97   0.0     18.98   0.0     18.99   0.0     
          19.0    0.0     19.01   0.0     19.02   0.0     19.03   0.0     
          19.04   0.0     19.05   0.0     19.06   0.0     19.07   0.0     
          19.08   0.0     19.09   0.0     19.1    0.0     19.11   0.0     
          19.12   0.0     19.13   0.0     19.14   0.0     19.15   0.0     
          19.16   0.0     19.17   0.0     19.18   0.0     19.19   0.0     
          19.2    0.0     19.21   0.0     19.22   0.0     19.23   0.0     
          19.24   0.0     19.25   0.0     19.26   0.0     19.27   0.0     
          19.28   0.0     19.29   0.0     19.3    0.0     19.31   0.0     
          19.32   0.0     19.33   0.0     19.34   0.0     19.35   0.0     
          19.36   0.0     19.37   0.0     19.38   0.0     19.39   0.0     
          19.4    0.0     19.41   0.0     19.42   0.0     19.43   0.0     
          19.44   0.0     19.45   0.0     19.46   0.0     19.47   0.0     
          19.48   0.0     19.49   0.0     19.5    0.0     19.51   0.0     
          19.52   0.0     19.53   0.0     19.54   0.0     19.55   0.0     
          19.56   0.0     19.57   0.0     19.58   0.0     19.59   0.0     
          19.6    0.0     19.61   0.0     19.62   0.0     19.63   0.0     
          19.64   0.0     19.65   0.0     19.66   0.0     19.67   0.0     
          19.68   0.0     19.69   0.0     19.7    0.0     19.71   0.0     
          19.72   0.0     19.73   0.0     19.74   0.0     19.75   0.0     
          19.76   0.0     19.77   0.0     19.78   0.0     19.79   0.0     
          19.8    0.0     19.81   0.0     19.82   0.0     19.83   0.0     
          19.84   0.0     19.85   0.0     19.86   0.0     19.87   0.0     
          19.88   0.0     19.89   0.0     19.9    0.0     19.91   0.0     
          19.92   0.0     19.93   0.0     19.94   0.0     19.95   0.0     
          19.96   0.0     19.97   0.0     19.98   0.0     19.99   0.0     
          20.0    0.0     20.01   0.12878 20.02   0.50804 20.03   1.11695 
          20.04   1.92203 20.05   2.87905 20.06   3.93542 20.07   5.03308 
          20.08   6.11171 20.09   7.11204 20.1    7.97909 20.11   8.66521 
          20.12   9.13270 20.13   9.35588 20.14   9.32247 20.15   9.03431 
          20.16   8.50723 20.17   7.77021 20.18   6.86374 20.19   5.83764 
          20.2    4.74830 20.21   3.65557 20.22   2.61952 20.23   1.69708 
          20.24   0.93893 20.25   0.38675 20.26   0.07087 20.27   0.0     
          20.28   0.0     20.29   0.0     20.3    0.0     20.31   0.0     
          20.32   0.0     20.33   0.0     20.34   0.0     20.35   0.0     
          20.36   0.0     20.37   0.0     20.38   0.0     20.39   0.0     
          20.4    0.0     20.41   0.0     20.42   0.0     20.43   0.0     
          20.44   0.0     20.45   0.0     20.46   0.0     20.47   0.0     
          20.48   0.0     20.49   0.0     20.5    0.0     20.51   0.0     
          20.52   0.0     20.53   0.0     20.54   0.0     20.55   0.0     
          20.56   0.0     20.57   0.0     20.58   0.0     20.59   0.0     
          20.6    0.0     20.61   0.0     20.62   0.0     20.63   0.0     
          20.64   0.0     20.65   0.0     20.66   0.0     20.67   0.0     
          20.68   0.0     20.69   0.0     20.7    0.0     20.71   0.0     
          20.72   0.0     20.73   0.0     20.74   0.0     20.75   0.0     
          20.76   0.0     20.77   0.0     20.78   0.0     20.79   0.0     
          20.8    0.0     20.81   0.0     20.82   0.0     20.83   0.0     
          20.84   0.0     20.85   0.0     20.86   0.0     20.87   0.0     
          20.88   0.0     20.89   0.0     20.9    0.0     20.91   0.0     
          20.92   0.0     20.93   0.0     20.94   0.0     20.95   0.0     
          20.96   0.0     20.97   0.0     20.98   0.0     20.99   0.0     
          21.0    0.0     21.01   0.0     21.02   0.0     21.03   0.0     
          21.04   0.0     21.05   0.0     21.06   0.0     21.07   0.0     
          21.08   0.0     21.09   0.0     21.1    0.0     21.11   0.0     
          21.12   0.0     21.13   0.0     21.14   0.0     21.15   0.0     
          21.16   0.0     21.17   0.0     21.18   0.0     21.19   0.0     
          21.2    0.0     21.21   0.0     21.22   0.0     21.23   0.0     
          21.24   0.0     21.25   0.0     21.26   0.0     21.27   0.0     
          21.28   0.0     21.29   0.0     21.3    0.0     21.31   0.0     
          21.32   0.0     21.33   0.0     21.34   0.0     21.35   0.0     
          21.36   0.0     21.37   0.0     21.38   0.0     21.39   0.0     
          21.4    0.0     21.41   0.0     21.42   0.0     21.43   0.0     
          21.44   0.0     21.45   0.0     21.46   0.0     21.47   0.0     
          21.48   0.0     21.49   0.0     21.5    0.0     21.51   0.0     
          21.52   0.0     21.53   0.0     21.54   0.0     21.55   0.0     
          21.56   0.0     21.57   0.0     21.58   0.0     21.59   0.0     
          21.6    0.0     21.61   0.0     21.62   0.0     21.63   0.0     
          21.64   0.0     21.65   0.0     21.66   0.0     21.67   0.0     
          21.68   0.0     21.69   0.0     21.7    0.0     21.71   0.0     
          21.72   0.0     21.73   0.0     21.74   0.0     21.75   0.0     
          21.76   0.0     21.77   0.0     21.78   0.0     21.79   0.0     
          21.8    0.0     21.81   0.0     21.82   0.0     21.83   0.0     
          21.84   0.0     21.85   0.0     21.86   0.0     21.87   0.0     
          21.88   0.0     21.89   0.0     21.9    0.0     21.91   0.0     
          21.92   0.0     21.93   0.0     21.94   0.0     21.95   0.0     
          21.96   0.0     21.97   0.0     21.98   0.0     21.99   0.0     
          22.0    0.0     22.01   0.0     22.02   0.0     22.03   0.0     
          22.04   0.0     22.05   0.0     22.06   0.0     22.07   0.0     
          22.08   0.0     22.09   0.0     22.1    0.0     22.11   0.0     
          22.12   0.0     22.13   0.0     22.14   0.0     22.15   0.0     
          22.16   0.0     22.17   0.0     22.18   0.0     22.19   0.0     
          22.2    0.0     22.21   0.0     22.22   0.0     22.23   0.0     
          22.24   0.0     22.25   0.0     22.26   0.0     22.27   0.0     
          22.28   0.0     22.29   0.0     22.3    0.0     22.31   0.0     
          22.32   0.0     22.33   0.0     22.34   0.0     22.35   0.0     
          22.36   0.0     22.37   0.0     22.38   0.0     22.39   0.0     
          22.4    0.0     22.41   0.0     22.42   0.0     22.43   0.0     
          22.44   0.0     22.45   0.0     22.46   0.0     22.47   0.0     
          22.48   0.0     22.49   0.0     22.5    0.0     22.51   0.0     
          22.52   0.0     22.53   0.0     22.54   0.0     22.55   0.0     
          22.56   0.0     22.57   0.0     22.58   0.0     22.59   0.0     
          22.6    0.0     22.61   0.0     22.62   0.0     22.63   0.0     
          22.64   0.0     22.65   0.0     22.66   0.0     22.67   0.0     
          22.68   0.0     22.69   0.0     22.7    0.0     22.71   0.0     
          22.72   0.0     22.73   0.0     22.74   0.0     22.75   0.0     
          22.76   0.0     22.77   0.0     22.78   0.0     22.79   0.0     
          22.8    0.0     22.81   0.0     22.82   0.0     22.83   0.0     
          22.84   0.0     22.85   0.0     22.86   0.0     22.87   0.0     
          22.88   0.0     22.89   0.0     22.9    0.0     22.91   0.0     
          22.92   0.0     22.93   0.0     22.94   0.0     22.95   0.0     
          22.96   0.0     22.97   0.0     22.98   0.0     22.99   0.0     
          23.0    0.0     23.01   0.0     23.02   0.0     23.03   0.0     
          23.04   0.0     23.05   0.0     23.06   0.0     23.07   0.0     
          23.08   0.0     23.09   0.0     23.1    0.0     23.11   0.0     
          23.12   0.0     23.13   0.0     23.14   0.0     23.15   0.0     
          23.16   0.0     23.17   0.0     23.18   0.0     23.19   0.0     
          23.2    0.0     23.21   0.0     23.22   0.0     23.23   0.0     
          23.24   0.0     23.25   0.0     23.26   0.0     23.27   0.0     
          23.28   0.0     23.29   0.0     23.3    0.0     23.31   0.0     
          23.32   0.0     23.33   0.0     23.34   0.0     23.35   0.0     
          23.36   0.0     23.37   0.0     23.38   0.0     23.39   0.0     
          23.4    0.0     23.41   0.0     23.42   0.0     23.43   0.0     
          23.44   0.0     23.45   0.0     23.46   0.0     23.47   0.0     
          23.48   0.0     23.49   0.0     23.5    0.0     23.51   0.0     
          23.52   0.0     23.53   0.0     23.54   0.0     23.55   0.0     
          23.56   0.0     23.57   0.0     23.58   0.0     23.59   0.0     
          23.6    0.0     23.61   0.0     23.62   0.0     23.63   0.0     
          23.64   0.0     23.65   0.0     23.66   0.0     23.67   0.0     
          23.68   0.0     23.69   0.0     23.7    0.0     23.71   0.0     
          23.72   0.0     23.73   0.0     23.74   0.0     23.75   0.0     
          23.76   0.0     23.77   0.0     23.78   0.0     23.79   0.0     
          23.8    0.0     23.81   0.0     23.82   0.0     23.83   0.0     
          23.84   0.0     23.85   0.0     23.86   0.0     23.87   0.0     
          23.88   0.0     23.89   0.0     23.9    0.0     23.91   0.0     
          23.92   0.0     23.93   0.0     23.94   0.0     23.95   0.0     
          23.96   0.0     23.97   0.0     23.98   0.0     23.99   0.0     
          24.0    0.0     24.01   0.0     24.02   0.0     24.03   0.0     
          24.04   0.0     24.05   0.0     24.06   0.0     24.07   0.0     
          24.08   0.0     24.09   0.0     24.1    0.0     24.11   0.0     
          24.12   0.0     24.13   0.0     24.14   0.0     24.15   0.0     
          24.16   0.0     24.17   0.0     24.18   0.0     24.19   0.0     
          24.2    0.0     24.21   0.0     24.22   0.0     24.23   0.0     
          24.24   0.0     24.25   0.0     24.26   0.0     24.27   0.0     
          24.28   0.0     24.29   0.0     24.3    0.0     24.31   0.0     
          24.32   0.0     24.33   0.0     24.34   0.0     24.35   0.0     
          24.36   0.0     24.37   0.0     24.38   0.0     24.39   0.0     
          24.4    0.0     24.41   0.0     24.42   0.0     24.43   0.0     
          24.44   0.0     24.45   0.0     24.46   0.0     24.47   0.0     
          24.48   0.0     24.49   0.0     24.5    0.0     24.51   0.0     
          24.52   0.0     24.53   0.0     24.54   0.0     24.55   0.0     
          24.56   0.0     24.57   0.0     24.58   0.0     24.59   0.0     
          24.6    0.0     24.61   0.0     24.62   0.0     24.63   0.0     
          24.64   0.0     24.65   0.0     24.66   0.0     24.67   0.0     
          24.68   0.0     24.69   0.0     24.7    0.0     24.71   0.0     
          24.72   0.0     24.73   0.0     24.74   0.0     24.75   0.0     
          24.76   0.0     24.77   0.0     24.78   0.0     24.79   0.0     
          24.8    0.0     24.81   0.0     24.82   0.0     24.83   0.0     
          24.84   0.0     24.85   0.0     24.86   0.0     24.87   0.0     
          24.88   0.0     24.89   0.0     24.9    0.0     24.91   0.0     
          24.92   0.0     24.93   0.0     24.94   0.0     24.95   0.0     
          24.96   0.0     24.97   0.0     24.98   0.0     24.99   0.0     
          25.0    0.0     25.01   0.0     25.02   0.0     25.03   0.0     
          25.04   0.0     25.05   0.0     25.06   0.0     25.07   0.0     
          25.08   0.0     25.09   0.0     25.1    0.0     25.11   0.0     
          25.12   0.0     25.13   0.0     25.14   0.0     25.15   0.0     
          25.16   0.0     25.17   0.0     25.18   0.0     25.19   0.0     
          25.2    0.0     25.21   0.0     25.22   0.0     25.23   0.0     
          25.24   0.0     25.25   0.0     25.26   0.0     25.27   0.0     
          25.28   0.0     25.29   0.0     25.3    0.0     25.31   0.0     
          25.32   0.0     25.33   0.0     25.34   0.0     25.35   0.0     
          25.36   0.0     25.37   0.0     25.38   0.0     25.39   0.0     
          25.4    0.0     25.41   0.0     25.42   0.0     25.43   0.0     
          25.44   0.0     25.45   0.0     25.46   0.0     25.47   0.0     
          25.48   0.0     25.49   0.0     25.5    0.0     25.51   0.0     
          25.52   0.0     25.53   0.0     25.54   0.0     25.55   0.0     
          25.56   0.0     25.57   0.0     25.58   0.0     25.59   0.0     
          25.6    0.0     25.61   0.0     25.62   0.0     25.63   0.0     
          25.64   0.0     25.65   0.0     25.66   0.0     25.67   0.0     
          25.68   0.0     25.69   0.0     25.7    0.0     25.71   0.0     
          25.72   0.0     25.73   0.0     25.74   0.0     25.75   0.0     
          25.76   0.0     25.77   0.0     25.78   0.0     25.79   0.0     
          25.8    0.0     25.81   0.0     25.82   0.0     25.83   0.0     
          25.84   0.0     25.85   0.0     25.86   0.0     25.87   0.0     
          25.88   0.0     25.89   0.0     25.9    0.0     25.91   0.0     
          25.92   0.0     25.93   0.0     25.94   0.0     25.95   0.0     
          25.96   0.0     25.97   0.0     25.98   0.0     25.99   0.0     
          26.0    0.0     26.01   0.0     26.02   0.0     26.03   0.0     
          26.04   0.0     26.05   0.0     26.06   0.0     26.07   0.0     
          26.08   0.0     26.09   0.0     26.1    0.0     26.11   0.0     
          26.12   0.0     26.13   0.0     26.14   0.0     26.15   0.0     
          26.16   0.0     26.17   0.0     26.18   0.0     26.19   0.0     
          26.2    0.0     26.21   0.0     26.22   0.0     26.23   0.0     
          26.24   0.0     26.25   0.0     26.26   0.0     26.27   0.0     
          26.28   0.0     26.29   0.0     26.3    0.0     26.31   0.0     
          26.32   0.0     26.33   0.0     26.34   0.0     26.35   0.0     
          26.36   0.0     26.37   0.0     26.38   0.0     26.39   0.0     
          26.4    0.0     26.41   0.0     26.42   0.0     26.43   0.0     
          26.44   0.0     26.45   0.0     26.46   0.0     26.47   0.0     
          26.48   0.0     26.49   0.0     26.5    0.0     26.51   0.0     
          26.52   0.0     26.53   0.0     26.54   0.0     26.55   0.0     
          26.56   0.0     26.57   0.0     26.58   0.0     26.59   0.0     
          26.6    0.0     26.61   0.0     26.62   0.0     26.63   0.0     
          26.64   0.0     26.65   0.0     26.66   0.0     26.67   0.0     
          26.68   0.0     26.69   0.0     26.7    0.0     26.71   0.0     
          26.72   0.0     26.73   0.0     26.74   0.0     26.75   0.0     
          26.76   0.0     26.77   0.0     26.78   0.0     26.79   0.0     
          26.8    0.0     26.81   0.0     26.82   0.0     26.83   0.0     
          26.84   0.0     26.85   0.0     26.86   0.0     26.87   0.0     
          26.88   0.0     26.89   0.0     26.9    0.0     26.91   0.0     
          26.92   0.0     26.93   0.0     26.94   0.0     26.95   0.0     
          26.96   0.0     26.97   0.0     26.98   0.0     26.99   0.0     
          27.0    0.0     27.01   0.0     27.02   0.0     27.03   0.0     
          27.04   0.0     27.05   0.0     27.06   0.0     27.07   0.0     
          27.08   0.0     27.09   0.0     27.1    0.0     27.11   0.0     
          27.12   0.0     27.13   0.0     27.14   0.0     27.15   0.0     
          27.16   0.0     27.17   0.0     27.18   0.0     27.19   0.0     
          27.2    0.0     27.21   0.0     27.22   0.0     27.23   0.0     
          27.24   0.0     27.25   0.0     27.26   0.0     27.27   0.0     
          27.28   0.0     27.29   0.0     27.3    0.0     27.31   0.0     
          27.32   0.0     27.33   0.0     27.34   0.0     27.35   0.0     
          27.36   0.0     27.37   0.0     27.38   0.0     27.39   0.0     
          27.4    0.0     27.41   0.0     27.42   0.0     27.43   0.0     
          27.44   0.0     27.45   0.0     27.46   0.0     27.47   0.0     
          27.48   0.0     27.49   0.0     27.5    0.0     27.51   0.0     
          27.52   0.0     27.53   0.0     27.54   0.0     27.55   0.0     
          27.56   0.0     27.57   0.0     27.58   0.0     27.59   0.0     
          27.6    0.0     27.61   0.0     27.62   0.0     27.63   0.0     
          27.64   0.0     27.65   0.0     27.66   0.0     27.67   0.0     
          27.68   0.0     27.69   0.0     27.7    0.0     27.71   0.0     
          27.72   0.0     27.73   0.0     27.74   0.0     27.75   0.0     
          27.76   0.0     27.77   0.0     27.78   0.0     27.79   0.0     
          27.8    0.0     27.81   0.0     27.82   0.0     27.83   0.0     
          27.84   0.0     27.85   0.0     27.86   0.0     27.87   0.0     
          27.88   0.0     27.89   0.0     27.9    0.0     27.91   0.0     
          27.92   0.0     27.93   0.0     27.94   0.0     27.95   0.0     
          27.96   0.0     27.97   0.0     27.98   0.0     27.99   0.0     
          28.0    0.0     28.01   0.0     28.02   0.0     28.03   0.0     
          28.04   0.0     28.05   0.0     28.06   0.0     28.07   0.0     
          28.08   0.0     28.09   0.0     28.1    0.0     28.11   0.0     
          28.12   0.0     28.13   0.0     28.14   0.0     28.15   0.0     
          28.16   0.0     28.17   0.0     28.18   0.0     28.19   0.0     
          28.2    0.0     28.21   0.0     28.22   0.0     28.23   0.0     
          28.24   0.0     28.25   0.0     28.26   0.0     28.27   0.0     
          28.28   0.0     28.29   0.0     28.3    0.0     28.31   0.0     
          28.32   0.0     28.33   0.0     28.34   0.0     28.35   0.0     
          28.36   0.0     28.37   0.0     28.38   0.0     28.39   0.0     
          28.4    0.0     28.41   0.0     28.42   0.0     28.43   0.0     
          28.44   0.0     28.45   0.0     28.46   0.0     28.47   0.0     
          28.48   0.0     28.49   0.0     28.5    0.0     28.51   0.0     
          28.52   0.0     28.53   0.0     28.54   0.0     28.55   0.0     
          28.56   0.0     28.57   0.0     28.58   0.0     28.59   0.0     
          28.6    0.0     28.61   0.0     28.62   0.0     28.63   0.0     
          28.64   0.0     28.65   0.0     28.66   0.0     28.67   0.0     
          28.68   0.0     28.69   0.0     28.7    0.0     28.71   0.0     
          28.72   0.0     28.73   0.0     28.74   0.0     28.75   0.0     
          28.76   0.0     28.77   0.0     28.78   0.0     28.79   0.0     
          28.8    0.0     28.81   0.0     28.82   0.0     28.83   0.0     
          28.84   0.0     28.85   0.0     28.86   0.0     28.87   0.0     
          28.88   0.0     28.89   0.0     28.9    0.0     28.91   0.0     
          28.92   0.0     28.93   0.0     28.94   0.0     28.95   0.0     
          28.96   0.0     28.97   0.0     28.98   0.0     28.99   0.0     
          29.0    0.0     29.01   0.0     29.02   0.0     29.03   0.0     
          29.04   0.0     29.05   0.0     29.06   0.0     29.07   0.0     
          29.08   0.0     29.09   0.0     29.1    0.0     29.11   0.0     
          29.12   0.0     29.13   0.0     29.14   0.0     29.15   0.0     
          29.16   0.0     29.17   0.0     29.18   0.0     29.19   0.0     
          29.2    0.0     29.21   0.0     29.22   0.0     29.23   0.0     
          29.24   0.0     29.25   0.0     29.26   0.0     29.27   0.0     
          29.28   0.0     29.29   0.0     29.3    0.0     29.31   0.0     
          29.32   0.0     29.33   0.0     29.34   0.0     29.35   0.0     
          29.36   0.0     29.37   0.0     29.38   0.0     29.39   0.0     
          29.4    0.0     29.41   0.0     29.42   0.0     29.43   0.0     
          29.44   0.0     29.45   0.0     29.46   0.0     29.47   0.0     
          29.48   0.0     29.49   0.0     29.5    0.0     29.51   0.0     
          29.52   0.0     29.53   0.0     29.54   0.0     29.55   0.0     
          29.56   0.0     29.57   0.0     29.58   0.0     29.59   0.0     
          29.6    0.0     29.61   0.0     29.62   0.0     29.63   0.0     
          29.64   0.0     29.65   0.0     29.66   0.0     29.67   0.0     
          29.68   0.0     29.69   0.0     29.7    0.0     29.71   0.0     
          29.72   0.0     29.73   0.0     29.74   0.0     29.75   0.0     
          29.76   0.0     29.77   0.0     29.78   0.0     29.79   0.0     
          29.8    0.0     29.81   0.0     29.82   0.0     29.83   0.0     
          29.84   0.0     29.85   0.0     29.86   0.0     29.87   0.0     
          29.88   0.0     29.89   0.0     29.9    0.0     29.91   0.0     
          29.92   0.0     29.93   0.0     29.94   0.0     29.95   0.0     
          29.96   0.0     29.97   0.0     29.98   0.0     29.99   0.0     
          30.0    0.0     ENDT    
#+end_src

#+begin_src org :tangle "./geometry/mkaero_dihedral.bdf" :mkdirp yes :noweb yes
  PARAM   MACH    <<python_parameters(output="mach")>>         
  MKAERO1 <<python_parameters(output="mach")>>
          1.E-9

#+end_src

#+begin_src org :tangle "./geometry/run_cao.bdf" :mkdirp yes :noweb yes
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ EXECUTIVE CONTROL								  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  assign OUTPUT4='../data_out/dihedral.op4',formatted,UNIT=11
  $ TIME 100 $(Max execution time)       
  $NASTRAN NLINES = 999999
  NASTRAN QUARTICDLM = 1
  SOL 146

  COMPILE FREQRS
  ALTER 'GUST.*CASES.*DLT.*FRL.*DIT.*QHJL'
  DIAGON(20)
  $                                                                            
  OUTPUT4 wj,,,,//0/11///8 $ 

  CEND


  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ CASE CONTROL									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  TITLE=Sailplane #                                 
  $SPC=  100001                                                            
  $MPC=  100001
  SPC = 2                  
  METHOD = 100
  $
  DISP(PLOT) = ALL
  $
  ECHO=NONE
  FREQ = 930
  TSTEP = 940  

  $
  DISP(PLOT) = ALL
  $
  RESVEC = NO
  ECHO=NONE
  SUBCASE  1       
  GUST  = 10      
  DLOAD = 1     

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ BULK   									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  BEGIN BULK
  PARAM,BAILOUT,0
  PARAM,GRDPNT,0                                                              
  PARAM,K6ROT,1.0
  PARAM,SNORM,20.0
  PARAM,POST,0
  $PARAM,MAXRATIO,1.0E07 $Default anyway
  $PARAM   AUTOSPC YES
  MDLPRM  MLTSPLIN 1 $Aero grids can be defined in multiple splines (dafault 0)
  PARAM   WTMASS  1.0
  PARAM   GUSTAERO -1     
  PARAM   Q       1. 
  $ TABDMP1 920     CRIT
  $         0.      0.015   8000.   0.015   ENDT    
  FREQ1   930     0.0     1.E-9   1   
  TSTEP   940     1       0.01    1            
  AERO           0      1.   7.271      1.
  DAREA   9999999   999000       3      0.          

  EIGRL,100,,,<<python_parameters(output="num_modes")>>
  SPC1           1  123456  999079
  SPCADD         2       1
  INCLUDE ../base.bdf
  INCLUDE ../dlm_model.bdf
  INCLUDE './dummy_gust.bdf'
  INCLUDE './mkaero_dihedral.bdf'
#+end_src

#+begin_src bash :tangle "./geometry/run.sh" :mkdirp yes :shebang  #!/usr/bin/zsh -i :results none
  cd geometry
  nastran run_cao.bdf
#+end_src

#+begin_src python :session py1  :results none
  import pyNastran.op4.op4 as op4

  dihedral = op4.read_op4("./data_out/dihedral.op4")
  np.save("./data_out/dihedral.npy", dihedral['WJ'][1].real)
#+end_src

* SOL 144

#+begin_src org :tangle "./SOL144/setup.bdf" :mkdirp yes :noweb yes
  $
  $--------------------------------------------------------------------------------
  $   AERODYNAMIC DOFS
  $--------------------------------------------------------------------------------
  $
  AESTAT  1       ANGLEA  
  AESTAT  2       SIDES  
  AESTAT  3       PITCH  
  AESTAT  4       ROLL  
  AESTAT  5       YAW  
  AESTAT  6       URDD1  
  AESTAT  7       URDD2  
  AESTAT  8       URDD3  
  AESTAT  9       URDD4  
  AESTAT  10      URDD5  
  AESTAT  11      URDD6  

  $AEROS                   4.163   44.8    146.6  
  AEROS,,,<<python_parameters(output="c_ref")>>,<<python_parameters(output="b_ref")>>,<<python_parameters(output="S_ref")>>,,1
  $
  $--------------------------------------------------------------------------------
  $   BOUNDARY CONDITIONS
  $--------------------------------------------------------------------------------
  $ SPCs
  $
  $--------------------------------------------------------------------------------
  $   h=0 ft - m=0.3
  $--------------------------------------------------------------------------------
  $
  $ TRIM    960     0.81    15762.81  URDD1   0.      URDD2   0.      1.
  $         URDD3   0.      URDD4   0.      URDD5   0.      URDD6   0.
  $         ROLL    0.      YAW     0.      SIDES   0.      PITCH   0.
  $         Flprn_r 0.      WTAil_r 0.      Elev_r  0.      ANGLEA  0.261799
  TRIM,960,<<python_parameters(output="mach")>>,<<python_parameters(output="q_inf")>>,URDD1,0.,URDD2,0.,1.
  ,URDD3,   0.,      URDD4,   0.,      URDD5,   0.,      URDD6,   0.,
  ,ROLL,    0.,      YAW,     0.,      SIDES,   0.,      PITCH,   0.,
  ,ANGLEA, <<python_parameters(output="alpha_sol144")>>

#+end_src

#+begin_src org :tangle "./SOL144/run_cao.bdf" :mkdirp yes :noweb yes
  NASTRAN QUARTICDLM=1
  SOL 144
  CEND

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ CASE CONTROL									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  TITLE=Sailplane #                                 
  $SPC=  100001                                                            
  $MPC=  100001
  SPC = 2                  
  $
  $
  TRIM = 960
  $LOAD = 2000
  $
  DISP = ALL
  FORCE = ALL
  AEROF = ALL
  MONITOR = ALL
  TRIMF = ALL
  OLOAD(CID) = ALL
  ECHO=NONE

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ BULK   									  $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  BEGIN BULK
  PARAM,BAILOUT,0
  PARAM,GRDPNT,0                                                              
  PARAM,K6ROT,1.0
  PARAM,SNORM,20.0
  PARAM,POST,0
  $PARAM,MAXRATIO,1.0E07 $Default anyway
  $PARAM   AUTOSPC YES
  MDLPRM  MLTSPLIN 1 $Aero grids can be defined in multiple splines (dafault 0)
  PARAM   WTMASS  1.0  
  PARAM   AUNITS  .1019716  $ 1/g  

  SPC1           1  123456  999079
  SPCADD         2       1
  INCLUDE ../base.bdf
  INCLUDE ../dlm_model.bdf
  INCLUDE './setup.bdf'

#+end_src

#+begin_src bash :tangle "./SOL144/run.sh" :mkdirp yes :shebang  #!/usr/bin/zsh -i :results none
  cd ./SOL144
  nastran run_cao.bdf
#+end_src
* SOL 146
#+begin_src python :session py1  :results none
  import feniax.unastran.gustgen as gustgen
  gust4nastran = gustgen.Gust4Nastran(h=0.,
                                      M=mach,
                                      U_inf_TAS=u_inf,
                                      Type='tas',
                                      chord=c_ref,
                                      N_step_freq=1000,
                                      F_max=10.,
                                      H=[li/2 for li in gust_lengths],
                                      Fg=1.,
                                      grid_DAREA=999079
                                      )
  gust4nastran.gust_family("./SOL146/gust_family.bdf", "./SOL146/gust_subcase.bdf")
  gust4nastran.gust_setup("./SOL146/gust_setup.bdf")
#+end_src

#+begin_src org :tangle "./SOL146/run_cao.bdf" :mkdirp yes :noweb yes

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ EXECUTIVE CONTROL								      $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  $ TIME 100 $(Max execution time)       
  $NASTRAN NLINES = 999999
  NASTRAN QUARTICDLM = 1
  SOL 146
  CEND
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ CASE CONTROL							              $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  SET 1 =999079,999000,999001,999002,999003,999004,999005,999006,
  999007,999008,999009,999010,999011,999012,999013,999014,
  999015,999016,999017,999018,999019,999020,999021,999022,
  999023,999024,999025,999026,999027,999028,999029,999030,
  999031,999032,999033,999034,999035,999036,999037,999038,
  999039,999040,999041,999042,999043,999044,999045,999046,
  999047,999048,999049,999050,999051,999052,999053,999054,
  999055,999056,999057,999058,999059,999060,999061,999062,
  999063,999064,999065,999066,999067,999068,999069,999070,
  999071,999072,999073,999074,999075,999076,999077
  TITLE=Sailplane #                                 
  SPC = 2                  
  $ DISP = ALL
  FORCE = ALL
  AEROF = ALL
  MONITOR = ALL
  ECHO=NONE
  METHOD = 910
  $SDAMP  = 920
  FREQ = 930
  TSTEP = 940  
  RESVEC = NO
  ECHO=NONE

  INCLUDE 'gust_subcase.bdf'

  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
  $ BULK   									      $
  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

  BEGIN BULK
  PARAM,BAILOUT,0
  PARAM,GRDPNT,0                                                              
  PARAM,K6ROT,1.0
  PARAM,SNORM,20.0
  PARAM,POST,-1
  $PARAM,MAXRATIO,1.0E07 $Default anyway
  $PARAM   AUTOSPC YES
  MDLPRM,MLTSPLIN,1 $Aero grids can be defined in multiple splines (dafault 0)
  PARAM,WTMASS,1.0  
  $PARAM   AUNITS  .1019716  $ 1/g
  PARAM,GUSTAERO,-1
  PARAM,OPPHIPA,1
  EIGR    910     LAN     0.      10.       
          MASS  
  SPC1           1  123456  999079
  SPCADD         2       1
  INCLUDE ../base.bdf
  INCLUDE ../dlm_model.bdf

  INCLUDE 'gust_setup.bdf'
  INCLUDE 'gust_family.bdf'

  ENDDATA


#+end_src

#+begin_src bash :tangle "./SOL146/run.sh" :mkdirp yes :shebang  #!/usr/bin/zsh -i :results none
  cd ./SOL146
  nastran run_cao.bdf
#+end_src

#+begin_src python :session py1  :results none
  import feniax.unastran.op2reader as op2reader
  op2model = op2reader.NastranReader("./SOL146/run_cao")
  op2model.readModel()
#+end_src

* VTK
#+begin_src python :session py1  :results none :noweb yes
  import meshio
  mesh = meshio.read("/media/acea/work/projects/FENIAX/examples/SailPlane/NASTRAN/SOL103/run_cao.bdf")
#+end_src

* Flutter analysis
