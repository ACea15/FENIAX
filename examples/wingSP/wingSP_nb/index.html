
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for aeroelastic library FENIAX.">
      
      
        <meta name="author" content="Alvaro Cea">
      
      
      
        <link rel="prev" href="../../SailPlane/sailplane_nb/">
      
      
        <link rel="next" href="../../SimoFS/main/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Wing nonlinear dynamics - FENIAX</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#wing-sail-plane" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="FENIAX" class="md-header__button md-logo" aria-label="FENIAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FENIAX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Wing nonlinear dynamics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ACea15/FENIAX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ACea15/FENIAX
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../getting_started/" class="md-tabs__link">
        
  
  
    
  
  Getting started

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../theory_intrinsic/" class="md-tabs__link">
          
  
  
    
  
  Theoretical background

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../JAX/" class="md-tabs__link">
          
  
  
    
  
  Software & Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../api/inputs/" class="md-tabs__link">
          
  
  
    
  
  Codebase

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="FENIAX" class="md-nav__button md-logo" aria-label="FENIAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FENIAX
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ACea15/FENIAX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ACea15/FENIAX
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SailPlane/sailplane_nb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sail Plane static response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Wing nonlinear dynamics
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Wing nonlinear dynamics
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Run cases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Postprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Postprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-nastran-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load Nastran data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structural-verification-of-a-representative-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Structural verification of a representative configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SimoFS/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Free flying shell structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../industrialAC/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Full aircraft (clamped) gust verification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ConcurrentLoads/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concurrent loads
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Theoretical background
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Theoretical background
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../theory_intrinsic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intrinsic modal description
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publications
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Software & Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Software & Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../JAX/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JAX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UML/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UML description
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Codebase
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Codebase
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/drivers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Drivers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/modes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/couplings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nonlinear couplings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/simulations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Systems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/sollibs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solvers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Equations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/deformations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deformations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Run cases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Postprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Postprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-nastran-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load Nastran data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structural-verification-of-a-representative-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Structural verification of a representative configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="wing-sail-plane">Wing Sail Plane<a class="headerlink" href="#wing-sail-plane" title="Permanent link">¤</a></h1>
<p>Verifying the nonlinear structural dynamics on a clamped configuration.</p>
<h2 id="load-modules">Load modules<a class="headerlink" href="#load-modules" title="Permanent link">¤</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.express</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">px</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyNastran.op4.op4</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">op4</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pdb</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="n">REMOVE_RESULTS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#   for root, dirs, files in os.walk(&#39;/path/to/folder&#39;):</span>
<span class="c1">#       for f in files:</span>
<span class="c1">#           os.unlink(os.path.join(root, f))</span>
<span class="c1">#       for d in dirs:</span>
<span class="c1">#           shutil.rmtree(os.path.join(root, d))</span>
<span class="c1"># </span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;results&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./figs&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./figs&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">REMOVE_RESULTS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***** creating results folder ******&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
</code></pre></div>
<div id="PYTHONMODULES" class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.preprocessor.configuration</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">configuration</span>  <span class="c1"># import Config, dump_to_yaml</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feniax.preprocessor.inputs</span><span class="w"> </span><span class="kn">import</span> <span class="n">Inputs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.feniax_main</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.preprocessor.solution</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">solution</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.unastran.op2reader</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">op2reader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>
</code></pre></div>
<h2 id="run-cases">Run cases<a class="headerlink" href="#run-cases" title="Permanent link">¤</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">TIMES_DICT</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">SOL</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">clear_caches</span><span class="p">()</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">config</span> <span class="o">=</span>  <span class="n">configuration</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">feniax_main</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">input_obj</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">TIMES_DICT</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>      
    <span class="n">SOL</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span>
    <span class="n">CONFIG</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>

<span class="k">def</span><span class="w"> </span><span class="nf">save_times</span><span class="p">():</span>
    <span class="n">pd_times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">TIMES_DICT</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                            <span class="n">index</span><span class="o">=</span><span class="n">TIMES_DICT</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">pd_times</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;./run_times.csv&quot;</span><span class="p">)</span>
</code></pre></div>
<div id="wingSP" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
</code></pre></div>
<div id="wingSP_dts" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
</code></pre></div>
<p>WSP1</p>
<div id="WSP1" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<p>WSP2</p>
<div id="WSP2" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<p>WSP3</p>
<div id="WSP3" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<p>WSP4</p>
<div id="WSP4" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<p>WSP4alpha05</p>
<div id="WSP4alpha05" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<p>WSP4alpha15</p>
<div id="WSP4alpha15" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<p>WSP5</p>
<div id="WSP5" class="highlight"><pre><span></span><code><span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/wingSP&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGrid&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wingSP_folder</span><span class="si">}</span><span class="s1">/FEM/&#39;</span><span class="p">)</span>
<span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;eigenvals.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;inputs&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">15.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span> <span class="c1">#&quot;rk4&quot;)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_points</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                              <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">follower_interpolation</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">-</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                                                     <span class="p">[</span><span class="mf">0.05</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="mf">6e5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
                                                     <span class="p">]</span>
<span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dts</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span> <span class="n">eigenvals</span><span class="p">[</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h2 id="postprocessing">Postprocessing<a class="headerlink" href="#postprocessing" title="Permanent link">¤</a></h2>
<h3 id="plotting-functions">Plotting functions<a class="headerlink" href="#plotting-functions" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Format for figures: </span><span class="si">{</span><span class="n">figfmt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">figformat</span><span class="o">=</span><span class="n">figfmt</span><span class="p">,</span> <span class="n">update_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">inner_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">update_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">update_layout</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="n">figname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;figs/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">figformat</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../</span><span class="si">{</span><span class="n">figname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">figname</span>
        <span class="k">return</span> <span class="n">inner</span>
    <span class="k">return</span> <span class="n">inner_decorator</span>


<span class="k">def</span><span class="w"> </span><span class="nf">fig_background</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># if fig.data[0].showlegend is None:</span>
        <span class="c1">#     showlegend = True</span>
        <span class="c1"># else:</span>
        <span class="c1">#     showlegend = fig.data[0].showlegend</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
                       <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">ticks</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
                       <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="c1">#zeroline=True,</span>
        <span class="c1">#zerolinewidth=2,</span>
            <span class="c1">#zerolinecolor=&#39;LightPink&#39;,</span>
                       <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">ticks</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
                       <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                          <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">),</span>
                          <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#showlegend,</span>
                          <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                              <span class="n">autoexpand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">b</span><span class="o">=</span><span class="mi">0</span>
                          <span class="p">))</span>
        <span class="k">return</span> <span class="n">fig</span>
    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">subplots_wtips2</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="n">fig1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig3</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig3</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">fig2</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.135</span><span class="p">,</span> <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                        <span class="c1"># specs=[[{&quot;colspan&quot;: 2}, None],</span>
                        <span class="c1">#       [{}, {}]]</span>
                        <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f3i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f3i</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f1i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">f1inew</span> <span class="o">=</span> <span class="n">f1i</span>
        <span class="n">f1inew</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>          
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f1inew</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f2i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">f2inew</span> <span class="o">=</span> <span class="n">f2i</span>
        <span class="n">f2inew</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>          
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f2inew</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                      <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">),</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#showlegend,</span>
                      <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                          <span class="n">autoexpand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                          <span class="n">b</span><span class="o">=</span><span class="mi">0</span>
                          <span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.81</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1">#fig.update_layout(showlegend=False,row=2, col=1)</span>
    <span class="c1"># fig.update_layout(showlegend=False,row=2, col=2)</span>
    <span class="c1">#fig.update_layout(fig1.layout)</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="nd">@fig_background</span>
<span class="k">def</span><span class="w"> </span><span class="nf">wsp_wingtip</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nast_load</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">28.8</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
    <span class="n">dash</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dash&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="s1">&#39;dashdot&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sol_list</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                      <span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                      <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">modes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="n">dash</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">])</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">modes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>              
    <span class="k">if</span> <span class="n">nast_load</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">t_wsp</span><span class="p">[</span><span class="n">nast_load</span><span class="p">],</span> <span class="n">u_wsp</span><span class="p">[</span><span class="n">nast_load</span><span class="p">,:,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">dim</span><span class="p">]</span><span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;FullFE-NL&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                             <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">)</span>
                                   <span class="p">))</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">t_wspl</span><span class="p">[</span><span class="n">nast_load</span><span class="p">],</span> <span class="n">u_wspl</span><span class="p">[</span><span class="n">nast_load</span><span class="p">,:,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">dim</span><span class="p">]</span><span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;FullFE-Lin&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
                                             <span class="c1">#dash=&quot;dash&quot;</span>
                                             <span class="p">)</span>
                                   <span class="p">))</span>
    <span class="n">dim_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Large u_</span><span class="si">%s</span><span class="s1"> / l$&#39;</span><span class="o">%</span><span class="n">dim_dict</span><span class="p">[</span><span class="n">dim</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\large time \; [s]$&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large u_</span><span class="si">%s</span><span class="s1"> / l$&#39;</span><span class="o">%</span><span class="n">dim_dict</span><span class="p">[</span><span class="n">dim</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\large time \; [s]$&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="nd">@fig_background</span>
<span class="k">def</span><span class="w"> </span><span class="nf">wsp_rootload</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span>
                 <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;1.&#39;</span><span class="p">,</span> <span class="s1">&#39;1.5&#39;</span><span class="p">],</span> <span class="n">nodei</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
    <span class="n">dash</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dash&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">,</span> <span class="s1">&#39;dashdot&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sol_list</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                      <span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">X2</span><span class="p">,</span>
                                      <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="n">nodei</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                               <span class="n">dash</span><span class="o">=</span><span class="n">dash</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">])</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                                <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                     <span class="p">),</span>
                                <span class="nb">dict</span><span class="p">())</span>              
    <span class="n">dim_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">}</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large f_</span><span class="si">%s</span><span class="s1"> \; [MN/m]$&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">dim</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\large time \; [s]$&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="k">def</span><span class="w"> </span><span class="nf">subplots_wsp</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nast_load</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">fig1</span> <span class="o">=</span> <span class="n">wsp_wingtip</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">nast_load</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">wsp_wingtip</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">nast_load</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">fig3</span> <span class="o">=</span> <span class="n">wsp_wingtip</span><span class="p">(</span><span class="n">sol_list</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">nast_load</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vertical_spacing</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                        <span class="n">specs</span><span class="o">=</span><span class="p">[[{</span><span class="s2">&quot;colspan&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="kc">None</span><span class="p">],</span>
                               <span class="p">[{},</span> <span class="p">{}]])</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f3i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f3i</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f1i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">f1inew</span> <span class="o">=</span> <span class="n">f1i</span>
        <span class="n">f1inew</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>          
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f1inew</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f2i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">f2inew</span> <span class="o">=</span> <span class="n">f2i</span>
        <span class="n">f2inew</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>          
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f2inew</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span>
                      <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                      <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">),</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#showlegend,</span>
                      <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                          <span class="n">autoexpand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                          <span class="n">b</span><span class="o">=</span><span class="mi">0</span>
                          <span class="p">))</span>
    <span class="c1">#fig.update_layout(showlegend=False,row=2, col=1)</span>
    <span class="c1"># fig.update_layout(showlegend=False,row=2, col=2)</span>
    <span class="c1">#fig.update_layout(fig1.layout)</span>
    <span class="k">return</span> <span class="n">fig</span>


<span class="k">def</span><span class="w"> </span><span class="nf">fn_wspError</span><span class="p">(</span><span class="n">sol_list</span><span class="p">):</span>
    <span class="n">error_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sol_list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                          <span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                          <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">di</span><span class="p">))</span>
            <span class="n">yinterp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_wsp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">ynastran</span> <span class="o">=</span> <span class="n">u_wsp</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">di</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">((</span><span class="n">yinterp</span><span class="p">[</span><span class="mi">1</span><span class="p">,:</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">ynastran</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span> <span class="o">/</span> <span class="n">ynastran</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ynastran</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>
            <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">di</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">error_dict</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">error</span>

    <span class="k">return</span> <span class="n">error_dict</span>

<span class="nd">@fig_background</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fn_wspPloterror</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>

    <span class="n">loads</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">530</span><span class="p">]</span>
    <span class="n">num_modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
    <span class="n">ex1</span> <span class="o">=</span> <span class="p">[</span><span class="n">error</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">x0&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
    <span class="n">ex2</span> <span class="o">=</span> <span class="p">[</span><span class="n">error</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">x1&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
    <span class="n">ex3</span> <span class="o">=</span> <span class="p">[</span><span class="n">error</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;M</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">x2&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">num_modes</span><span class="p">,</span> <span class="n">ex1</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error - x1&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">num_modes</span><span class="p">,</span> <span class="n">ex2</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error - x2&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">num_modes</span><span class="p">,</span> <span class="n">ex3</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error - x3&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">tickformat</span><span class="o">=</span> <span class="s1">&#39;.0e&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="nd">@fig_background</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fn_wspPloterror3D</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
                                   <span class="p">),</span>
                              <span class="nb">dict</span><span class="p">())</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">tickformat</span><span class="o">=</span> <span class="s1">&#39;.0e&#39;</span><span class="p">,</span> <span class="n">nticks</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
                      <span class="c1">#height=700,</span>
                      <span class="n">xaxis_title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Large time [s]$&#39;</span><span class="p">,</span>
                      <span class="n">yaxis_title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Large \epsilon$&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div>
<h3 id="load-nastran-data">Load Nastran data<a class="headerlink" href="#load-nastran-data" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.preprocessor.configuration</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">configuration</span>  <span class="c1"># import Config, dump_to_yaml</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">feniax.preprocessor.inputs</span><span class="w"> </span><span class="kn">import</span> <span class="n">Inputs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.feniax_main</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.preprocessor.solution</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">solution</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">feniax.unastran.op2reader</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">op2reader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>

<span class="n">examples_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../../../../examples&quot;</span><span class="p">)</span>

<span class="c1">####### wingSP ###########</span>
<span class="n">wingSP_folder</span> <span class="o">=</span> <span class="n">examples_path</span> <span class="o">/</span> <span class="s2">&quot;wingSP&quot;</span>
<span class="n">nastran_path</span> <span class="o">=</span> <span class="n">wingSP_folder</span> <span class="o">/</span> <span class="s2">&quot;NASTRAN/&quot;</span>
<span class="n">nas_wspl</span> <span class="o">=</span> <span class="n">op2reader</span><span class="o">.</span><span class="n">NastranReader</span><span class="p">(</span><span class="n">op2name</span><span class="o">=</span><span class="p">(</span><span class="n">nastran_path</span> <span class="o">/</span> <span class="s2">&quot;wing_109d.op2&quot;</span><span class="p">),</span>
                                   <span class="n">bdfname</span><span class="o">=</span><span class="p">(</span><span class="n">nastran_path</span> <span class="o">/</span> <span class="s2">&quot;wing_109b.bdf&quot;</span><span class="p">))</span>
<span class="n">nas_wspl</span><span class="o">.</span><span class="n">readModel</span><span class="p">()</span>
<span class="n">t_wspl</span><span class="p">,</span> <span class="n">u_wspl</span> <span class="o">=</span> <span class="n">nas_wspl</span><span class="o">.</span><span class="n">displacements</span><span class="p">()</span>  
<span class="c1"># ###</span>
<span class="n">nas_wsp</span> <span class="o">=</span> <span class="n">op2reader</span><span class="o">.</span><span class="n">NastranReader</span><span class="p">(</span><span class="n">op2name</span><span class="o">=</span><span class="p">(</span><span class="n">nastran_path</span> <span class="o">/</span> <span class="s2">&quot;wing400d.op2&quot;</span><span class="p">),</span>
                                   <span class="n">bdfname</span><span class="o">=</span><span class="p">(</span><span class="n">nastran_path</span> <span class="o">/</span> <span class="s2">&quot;wing_109b.bdf&quot;</span><span class="p">))</span>
<span class="n">nas_wsp</span><span class="o">.</span><span class="n">readModel</span><span class="p">()</span>
<span class="n">t_wsp</span><span class="p">,</span> <span class="n">u_wsp</span> <span class="o">=</span> <span class="n">nas_wsp</span><span class="o">.</span><span class="n">displacements</span><span class="p">()</span>
<span class="n">wsp_error3d</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">examples_path</span><span class="o">/</span> <span class="s2">&quot;wingSP/wsp_err.npy&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="structural-verification-of-a-representative-configuration">Structural verification of a representative configuration<a class="headerlink" href="#structural-verification-of-a-representative-configuration" title="Permanent link">¤</a></h3>
<ol>
<li>
<p>Large-amplitude nonlinear dynamics</p>
<p>This test case demonstrates the accuracy of the NMROM approach for
dynamic geometrically-nonlinear calculations. The right wing of Fig.
is considered and dynamic nonlinear simulations are carried out and
compared to commercial solutions of the full FE model. A force is
applied at the wing tip with a triangular loading profile, followed
by a sudden release of the applied force to heavily excite the wing.
The force profile is given in Fig. <a href="#fig:ramping_load">1</a>. The
applied force is then
$f_{tip} = \alpha \textup{\pmb{f}}<em max="max">{max} f(0.05, 4)$ with
$\textup{\pmb{f}}</em> = [-2\times 10^5, 0., 6\times 10^5]$ where
$\alpha$ has been set to $1$.</p>
<p><div class="highlight"><pre><span></span><code>#+name: fig:ramping_load
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+caption: Ramping load profile for dynamic simulation of representative wing
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+attr_latex: :width 0.6\textwidth
</code></pre></div>
<a href="../figs_ext/ramping_load.pdf">file:./figs_ext/ramping_load.pdf</a> The
dynamic response is presented in Fig. <a href="#fig:wsp_3d">1</a>, where
results have been normalised with the wing semi-span ($l=28.8$ m).
As expected, linear analysis over-predicts vertical displacements
and does not capture displacements in the $x$ and $y$ directions.
NMROMs were built with 5, 15, 30, 50 and 100 modes. A Runge-Kutta
four is used to march the equation in time with time steps
corresponding to the inverse of the largest eigenvalue in the NMROM,
i.e. $\Delta t = [27.34, 6.62, 2.49, 1.27, 0.575] \times 10^{-3}$ s.</p>
<div id="WSPsubplots" class="highlight"><pre><span></span><code><span class="n">sol_wsp</span><span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./WSP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span> <span class="c1">#range(1,6)]</span>
<span class="c1"># fig, figname = fig_out(name)(wsp_wingtip)(sol_wsp, dim=0, labels=None, nast_load=0)</span>
<span class="c1">#fig = subplots_wsp(sol_wsp, labels=None, nast_load=0)</span>
<span class="c1">#figname</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">update_layout</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9385</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span> <span class="mi">10</span><span class="p">))))(</span><span class="n">subplots_wtips2</span><span class="p">)(</span><span class="n">wsp_wingtip</span><span class="p">,</span> <span class="n">sol_wsp</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nast_load</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">modes</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">50</span><span class="p">])</span>
<span class="n">figname</span>
</code></pre></div>
<p><img alt="Span-normalised wing-tip displacements in the response to an
initially ramped load" id="fig:wsp_3d" src="../figs/WSPsubplots.png" /></p>
<p>As in the previous example, the 3D shape of the model is retrieved
and compared against the full nonlinear dynamic solution, as
illustrated in Fig. <a href="#wsp_3d">2</a> (Nastran solution in yellow and
NMROM with 50 modes in blue). The times at positive and negative
peaks are displayed. Even though a wing of such characteristics
would never undergo in practice this level of deformations, these
results further support the viability of the methodology to solve
highly geometrically nonlinear dynamics, on complex models and with
minimal computational effort.</p>
<p><img alt="Snapshots of wing 3D dynamic response comparing NMROM (blue) and
NLFEM3D (yellow)" id="wsp_3d" src="../figs_ext/WSP_3D-front.png" /></p>
<p>Next we look at the differences of the dynamic simulations with the
same metric employed above that now evolves in time. Integration
errors accumulate and discrepancies grow with time but still remain
small. In fact the differences between MSC Nastran and our dynamic
solvers are comparable to the static example with the highest load
(around the $5\times 10^{-5}$ mark). Both cases displaying maximum
deformations around 25\% of the wing semi-span.</p>
<div id="WSP_error" class="highlight"><pre><span></span><code><span class="n">wsp_error</span> <span class="o">=</span> <span class="n">fn_wspError</span><span class="p">(</span><span class="n">sol_wsp</span><span class="p">)</span>
<span class="n">wsp_error_time</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">update_layout</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                              <span class="n">autoexpand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">r</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                              <span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">)))(</span><span class="n">fn_wspPloterror3D</span><span class="p">)(</span><span class="n">wsp_error_time</span><span class="p">,</span><span class="n">wsp_error3d</span><span class="p">)</span>
<span class="n">figname</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code>#+name: WSP_error
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+caption: $\ell^2$ norm per node differences between full FE nonlinear solution and NMROM with 50 modes
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+attr_latex: :width 0.7\textwidth
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+results: WSP_error
</code></pre></div>
<a href="figs/WSP_error.pdf">file:figs/WSP_error.pdf</a></p>
<p>An impressive reduction of computational time is achieved by our
solvers as highlighted in Table <a href="#table:WSP_times">1</a>. The nonlinear
response of the full model took 1 hour 22 minutes, which is over two
orders of magnitude slower than the NMROM with 50 modes resolution,
which proved very accurate. The significant increase in
computational effort when moving from a solution with 50 modes to
100 modes is due to various factors: vectorised operations are
limited and the quadratic nonlinearities ultimately lead to
O($N_m^3$) algorithms; the time-step needs to be decreased for the
Runge-Kutta integration to remain stable; the additional overheads
that come with saving and moving larger tensors, from the modal
shapes, the cubic modal couplings, to the system states (note times
shown account for all the steps from start to end of the simulation,
including saving all the data for postprocessing).</p>
<div id="WSP_times" class="highlight"><pre><span></span><code><span class="n">dfruns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./run_times.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dfruns</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;WSP</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mi">22</span><span class="o">*</span><span class="mi">60</span><span class="p">]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">33.6</span><span class="p">]</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NMROM (modes: 5, 15, 30, 50, 100)&quot;</span><span class="p">]</span>
<span class="n">header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;NASTRAN 400&quot;</span><span class="p">]</span>
<span class="n">header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;NASTRAN 109&quot;</span><span class="p">]</span>
<span class="c1"># df_sp = pd.DataFrame(dict(times=TIMES_DICT.values()),</span>
<span class="c1">#                         index=TIMES_DICT.keys())</span>

<span class="c1"># df_ = results_df[&#39;shift_conm2sLM25&#39;]</span>
<span class="c1"># df_ = df_.rename(columns={&quot;xlabel&quot;: &quot;%Chord&quot;})</span>
<span class="n">tabulate</span><span class="p">([</span><span class="n">values</span><span class="p">],</span> <span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;orgtbl&#39;</span><span class="p">)</span>
</code></pre></div>
<pre><code>           NMROM (modes: 5, 15, 30, 50, 100)   NASTRAN 400   NASTRAN 109
</code></pre>
<hr />
<dl>
<dt>Time <script type="math/tex; mode=display">s</script>   2.79, 2.92, 4.85, 12.14, 155.3      4920          33.6</dt>
<dd>
<p>Computational times representative wing dynamic solution</p>
</dd>
</dl>
</li>
<li>
<p>Differentiation of dynamic response</p>
<p>We move now to a novel feature of this work, i.e. the ability to
compute gradients via automatic differentiation in geometrically
nonlinear dynamic problems. The maximum root loads occurring in a
wing subjected to dynamic loads is a good test case as it can be a
critical metric in sizing the aircraft wings, especially high-aspect
ratio ones. Thus we look at the variation of the maximum z-component
of the vertical internal forces as a function of $\alpha$ in the
loading profile of Fig. <a href="#fig:ramping_load">1</a>. Effectively, the
slope of the loading increases with $\alpha$. Table
<a href="#table:AD_WSP">2</a> shows the derivatives computed using FD with an
epsilon of $10^{-4}$ and AD in reverse-mode on the example with 50
modes resolution. In this case the FD needed tweaking of epsilon
while application of AD was straight forward with no need for
checkpoints and took around three times the speed of a single
calculation.</p>
<p>$\alpha$   $f(\alpha)$ <script type="math/tex; mode=display">KN/m</script>   $f'(\alpha)$ (AD)   $f'(\alpha)$ (FD)</p>
<hr />
<dl>
<dt>0.5        1706.7                 3587.71             3587.77</dt>
<dt>  1.0        3459.9                 3735.26             3735.11</dt>
<dt>  1.5        5398.7                 3957.81             3958.31</dt>
<dd>
<p>AD verification structural dynamic problem</p>
</dd>
</dl>
<p>It is worth noting the high frequency dynamics excited after the
ramping load is suddenly released. In fact in the $z$-component of
the wing-tip evolution in Fig. <a href="#fig:wsp_adz">3</a> we can see a
maximum tip displacement of 4.36 m, 7.91 m and 10.83 m, for
$\alpha = 0.5, 1, 1.5$ i.e smaller than the proportional linear
response. On the other hand, in Fig. <a href="#fig:wsp_adx2">4</a> the
evolution of the root loads show a response with much higher
frequencies and the maximum occurs in the free dynamical response of
the wing, which is higher as we increase $\alpha$.</p>
<div id="WSP_adz" class="highlight"><pre><span></span><code><span class="n">sol_wspz</span><span class="o">=</span> <span class="p">[</span><span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./WSP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;4alpha05&quot;</span><span class="p">,</span>
                                                          <span class="s2">&quot;4&quot;</span><span class="p">,</span>
                                                          <span class="s2">&quot;4alpha15&quot;</span><span class="p">]]</span> <span class="c1">#range(1,6)]</span>
<span class="c1"># fig, figname = fig_out(name)(wsp_wingtip)(sol_wsp, dim=0, labels=None, nast_load=0)</span>
<span class="c1">#fig = subplots_wsp(sol_wsp, labels=None, nast_load=0)</span>
<span class="c1">#figname</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">update_layout</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span> <span class="mi">16</span><span class="p">))))(</span><span class="n">wsp_wingtip</span><span class="p">)(</span><span class="n">sol_wspz</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">modes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;1.5&quot;</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="kc">None</span><span class="p">])</span>
<span class="n">figname</span>
</code></pre></div>
<p><img alt="Span-normalised wing-tip $z$-displacement for load profiles with
$\alpha = 0.5, 1, 1.5$" id="fig:wsp_adz" src="figs/WSP_adz.png" /></p>
<div id="WSP_adx2" class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">update_layout</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.941</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span> <span class="mi">16</span><span class="p">))))(</span><span class="n">wsp_rootload</span><span class="p">)(</span><span class="n">sol_wspz</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">figname</span>
</code></pre></div>
<p><img alt="Wing root loads, vertical force" id="fig:wsp_adx2" src="figs/WSP_adx2.png" /></p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../SailPlane/sailplane_nb/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Sail Plane static response">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Sail Plane static response
              </div>
            </div>
          </a>
        
        
          
          <a href="../../SimoFS/main/" class="md-footer__link md-footer__link--next" aria-label="Next: Free flying shell structure">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Free flying shell structure
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>