
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for aeroelastic library FENIAX.">
      
      
        <meta name="author" content="Alvaro Cea">
      
      
      
        <link rel="prev" href="../../wingSP/wingSP_nb/">
      
      
        <link rel="next" href="../../ConcurrentLoads/main/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Full aircraft (clamped) gust verification - FENIAX</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#industrialac-clamped" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="FENIAX" class="md-header__button md-logo" aria-label="FENIAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FENIAX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Full aircraft (clamped) gust verification
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ACea15/FENIAX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ACea15/FENIAX
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../getting_started/" class="md-tabs__link">
        
  
    
  
  Getting started

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../theory_intrinsic/" class="md-tabs__link">
          
  
    
  
  Theoretical background

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../JAX/" class="md-tabs__link">
          
  
    
  
  Software & Architecture

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../api/inputs/" class="md-tabs__link">
          
  
    
  
  Codebase

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="FENIAX" class="md-nav__button md-logo" aria-label="FENIAX" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FENIAX
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ACea15/FENIAX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ACea15/FENIAX
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SailPlane/sailplane_nb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sail Plane static response
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wingSP/wingSP_nb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wing nonlinear dynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Full aircraft (clamped) gust verification
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Full aircraft (clamped) gust verification
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Run cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#industrialac" class="md-nav__link">
    <span class="md-ellipsis">
      IndustrialAC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac2" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac3" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac4" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac5" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac6" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac7" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC7
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac8" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC8
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Postprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Postprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-nastran-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load Nastran data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aeroelastic-dynamic-loads-on-an-industrial-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Aeroelastic dynamic loads on an industrial configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ConcurrentLoads/main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concurrent loads
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theoretical background
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Theoretical background
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../theory_intrinsic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intrinsic modal description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publications
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Software & Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Software & Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../JAX/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../algorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Algorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../UML/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UML description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../postprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postprocessing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codebase
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Codebase
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/inputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inputs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/drivers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drivers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/couplings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nonlinear couplings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/simulations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/sollibs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solvers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/equations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/deformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deformations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Load modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Run cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#industrialac" class="md-nav__link">
    <span class="md-ellipsis">
      IndustrialAC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac2" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac3" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac4" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac5" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac6" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac7" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC7
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industrialac8" class="md-nav__link">
    <span class="md-ellipsis">
      industrialAC8
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Postprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Postprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-nastran-data" class="md-nav__link">
    <span class="md-ellipsis">
      Load Nastran data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aeroelastic-dynamic-loads-on-an-industrial-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Aeroelastic dynamic loads on an industrial configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="industrialac-clamped">IndustrialAC (clamped)<a class="headerlink" href="#industrialac-clamped" title="Permanent link">¤</a></h1>
<p>Verifying the nonlinear structural dynamics on a clamped configuration.</p>
<h2 id="load-modules">Load modules<a class="headerlink" href="#load-modules" title="Permanent link">¤</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pyNastran.op4.op4</span> <span class="k">as</span> <span class="nn">op4</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="n">REMOVE_RESULTS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#   for root, dirs, files in os.walk(&#39;/path/to/folder&#39;):</span>
<span class="c1">#       for f in files:</span>
<span class="c1">#           os.unlink(os.path.join(root, f))</span>
<span class="c1">#       for d in dirs:</span>
<span class="c1">#           shutil.rmtree(os.path.join(root, d))</span>
<span class="c1"># </span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;results&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./figs&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./figs&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">REMOVE_RESULTS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***** creating results folder ******&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;./results&quot;</span><span class="p">)</span>
</code></pre></div>
<div id="PYTHONMODULES" class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">feniax.preprocessor.configuration</span> <span class="k">as</span> <span class="nn">configuration</span>  <span class="c1"># import Config, dump_to_yaml</span>
<span class="kn">from</span> <span class="nn">feniax.preprocessor.inputs</span> <span class="kn">import</span> <span class="n">Inputs</span>
<span class="kn">import</span> <span class="nn">feniax.feniax_main</span>
<span class="kn">import</span> <span class="nn">feniax.preprocessor.solution</span> <span class="k">as</span> <span class="nn">solution</span>
<span class="kn">import</span> <span class="nn">feniax.unastran.op2reader</span> <span class="k">as</span> <span class="nn">op2reader</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
</code></pre></div>
<h2 id="run-cases">Run cases<a class="headerlink" href="#run-cases" title="Permanent link">¤</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="n">TIMES_DICT</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">SOL</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">clear_caches</span><span class="p">()</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">config</span> <span class="o">=</span>  <span class="n">configuration</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">feniax_main</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">input_obj</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">TIMES_DICT</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>      
    <span class="n">SOL</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span>
    <span class="n">CONFIG</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>

<span class="k">def</span> <span class="nf">save_times</span><span class="p">():</span>
    <span class="n">pd_times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">TIMES_DICT</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                            <span class="n">index</span><span class="o">=</span><span class="n">TIMES_DICT</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">pd_times</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;./run_times.csv&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>WARNING: private model, not available open source</strong></p>
<p>Gust lengths and corresponding gust velocities that have been run here
and elsewhere. L~g~ 18.0,67.0,116.0,165.0,214 V0~g~
11.3047276743,14.0732311562,15.4214195361,16.3541764073,17.0785232867</p>
<p>Index   Gust length <script type="math/tex; mode=display">m</script>   Gust intensity   Intensity constant   u~inf~ <script type="math/tex; mode=display">m/s</script>   rho~inf~ <script type="math/tex; mode=display">Kg/m^3008^</script>   Mach</p>
<hr />
<dl>
<dt>1       67                  14.0732311562    0.01                 200              1.225                     0.81</dt>
<dt>  2       67                  14.0732311562    2                    200              1.225                     0.81</dt>
<dt>  3       165.               16.3541764073    0.01                 200              1.225                     0.81</dt>
<dt>  4       165.               16.3541764073    2                    200              1.225                     0.81</dt>
<dt>  5       67                  14.0732311562    0.01                 200              1.225                     0.</dt>
<dt>  6       67                  14.0732311562    2                    200              1.225                     0.</dt>
<dt>  7       165.               16.3541764073    0.01                 200              1.225                     0.</dt>
<dt>  8       165.               16.3541764073    2                    200              1.225                     0.</dt>
<dd>
<p>Table with various gusts on the IndustrialAC that have been run in this work
  or in the past</p>
</dd>
</dl>
<div id="industrialAC" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
</code></pre></div>
<h3 id="industrialac">IndustrialAC<a class="headerlink" href="#industrialac" title="Permanent link">¤</a></h3>
<div id="IndustrialAC" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;runge_kutta&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;rk4&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">14.0732311562</span><span class="o">*</span><span class="mf">0.01</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">67.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="industrialac2">industrialAC2<a class="headerlink" href="#industrialac2" title="Permanent link">¤</a></h3>
<div id="industrialAC2" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;runge_kutta&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;rk4&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">16.3541764073</span> <span class="o">*</span> <span class="mf">0.01</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">165.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="industrialac3">industrialAC3<a class="headerlink" href="#industrialac3" title="Permanent link">¤</a></h3>
<div id="industrialAC3" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;runge_kutta&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;rk4&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">14.0732311562</span><span class="o">*</span><span class="mi">2</span> <span class="c1">#11.304727674272842/10000</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">67.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="industrialac4">industrialAC4<a class="headerlink" href="#industrialac4" title="Permanent link">¤</a></h3>
<div id="industrialAC4" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;runge_kutta&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;rk4&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">16.3541764073</span><span class="o">*</span><span class="mi">2</span> <span class="c1">#11.304727674272842/10000</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">165.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="industrialac5">industrialAC5<a class="headerlink" href="#industrialac5" title="Permanent link">¤</a></h3>
<div id="industrialAC5" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Dopri5&quot;</span><span class="p">,</span><span class="c1">#&quot;Kvaerno3&quot;,</span>
                                         <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">14.0732311562</span><span class="o">*</span><span class="mi">2</span> <span class="c1">#11.304727674272842/10000</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">67.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="industrialac6">industrialAC6<a class="headerlink" href="#industrialac6" title="Permanent link">¤</a></h3>
<div id="industrialAC6" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">501</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;runge_kutta&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;rk4&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">14.0732311562</span><span class="o">*</span><span class="mi">2</span> <span class="c1">#11.304727674272842/10000</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">67.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="industrialac7">industrialAC7<a class="headerlink" href="#industrialac7" title="Permanent link">¤</a></h3>
<div id="industrialAC7" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">1501</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;ImplicitEuler&quot;</span><span class="p">,</span><span class="c1">#&quot;Kvaerno3&quot;,</span>
          <span class="c1"># stepsize_controller=dict(PIDController=dict(atol=1e-5,</span>
              <span class="c1">#                                            rtol=1e-5)),</span>
          <span class="n">root_finder</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">Newton</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                                       <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>
                                         <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">14.0732311562</span><span class="o">*</span><span class="mi">2</span> <span class="c1">#11.304727674272842/10000</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">67.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<h3 id="industrialac8">industrialAC8<a class="headerlink" href="#industrialac8" title="Permanent link">¤</a></h3>
<div id="industrialAC8" class="highlight"><pre><span></span><code><span class="n">industrialAC_folder</span> <span class="o">=</span> <span class="n">feniax</span><span class="o">.</span><span class="n">PATH</span> <span class="o">/</span> <span class="s2">&quot;../examples/IndustrialAC/&quot;</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">()</span>
<span class="n">inp</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;intrinsicmodal&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eig_type</span> <span class="o">=</span> <span class="s2">&quot;input_memory&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Dreal70.npy&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/Vreal70.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="p">[],</span>
                        <span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/FEM/&quot;</span><span class="p">)</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;structuralGridc.txt&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">typeof</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
<span class="n">mach</span> <span class="o">=</span> <span class="s2">&quot;081&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">u_inf</span> <span class="o">=</span> <span class="mf">200.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">rho_inf</span> <span class="o">=</span> <span class="mf">1.225</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICs</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/AICsQhj</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">poles</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Poles</span><span class="si">{</span><span class="n">mach</span><span class="si">}</span><span class="s2">_8r</span><span class="si">{</span><span class="n">inp</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">num_modes</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solution</span> <span class="o">=</span> <span class="s2">&quot;dynamic&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">xloads</span><span class="o">.</span><span class="n">modalaero_forces</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">q0treatment</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">c_ref</span> <span class="o">=</span> <span class="mf">7.271</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust_profile</span> <span class="o">=</span> <span class="s2">&quot;mc&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">panels_dihedral</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Dihedral.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">collocation_points</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">industrialAC_folder</span><span class="si">}</span><span class="s2">/AERO/Control_nodes.npy&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">sol_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">tn</span> <span class="o">=</span> <span class="mi">1501</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_library</span> <span class="o">=</span> <span class="s2">&quot;diffrax&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_function</span> <span class="o">=</span> <span class="s2">&quot;ode&quot;</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;Kvaerno3&quot;</span><span class="p">,</span> <span class="c1">#&quot;ImplicitEuler&quot;,#&quot;Kvaerno3&quot;,</span>
          <span class="c1"># stepsize_controller=dict(PIDController=dict(atol=1e-5,</span>
          <span class="c1">#                                            rtol=1e-5)),</span>
          <span class="n">root_finder</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">Chord</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                                      <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>                              
          <span class="c1"># root_finder=dict(Newton=dict(atol=1e-6,</span>
          <span class="c1">#                              rtol=1e-6))</span>
                                         <span class="p">)</span>

<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="mf">14.0732311562</span><span class="o">*</span><span class="mi">2</span> <span class="c1">#11.304727674272842/10000</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mf">67.</span>
<span class="n">inp</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">sett</span><span class="o">.</span><span class="n">s1</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">gust</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">save_times</span><span class="p">()</span>
</code></pre></div>
<h2 id="postprocessing">Postprocessing<a class="headerlink" href="#postprocessing" title="Permanent link">¤</a></h2>
<h3 id="plotting-functions">Plotting functions<a class="headerlink" href="#plotting-functions" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Format for figures: </span><span class="si">{</span><span class="n">figfmt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">figformat</span><span class="o">=</span><span class="n">figfmt</span><span class="p">,</span> <span class="n">update_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">update_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">update_layout</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="n">figname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;figs/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">figformat</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;../</span><span class="si">{</span><span class="n">figname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">figname</span>
        <span class="k">return</span> <span class="n">inner</span>
    <span class="k">return</span> <span class="n">inner_decorator</span>


<span class="k">def</span> <span class="nf">fig_background</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># if fig.data[0].showlegend is None:</span>
        <span class="c1">#     showlegend = True</span>
        <span class="c1"># else:</span>
        <span class="c1">#     showlegend = fig.data[0].showlegend</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
                       <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">ticks</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
                       <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="c1">#zeroline=True,</span>
        <span class="c1">#zerolinewidth=2,</span>
            <span class="c1">#zerolinecolor=&#39;LightPink&#39;,</span>
                       <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                       <span class="n">zeroline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">ticks</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
                       <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                          <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">),</span>
                          <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#showlegend,</span>
                          <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                              <span class="n">autoexpand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">b</span><span class="o">=</span><span class="mi">0</span>
                          <span class="p">))</span>
        <span class="k">return</span> <span class="n">fig</span>
    <span class="k">return</span> <span class="n">inner</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@fig_background</span>
<span class="k">def</span> <span class="nf">industrialAC_wingtip2</span><span class="p">(</span><span class="n">sol1</span><span class="p">,</span> <span class="n">sol2</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nast_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nast_load</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">33.977</span>
    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">sol1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                  <span class="n">sol1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                  <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">sol2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                  <span class="n">sol2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                  <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x1</span><span class="p">[:],</span> <span class="p">(</span><span class="n">y1</span><span class="p">[:]</span><span class="o">-</span><span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                          <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-G</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                               <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
                               <span class="p">))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="n">y2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                          <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-G</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                               <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">)</span>
                               <span class="p">))</span>

    <span class="k">if</span> <span class="n">nast_scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c1">#u111m[nast_load[0],0,-1, dim]</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">t111m</span><span class="p">[</span><span class="n">nast_load</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">(</span><span class="n">u111m</span><span class="p">[</span><span class="n">nast_load</span><span class="p">[</span><span class="mi">0</span><span class="p">],:,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span><span class="o">*</span><span class="n">nast_scale</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Lin. FE-G</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                                             <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span>
                                             <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
                                   <span class="p">))</span>
        <span class="n">offset2</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c1">#u111m[nast_load[1],0,-1, dim]</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">t111m</span><span class="p">[</span><span class="n">nast_load</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">(</span><span class="n">u111m</span><span class="p">[</span><span class="n">nast_load</span><span class="p">[</span><span class="mi">1</span><span class="p">],:,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset2</span><span class="p">)</span><span class="o">*</span><span class="n">nast_scale</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                              <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Lin. FE-G</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                   <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
                                             <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dot&quot;</span><span class="p">,</span>
                                             <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
                                   <span class="p">))</span>
    <span class="n">dim_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">}</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large u_</span><span class="si">%s</span><span class="s1"> / l$&#39;</span><span class="o">%</span><span class="n">dim_dict</span><span class="p">[</span><span class="n">dim</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large time \; [s]$&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="k">def</span> <span class="nf">subplots_wtips2</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="n">fig1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig3</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig3</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">fig2</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.135</span><span class="p">,</span> <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                        <span class="c1"># specs=[[{&quot;colspan&quot;: 2}, None],</span>
                        <span class="c1">#       [{}, {}]]</span>
                        <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f3i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f3i</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f1i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">f1inew</span> <span class="o">=</span> <span class="n">f1i</span>
        <span class="n">f1inew</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>          
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f1inew</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f2i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
        <span class="n">f2inew</span> <span class="o">=</span> <span class="n">f2i</span>
        <span class="n">f2inew</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>          
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">f2inew</span><span class="p">,</span>
                      <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span>
                      <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig3</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">tickfont</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                      <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zerolinecolor</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">),</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#showlegend,</span>
                      <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                          <span class="n">autoexpand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                          <span class="n">b</span><span class="o">=</span><span class="mi">0</span>
                          <span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.81</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1">#fig.update_layout(showlegend=False,row=2, col=1)</span>
    <span class="c1"># fig.update_layout(showlegend=False,row=2, col=2)</span>
    <span class="c1">#fig.update_layout(fig1.layout)</span>
    <span class="k">return</span> <span class="n">fig</span>



<span class="nd">@fig_background</span>
<span class="k">def</span> <span class="nf">industrialAC_wingtip4</span><span class="p">(</span><span class="n">sol1</span><span class="p">,</span> <span class="n">sol2</span><span class="p">,</span> <span class="n">sol3</span><span class="p">,</span> <span class="n">sol4</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nast_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nast_load</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">33.977</span>
    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">sol1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                    <span class="n">sol1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                    <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">sol2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                    <span class="n">sol2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                    <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">sol3</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                    <span class="n">sol3</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                    <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">putils</span><span class="o">.</span><span class="n">pickIntrinsic2D</span><span class="p">(</span><span class="n">sol4</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">t</span><span class="p">,</span>
                                    <span class="n">sol4</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dynamicsystem_s1</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span>
                                    <span class="n">fixaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="n">y1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                          <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                               <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
                                         <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                               <span class="p">))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x2</span><span class="p">[:],</span> <span class="p">(</span><span class="n">y2</span><span class="p">[:]</span><span class="o">-</span><span class="n">y2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                          <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                               <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dot&quot;</span><span class="p">)</span>
                               <span class="p">))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x3</span><span class="p">[:],</span> <span class="p">(</span><span class="n">y3</span><span class="p">[:]</span><span class="o">-</span><span class="n">y3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                          <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                               <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                               <span class="p">))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">uplotly</span><span class="o">.</span><span class="n">lines2d</span><span class="p">(</span><span class="n">x4</span><span class="p">[:],</span> <span class="p">(</span><span class="n">y4</span><span class="p">[:]</span><span class="o">-</span><span class="n">y4</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span>
                          <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;NMROM-</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                               <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">)</span>
                               <span class="p">))</span>

    <span class="n">dim_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">}</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large u_</span><span class="si">%s</span><span class="s1"> / l$&#39;</span><span class="o">%</span><span class="n">dim_dict</span><span class="p">[</span><span class="n">dim</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\large time \; [s]$&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div>
<h3 id="load-nastran-data">Load Nastran data<a class="headerlink" href="#load-nastran-data" title="Permanent link">¤</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># import pathlib</span>
<span class="c1"># import pickle</span>
<span class="c1"># import jax.numpy as jnp</span>
<span class="c1"># import jax</span>
<span class="c1"># import pandas as pd</span>
<span class="c1"># import feniax.preprocessor.configuration as configuration  # import Config, dump_to_yaml</span>
<span class="c1"># from feniax.preprocessor.inputs import Inputs</span>
<span class="c1"># import feniax.feniax_main</span>
<span class="c1"># import feniax.preprocessor.solution as solution</span>
<span class="c1"># import feniax.unastran.op2reader as op2reader</span>
<span class="c1"># from tabulate import tabulate</span>
<span class="c1"># </span>
<span class="n">examples_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../../../../examples&quot;</span><span class="p">)</span>

<span class="c1">####### IndustrialAC ###########</span>
<span class="n">nastran_path</span> <span class="o">=</span> <span class="n">examples_path</span> <span class="o">/</span> <span class="s2">&quot;IndustrialAC/NASTRAN/146-111/&quot;</span>
<span class="n">nas111</span> <span class="o">=</span> <span class="n">op2reader</span><span class="o">.</span><span class="n">NastranReader</span><span class="p">(</span><span class="n">op2name</span><span class="o">=</span><span class="p">(</span><span class="n">nastran_path</span> <span class="o">/</span> <span class="s2">&quot;IndustrialAC-146run.op2&quot;</span><span class="p">))</span>
<span class="n">nas111</span><span class="o">.</span><span class="n">readModel</span><span class="p">()</span>
<span class="n">t111</span><span class="p">,</span> <span class="n">u111</span> <span class="o">=</span> <span class="n">nas111</span><span class="o">.</span><span class="n">displacements</span><span class="p">()</span>

<span class="n">nastran_pathm</span> <span class="o">=</span> <span class="n">examples_path</span> <span class="o">/</span> <span class="s2">&quot;IndustrialAC/NASTRAN/146-111_081&quot;</span>
<span class="n">nas111m</span> <span class="o">=</span> <span class="n">op2reader</span><span class="o">.</span><span class="n">NastranReader</span><span class="p">(</span><span class="n">op2name</span><span class="o">=</span><span class="p">(</span><span class="n">nastran_pathm</span> <span class="o">/</span> <span class="s2">&quot;IndustrialAC-146run.op2&quot;</span><span class="p">))</span>
<span class="n">nas111m</span><span class="o">.</span><span class="n">readModel</span><span class="p">()</span>
<span class="n">t111m</span><span class="p">,</span> <span class="n">u111m</span> <span class="o">=</span> <span class="n">nas111m</span><span class="o">.</span><span class="n">displacements</span><span class="p">()</span>
</code></pre></div>
<h3 id="aeroelastic-dynamic-loads-on-an-industrial-configuration">Aeroelastic dynamic loads on an industrial configuration<a class="headerlink" href="#aeroelastic-dynamic-loads-on-an-industrial-configuration" title="Permanent link">¤</a></h3>
<p>The studies presented in this section are based on a reference
configuration developed to industry standards known as IndustrialAC, which is
representative of a long-range wide-body transport airplane. The version
with a wing-tip extension in [@CEA2023] is employed to verify a gust
response against MSC Nastran linear solution of the full FE model. While
the previous results where purely structural, now the dynamic response
to an atmospheric disturbance or gust is computed. This aeroelastic
analysis is a requirement for certification purposes and it is one of
the main drivers in sizing the wings of high aspect ratio wings.
Furthermore, the previous examples showed the advantage of our approach
in terms of computational speed, but other than that results could be
obtained with commercial software. The geometrically nonlinear
aeroelastic response, however, it is not currently available in
commercial solutions that are bounded to linear analysis in the
frequency domain. Other research codes feature those additional physics,
yet are limited to simple models. Thus the added value in the proposed
approach comes at the intersection between the nonlinear physics arising
from large integrated displacements, computational efficiency and the
ability to enhance the models already built for industrial use.\
Fig. <a href="#fig:industrialAC_modalshapes">1</a> shows the reference FE model with three
modal shapes. The FE model contains a total of around 177400 nodes,
which are condensed into 176 active nodes along the reference load axes
through interpolation elements. A Guyan or static condensation approach
is used for the reduction and the error in the natural frequencies
between full and reduced models is kept below 0.1% well beyond the 30th
mode. The aerodynamic model contains $\sim 1,500$ aerodynamic panels.
The simulations are carried out with a modal resolution of 70 modes and
a time step in the Runge-Kutta solver of 0.005.</p>
<p><div class="highlight"><pre><span></span><code>#+name: fig:industrialAC_modalshapes
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+caption: Modified IndustrialAC reference configuration with characteristic modal shapes
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+attr_latex: :width 0.8\textwidth
</code></pre></div>
<a href="figs_ext/industrialAC_modalshapes3.pdf">file:figs_ext/industrialAC_modalshapes3.pdf</a></p>
<ol>
<li>
<p>Linear response for low intensity gust</p>
<p>A verification exercise is introduced first by applying two 1-cos
gust shapes at a very low intensity, thus producing small
deformations and a linear response. The flow Mach number is 0.81. A
first gust is applied that we name as G1 of length 67 m and peak
velocity 0.141 m/s, and a second gust, G2, of 165 m and peak
velocity of 0.164 m/s. A snippet of the inputs to the simulation is
display in Listing <code>\ref{code:dynamic}</code>.</p>
<p><div class="highlight"><pre><span></span><code>\begin{listing}[!ht]
\begin{minted}[frame=single]{python}
from feniax.preprocessor.inputs import Inputs
\begin{minted}[frame=single]{python}
inp.fem.folder = &quot;./FEM/&quot;
inp.fem.num_modes = 70
inp.systems.sett.s1.solution = &quot;dynamic&quot;
inp.systems.sett.s1.t1 = 7.5
inp.systems.sett.s1.tn = 2001
inp.systems.sett.s1.solver_library = &quot;runge_kutta&quot;
inp.systems.sett.s1.solver_function = &quot;ode&quot;
inp.systems.sett.s1.solver_settings = dict(solver_name=&quot;rk4&quot;)
inp.systems.sett.s1.xloads.modalaero_forces = True
inp.systems.sett.s1.aero.folder = &quot;./AERO/&quot;
inp.systems.sett.s1.aero.c_ref = 7.271
inp.systems.sett.s1.aero.u_inf = 200.
inp.systems.sett.s1.aero.rho_inf = 1.225
inp.systems.sett.s1.aero.gust_profile = &quot;mc&quot;
inp.systems.sett.s1.aero.gust.intensity = 0.141
inp.systems.sett.s1.aero.gust.length = 67.
\end{minted}
\caption{FENIAX of inputs for dynamic gust simulation}
\label{code:dynamic}
\end{listing}
</code></pre></div>
Fig. <a href="#fig:GustXRF12">1</a> shows the normalised wing-tip response with
our NMROM that accurately reproduces the linear solution based on
the full FE model.</p>
<div id="GustIndustrialAC2" class="highlight"><pre><span></span><code><span class="n">sol1</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./IndustrialAC&quot;</span><span class="p">)</span>
<span class="n">sol2</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./industrialAC2&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">subplots_wtips2</span><span class="p">)(</span><span class="n">industrialAC_wingtip2</span><span class="p">,</span><span class="n">sol1</span><span class="p">,</span> <span class="n">sol2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">nast_scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nast_load</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">figname</span>
</code></pre></div>
<p><img alt="Wing-tip response to low intensity
gust" id="fig:GustXRF12.png" src="../figs/GustXRF12.png" /></p>
</li>
<li>
<p>Nonlinear response for high intensity gust</p>
<p>The gust intensity in the previous section by a factor of 200 in
order to show the effects of geometric nonlinearities that are only
captured by the nonlinear solver. As seen in Fig.
<a href="#fig:GustXRF34">2</a>, there are major differences in the $x$ and $y$
components of the response due to follower and shortening effects,
and a slight reduction in the $z$-component. These are well known
geometrically nonlinear effects that are added to the analysis with
no significant overhead.</p>
<div id="GustindustrialAC34" class="highlight"><pre><span></span><code><span class="n">sol1</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./industrialAC3&quot;</span><span class="p">)</span>
<span class="n">sol2</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./industrialAC4&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">subplots_wtips2</span><span class="p">)(</span><span class="n">industrialAC_wingtip2</span><span class="p">,</span> <span class="n">sol1</span><span class="p">,</span> <span class="n">sol2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">nast_scale</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">nast_load</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">figname</span>
</code></pre></div>
<p><img alt="Wing-tip response to high intensity
gust" id="fig:GustXRF34" src="../figs/GustXRF34.png" /></p>
<p>Snapshots of the 3D response are reconstructed for the G1 gust using
the method verified above at the time points where tip displacement
are maximum and minimum, i.e. 0.54 and 0.84 seconds. The front and
side views together with the aircraft reference configuration are
shown in Fig. <a href="#fig:industrialACgust3D">3</a>.</p>
<p><div class="highlight"><pre><span></span><code>#+name: fig:industrialACgust3D
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+caption: 3D IndustrialAC Nonlinear gust response
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+attr_latex: :width 1\textwidth
</code></pre></div>
<a href="figs_ext/industrialACgust3D2.pdf">file:figs_ext/industrialACgust3D2.pdf</a></p>
<p>In previous examples the same Runge-Kutta 4 (RK4) time-marching
scheme is used and now we explore the dynamic solution with other
solvers to assess their accuracy and also their computational
performance. Two explicit ODE solvers, RK4 and Dormand-Prince\'s 5/4
method (labelled S1 and S2), and two implicit, Euler first order and
Kvaerno\'s 3/2 method ((labelled S3 and S4)), are compared in Fig.
<a href="#fig:GustXRF3578">3</a>. In order to justify the use of implicit
solvers we reduce the time step from 0.005 to 0.02 seconds, at which
point both explicit solvers diverge. Kvaerno\'s implicit solver
remain stable and accurate despite the larger time step while the
Euler implicit method is stable but do not yield accurate results.</p>
<div id="GustXRF3578" class="highlight"><pre><span></span><code><span class="n">sol3</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./industrialAC3&quot;</span><span class="p">)</span>
<span class="n">sol5</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./industrialAC5&quot;</span><span class="p">)</span>
<span class="n">sol7</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./industrialAC7&quot;</span><span class="p">)</span>
<span class="n">sol8</span><span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">IntrinsicReader</span><span class="p">(</span><span class="s2">&quot;./industrialAC8&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">figname</span> <span class="o">=</span> <span class="n">fig_out</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">subplots_wtips2</span><span class="p">)(</span><span class="n">industrialAC_wingtip4</span><span class="p">,</span> <span class="n">sol1</span><span class="o">=</span><span class="n">sol3</span><span class="p">,</span> <span class="n">sol2</span><span class="o">=</span><span class="n">sol5</span><span class="p">,</span> <span class="n">sol3</span><span class="o">=</span><span class="n">sol7</span><span class="p">,</span> <span class="n">sol4</span><span class="o">=</span><span class="n">sol8</span><span class="p">,</span>
                                            <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;S1&quot;</span><span class="p">,</span><span class="s2">&quot;S2&quot;</span><span class="p">,</span><span class="s2">&quot;S3&quot;</span><span class="p">,</span><span class="s2">&quot;S4&quot;</span><span class="p">])</span>
<span class="n">figname</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code>#+name: fig:GustXRF3578
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+caption: Wing-tip response to high intensity gust using implicit solvers
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+attr_latex: :width 0.8\textwidth
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+results: GustXRF3578
</code></pre></div>
<a href="../figs/GustXRF3578.png">file:figs/GustXRF3578.png</a></p>
<p>The computational times of the different solvers are shown in Table
<a href="#table:IndustrialAC_times">2</a>. The implicit solvers have taken one order of
magnitude more time to run despite the reduction in time step.
Therefore the main take away this is that for moderately large
frequency dynamics, the explicit solvers offer a much efficient
solution. The turning point for using implicit solvers would be when
the largest eigenvalue in Eqs. <code>\ref{eq2:sol_qs}</code> led to
prohibitly small time steps. In terms of the Nastran solution, we
are not showing the whole simulation time because that would include
the time to sample the DLM aerodynamics which are input into the
NMROM as a post-processing step. Instead, the increase in time when
adding an extra gust subcase to an already existing analysis is
shown, i.e. the difference between one simulation that only computes
one gust response and another with two. It is remarkable that the
explicit solvers are faster on the nonlinear solution than the
linear solution by a commercial software. Besides our highly
efficient implementation, the main reason for this might be the
Nastran solution involves first a frequency domain analysis and then
an inverse Fourier transform to obtain the time-domain results.</p>
<div id="IndustrialAC_times" class="highlight"><pre><span></span><code><span class="n">dfruns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./run_times.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dfruns</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;industrialAC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]])]</span>
<span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mi">21</span><span class="p">]</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NMROM [S1, S2, S3, S4]&quot;</span> <span class="p">]</span>
<span class="n">header</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;$\Delta$ NASTRAN 146&quot;</span><span class="p">]</span>
<span class="c1"># df_sp = pd.DataFrame(dict(times=TIMES_DICT.values()),</span>
<span class="c1">#                         index=TIMES_DICT.keys())</span>

<span class="c1"># df_ = results_df[&#39;shift_conm2sLM25&#39;]</span>
<span class="c1"># df_ = df_.rename(columns={&quot;xlabel&quot;: &quot;%Chord&quot;})</span>
<span class="n">tabulate</span><span class="p">([</span><span class="n">values</span><span class="p">],</span> <span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;orgtbl&#39;</span><span class="p">)</span>
</code></pre></div>
<pre><code>           NMROM \[S1, S2, S3, S4\]       $\Delta$ NASTRAN 146
</code></pre>
<hr />
<dl>
<dt>Time <script type="math/tex; mode=display">s</script>   22.49, 18.94, 273.95, 847.89   81</dt>
<dd>
<p>Computational times IndustrialAC gust solution.</p>
</dd>
</dl>
</li>
<li>
<p>Differentiation of aeroelastic response</p>
<p>Similarly to the examples above, we now verify the AD implementation
for the nonlinear aeroelastic response to the gust $G1$. The
sensitivity of the six components of the wing root loads are
computed with respect to the gust parameters $w_g$ and $L_g$, and
the flow parameter $\rho_{\inf}$. The results are presented in
<a href="#table:IndustrialAC_AD">1</a>. A very good agreement with the finite
differences is found with $\epsilon=10^{-4}$.</p>
<p><div class="highlight"><pre><span></span><code>#+caption: Automatic differentiation in aeroelastic problem
</code></pre></div>
<div class="highlight"><pre><span></span><code>#+name: table:IndustrialAC_AD
</code></pre></div>
<div class="highlight"><pre><span></span><code>\begin{table} [h!]
\begin{center}
\begin{tabular}{lllll}
\toprule
 &amp; $w_g$ &amp; $L_g$ &amp; $\rho_{\inf}$ \\
\midrule
$f_1$ (AD) &amp; 12.180 &amp; 6.666 &amp; 477.208 \\
$f_1$ (FD)  &amp; 12.180 &amp; 6.190  &amp; 477.198  \\
\hline
$f_2 (AD)$ &amp; 19.088 &amp; 6.122 &amp; 712.485 \\
$f_2 (FD)$ &amp; 19.088 &amp; 7.045 &amp; 712.514  \\
\hline
$f_3 (AD)$ &amp; 65.574 &amp; 8.218 &amp; 1464.910 \\
$f_3 (FD)$ &amp; 65.574  &amp; 7.813 &amp; 1464.909  \\
\hline
$f_4 (AD)$ &amp; 126.648&amp; 21.598 &amp; 2883.370 \\
$f_4 (FD)$ &amp; 126.648&amp; 19.736  &amp; 2883.371  \\
\hline
$f_5 (AD)$ &amp; 330.759 &amp; 85.224 &amp; 5931.723 \\
$f_5 (FD)$ &amp; 330.759  &amp; 97.188  &amp; 5930.027  \\
\hline
$f_6$ (AD) &amp; 252.128 &amp; 48.423 &amp; 7179.735 \\
$f_6$ (FD) &amp; 252.128  &amp; 14.980  &amp; 7180.023  \\
\bottomrule
\end{tabular}
\end{center}
\end{table}
</code></pre></div></p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../wingSP/wingSP_nb/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Wing nonlinear dynamics">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Wing nonlinear dynamics
              </div>
            </div>
          </a>
        
        
          
          <a href="../../ConcurrentLoads/main/" class="md-footer__link md-footer__link--next" aria-label="Next: Concurrent loads">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Concurrent loads
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>